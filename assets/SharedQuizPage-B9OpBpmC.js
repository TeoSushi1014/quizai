import{j as e}from"./ui-BGuvgkTr.js";import{f as F,u as $,r as c}from"./router-BxjC687J.js";import{c as U,u as O,L as M,C as S,X as B,W as I,B as u,M as q,o as R,m as Y,Y as G,Z as V,q as W,l as o,_ as X,$ as Z}from"./index-DiYrUqtG.js";import"./vendor-DoC2WAmd.js";import"./utils-rUpm7H1u.js";import"./markdown-Bj7tmv2T.js";const _=()=>{var y,N,Q,w;const{quizId:s}=F(),{t}=U(),m=$(),{quizzes:v,setActiveQuiz:C,setQuizResult:k,currentUser:x}=O(),[a,f]=c.useState(null),[P,l]=c.useState(!0),[b,n]=c.useState(null),[p,z]=c.useState(!1),[j,i]=c.useState("");c.useEffect(()=>{(async()=>{if(l(!0),n(null),i(""),!s){o.warn("SharedQuizPage: No quizId in params.","SharedQuizPage"),n(t("sharedQuizNotFound")),i("No quiz ID provided in URL"),l(!1);return}if(!I(s)){o.warn("SharedQuizPage: Invalid quiz ID format.","SharedQuizPage",{quizId:s}),n(t("sharedQuizNotFound")),i(`Invalid quiz ID format: ${s}`),l(!1);return}try{if(x){const h=v.find(g=>g.id===s);if(h){o.info("SharedQuizPage: Displaying quiz owned by current user.","SharedQuizPage",{quizId:s}),f(h),i("Quiz found in user's collection"),l(!1);return}}const r=await X(s,x);if(r)o.info("SharedQuizPage: Quiz data fetched successfully.","SharedQuizPage",{quizId:s}),f(r),i("Quiz found via sharing mechanism");else{if(o.warn("SharedQuizPage: Quiz not found via getSharedQuiz.","SharedQuizPage",{quizId:s}),s==="a35130c9-2b62-4327-85f2-f1796c37c47a"){const A={id:s,title:"Test Shared Quiz",description:"This is a test quiz for sharing functionality",questions:[{id:"q1",type:"multiple-choice",questionText:"What is 2 + 2?",options:["3","4","5","6"],correctAnswer:"1",explanation:"Basic arithmetic: 2 + 2 = 4"},{id:"q2",type:"true-false",questionText:"The earth is round.",options:["True","False"],correctAnswer:"0",explanation:"The Earth is approximately spherical."}],timeLimit:300,shuffleQuestions:!1,shuffleOptions:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tags:["test","demo"],category:"Test"};f(A),i("Test quiz created for demonstration"),l(!1);return}const h=Z(),g=`Quiz ${s} not found. Available shared quizzes: ${h.join(", ")||"none"}. User logged in: ${x?"Yes":"No"}`;i(g),n(t("sharedQuizNotFound"))}}catch(r){o.error("Error loading shared quiz:","SharedQuizPage",{quizId:s},r),n(t("sharedQuizLoadError")),i(`Error: ${r.message}`)}finally{l(!1)}})()},[s,v,t,x]);const T=async()=>{const d=window.location.href;try{await navigator.clipboard.writeText(d),z(!0),setTimeout(()=>z(!1),2e3)}catch(r){o.error("Failed to copy share link from SharedQuizPage:","SharedQuizPage",void 0,r)}},D=()=>{a&&(C(a),k(null),m(`/quiz/${a.id}`))};if(P)return e.jsx("div",{className:"min-h-[calc(100vh-200px)] flex items-center justify-center",children:e.jsx(M,{text:t("loading")+"...",size:"xl"})});if(b||!a)return e.jsx("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:e.jsxs(S,{className:"max-w-lg mx-auto mt-10 sm:mt-16 p-8 text-center animate-fadeInUp shadow-2xl",useGlassEffect:!0,children:[e.jsx(B,{className:"w-16 h-16 text-[var(--color-danger-accent)] mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold text-[var(--color-text-primary)] mb-3",children:t("sharedQuizError")}),e.jsx("p",{className:"text-[var(--color-text-secondary)] mb-4",children:b||t("sharedQuizNotFound")}),j&&e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)] p-4 rounded-lg mb-6 text-left",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsx("span",{className:"text-sm font-semibold text-[var(--color-text-primary)]",children:"Debug Information"})}),e.jsx("p",{className:"text-xs text-[var(--color-text-muted)] font-mono break-all",children:j}),s&&e.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] font-mono mt-2",children:["Quiz ID: ",s,e.jsx("br",{}),"Valid Format: ",I(s)?"Yes":"No"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx(u,{variant:"primary",onClick:()=>m("/"),size:"lg",className:"py-3 px-8 rounded-xl",children:t("home")}),e.jsx(u,{variant:"outline",onClick:()=>m("/create"),size:"lg",className:"py-3 px-8 rounded-xl",children:t("createQuiz")})]})]})});const L=(y=a.config)!=null&&y.difficulty&&a.config.difficulty!=="AI-Determined"?t(`step2Difficulty${a.config.difficulty}`):((N=a.config)==null?void 0:N.difficulty)==="AI-Determined"?t("dashboardQuizCardDifficulty"):t("notSpecified"),E=(Q=a.config)!=null&&Q.language?a.config.language.toLowerCase()==="english"?t("step2LanguageEnglish"):t("step2LanguageVietnamese"):t("notSpecified");return e.jsx("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:e.jsxs(S,{className:"max-w-3xl mx-auto shadow-2xl !rounded-2xl animate-fadeInUp",useGlassEffect:!0,children:[e.jsxs("div",{className:"border-b border-[var(--color-border-default)] pb-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-[var(--color-text-primary)] leading-tight tracking-tight line-clamp-3",title:a.title,children:e.jsx(q,{text:a.title,markdownFormatting:!0})}),e.jsx(u,{variant:"outline",size:"sm",onClick:T,leftIcon:p?e.jsx(R,{className:"w-4 h-4 text-[var(--color-success-accent)]"}):e.jsx(Y,{className:"w-4 h-4"}),className:`!py-2 px-4 rounded-lg shadow-sm flex-shrink-0 ${p?"!border-[var(--color-success-accent)] !text-[var(--color-success-accent)]":"!border-[var(--color-border-interactive)] hover:!border-[var(--color-primary-accent)]"}`,children:t(p?"copied":"copyShareLink")})]}),((w=a.creator)==null?void 0:w.name)&&e.jsxs("div",{className:"flex items-center text-sm text-[var(--color-text-secondary)] mt-3",children:[e.jsx(G,{className:"w-4 h-4 mr-2 text-[var(--color-text-muted)]"}),e.jsxs("span",{children:[t("dashboardQuizCardCreated",{date:""})," ",a.creator.name]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-5",children:e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)]",children:t("quizDetails")})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center sm:text-left",children:[e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:t("numberOfQuestions")}),e.jsx("p",{className:"text-2xl font-bold text-[var(--color-text-primary)]",children:a.questions.length})]}),e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:t("difficulty")}),e.jsx("p",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:L})]}),e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:t("step2LanguageLabel")}),e.jsx("p",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:E})]})]})]}),a.questions&&a.questions.length>0&&e.jsxs("div",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-5",children:t("previewQuestions")}),e.jsx("div",{className:"space-y-4",children:a.questions.slice(0,3).map((d,r)=>e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 sm:p-5 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsxs("div",{className:"font-medium text-[var(--color-text-primary)] mb-2 text-sm sm:text-base",children:[e.jsxs("span",{className:"text-[var(--color-primary-accent)] mr-2 font-semibold",children:[r+1,"."]}),e.jsx(q,{text:d.questionText,markdownFormatting:!0})]}),r===2&&a.questions.length>3&&e.jsx("p",{className:"text-xs text-[var(--color-text-muted)] italic text-center mt-3",children:t("andMoreQuestions",{count:a.questions.length-3})}),r<2&&a.questions.length>1&&e.jsx("p",{className:"text-xs text-[var(--color-text-muted)] italic mt-2",children:t("moreQuestionsInQuiz")})]},d.id))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 pt-6 border-t border-[var(--color-border-default)]",children:[e.jsx(u,{variant:"primary",size:"lg",onClick:D,leftIcon:e.jsx(V,{className:"w-5 h-5"}),className:"w-full sm:w-auto py-3.5 px-10 rounded-xl bg-gradient-to-r from-[var(--color-primary-accent)] to-indigo-500 hover:from-[var(--color-primary-accent-hover)] hover:to-indigo-600 shadow-xl",children:t("takeQuizNow")}),e.jsx(u,{variant:"outline",size:"lg",onClick:()=>m("/create"),leftIcon:e.jsx(W,{className:"w-5 h-5"}),className:"w-full sm:w-auto py-3.5 px-8 rounded-xl",children:t("createQuiz")})]})]})})};_.displayName="SharedQuizPage";export{_ as default};
