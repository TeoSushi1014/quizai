import{j as e}from"./ui-BGuvgkTr.js";import{u as y,r as n}from"./router-BxjC687J.js";import{u as b,l as c,$ as g,L as w,C as m,B as t,a0 as x,a1 as S,a2 as Q}from"./index-DeIFN2og.js";import{q as C}from"./quizResultsService-DOyKBqNr.js";import"./vendor-DoC2WAmd.js";import"./utils-rUpm7H1u.js";import"./markdown-Bj7tmv2T.js";const E=()=>{const{currentUser:r}=b(),i=y(),[u,j]=n.useState([]),[v,h]=n.useState(!0),[p,f]=n.useState(null);n.useEffect(()=>{if(!r){i("/");return}o()},[r,i]);const o=async()=>{if(r)try{h(!0),c.info("Loading user quizzes","MyQuizzesPage",{userId:r.id});const s=await g.getUserQuizzes(r.id),a=await Promise.all(s.map(async d=>{const l=await C.getQuizStats(d.id);return{...d,totalAttempts:l.totalAttempts,averageScore:l.averageScore,bestScore:l.bestScore,uniqueUsers:l.uniqueUsers,isShared:!1,shareUrl:`${window.location.origin}/#/shared/${d.id}`}}));j(a),c.info("User quizzes loaded successfully","MyQuizzesPage",{quizCount:a.length})}catch(s){c.error("Failed to load user quizzes","MyQuizzesPage",{},s),f("Failed to load your quizzes")}finally{h(!1)}},N=async s=>{try{const a=await g.shareQuiz(s.id);a!=null&&a.shareUrl&&(await navigator.clipboard.writeText(a.shareUrl),o())}catch(a){c.error("Failed to share quiz","MyQuizzesPage",{},a)}},z=s=>{i(`/quiz-analytics/${s}`)};return r?v?e.jsx("div",{className:"flex justify-center items-center min-h-[calc(100vh-200px)]",children:e.jsx(w,{size:"xl",text:"Loading your quizzes..."})}):p?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(m,{className:"max-w-md mx-auto p-8 text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:p}),e.jsx(t,{onClick:o,children:"Try Again"})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-primary)]",children:"My Quizzes"}),e.jsx(t,{variant:"primary",onClick:()=>i("/create"),className:"px-6 py-2",children:"Create New Quiz"})]}),u.length===0?e.jsxs(m,{className:"max-w-md mx-auto p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"No Quizzes Yet"}),e.jsx("p",{className:"text-[var(--color-text-muted)] mb-6",children:"You haven't created any quizzes yet. Start by creating your first quiz!"}),e.jsx(t,{variant:"primary",onClick:()=>i("/create"),children:"Create Your First Quiz"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(s=>{var a;return e.jsxs(m,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)] mb-2 line-clamp-2",children:s.title}),e.jsxs("p",{className:"text-sm text-[var(--color-text-muted)]",children:[((a=s.questions)==null?void 0:a.length)||0," questions"]}),e.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:["Created: ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsx("div",{className:"mb-4 p-3 bg-[var(--color-bg-surface-2)] rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Attempts:"}),e.jsx("span",{className:"ml-1 font-semibold",children:s.totalAttempts})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Users:"}),e.jsx("span",{className:"ml-1 font-semibold",children:s.uniqueUsers})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Avg Score:"}),e.jsxs("span",{className:"ml-1 font-semibold",children:[s.averageScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Best:"}),e.jsxs("span",{className:"ml-1 font-semibold",children:[s.bestScore,"%"]})]})]})}),s.isShared&&e.jsx("div",{className:"mb-4 p-2 bg-green-50 dark:bg-green-900/20 rounded border border-green-200 dark:border-green-800",children:e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center",children:[e.jsx(x,{className:"w-3 h-3 mr-1"}),"Shared publicly"]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>z(s.id),leftIcon:e.jsx(S,{className:"w-4 h-4"}),className:"flex-1",children:"Analytics"}),s.isShared?e.jsx(t,{variant:"outline",size:"sm",onClick:()=>navigator.clipboard.writeText(s.shareUrl||""),leftIcon:e.jsx(x,{className:"w-4 h-4"}),className:"flex-1",children:"Copy Link"}):e.jsx(t,{variant:"outline",size:"sm",onClick:()=>N(s),leftIcon:e.jsx(x,{className:"w-4 h-4"}),className:"flex-1",children:"Share"}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>i(`/review/${s.id}`),leftIcon:e.jsx(Q,{className:"w-4 h-4"}),children:"Edit"})]})]},s.id)})})]}):null};export{E as default};
