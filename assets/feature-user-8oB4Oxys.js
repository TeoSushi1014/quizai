import{r as e,j as a}from"./core-react-DcE6uGcR.js";import{a as s,u as r,L as t,B as i,C as l,U as o,I as c,p as n}from"./app-components-CFPFxe5x.js";import{l as d}from"./services-BHj8px4z.js";import{m}from"./ui-framework-CdNWeEQR.js";import{a as x}from"./router-Dk7yDelZ.js";import"./katex-core-BbYO2yyT.js";import"./katex-extras-AZS8NW-4.js";import"./service-supabase-wASzC9XA.js";import"./google-services-Bc_loC93.js";/* empty css                        */import"./feature-quiz-home-Ch5jepSG.js";import"./feature-quiz-components-CChsAlA6.js";import"./feature-quiz-dashboard-C8yrEGC7.js";import"./markdown-processors-D3jN8hOQ.js";import"./react-markdown-Cej2CoYR.js";import"./feature-quiz-sharedquiz-Clu9xfzS.js";import"./feature-quiz-2SquOiTn.js";import"./util-storage-UFVse9kk.js";import"./util-document-Dv5rbOR1.js";import"./util-pdf-CkIVnOzu.js";const p=()=>{const{t:p}=s(),{currentUser:u,updateUserProfile:f,isLoading:h}=r(),v=x(),[j,b]=e.useState((null==u?void 0:u.name)||""),[y,g]=e.useState((null==u?void 0:u.bio)||""),[N,w]=e.useState(!1),[k,z]=e.useState(!1);if(e.useEffect(()=>{u&&(b(u.name||""),g(u.bio||""))},[u]),h&&!u)return a.jsx("div",{className:"flex justify-center items-center min-h-[calc(100vh-200px)]",children:a.jsx(t,{size:"xl",text:p("loading")})});if(!u)return a.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] text-center p-5",children:[a.jsx("p",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-4",children:p("error")}),a.jsx("p",{className:"text-base text-[var(--color-text-secondary)] mb-8",children:"User not found. Please sign in to view your profile."}),a.jsx(i,{onClick:()=>window.location.hash="/signin",variant:"primary",className:"py-2.5 px-5 sm:px-6 rounded-lg transform transition-transform hover:scale-[1.03] active:scale-[0.98]",children:p("signIn")})]});const P=()=>{b(u.name||""),g(u.bio||""),w(!1)},C={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},S=[{labelKey:"profileQuizzes",value:u.quizCount,suffix:""},{labelKey:"profileCompletions",value:u.completionCount,suffix:""},{labelKey:"profileAvgScore",value:u.averageScore,suffix:null!==u.averageScore&&void 0!==u.averageScore?"%":""}];return a.jsxs(m.div,{className:"container mx-auto py-6 sm:py-8 md:py-10 max-w-4xl",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.1}}},children:[a.jsx(m.h1,{variants:C,className:"text-3xl sm:text-4xl font-bold text-[var(--color-text-primary)] mb-8 sm:mb-10 text-center tracking-tight",children:p("profile")}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8",children:[a.jsx(m.div,{variants:C,className:"md:col-span-1",children:a.jsxs(l,{useGlassEffect:!0,className:"p-6 sm:p-8 flex flex-col items-center justify-center text-center !rounded-2xl shadow-xl",children:[a.jsx("div",{className:"mb-5",children:a.jsx(o,{user:u,size:"lg",className:"border-4 border-[var(--color-primary-accent)] shadow-lg"})}),a.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-1 truncate max-w-full",title:u.name||void 0,children:u.name||p("user")}),a.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-6 truncate max-w-full",title:u.email||void 0,children:u.email}),a.jsx("div",{className:"mt-auto w-full",children:a.jsx(i,{variant:N?"secondary":"primary",size:"md",className:"w-full py-2.5 rounded-lg shadow-md",onClick:()=>N?P():w(!0),children:p(N?"cancel":"edit")})})]})}),a.jsx(m.div,{variants:C,className:"md:col-span-2",children:a.jsxs(l,{useGlassEffect:!0,className:"p-6 sm:p-8 !rounded-2xl shadow-xl",children:[a.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-6 border-b border-[var(--color-border-default)] pb-4",children:p("profileInformation")}),N?a.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-5",children:[a.jsx(c,{label:a.jsx("span",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:p("profileName")}),value:j,onChange:e=>b(e.target.value),placeholder:p("profileNamePlaceholder"),inputClassName:"text-base"}),a.jsx(n,{label:a.jsx("span",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:p("profileBio")}),value:y,onChange:e=>g(e.target.value),placeholder:p("profileBioPlaceholder"),rows:4,className:"min-h-[100px] text-base"}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-3",children:[a.jsx(i,{variant:"secondary",size:"md",onClick:P,className:"py-2.5 px-6 rounded-lg",children:p("cancel")}),a.jsx(i,{variant:"primary",size:"md",onClick:async()=>{u&&(z(!0),d.info("Attempting to save profile","ProfilePage",{userId:u.id,newName:j,newBioLength:y.length}),await f({name:j,bio:y})?w(!1):d.error("Profile update failed in ProfilePage after context call.","ProfilePage",{userId:u.id}),z(!1))},isLoading:k,className:"py-2.5 px-6 rounded-lg shadow-lg",children:p(k?"savingButton":"save")})]})]}):a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"animate-fadeIn",children:[a.jsx("h3",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:p("profileName")}),a.jsx("p",{className:"text-[var(--color-text-primary)] text-base",children:j||"-"})]}),a.jsxs("div",{className:"animate-fadeIn",style:{animationDelay:"0.1s"},children:[a.jsx("h3",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:p("profileEmail")}),a.jsx("p",{className:"text-[var(--color-text-primary)] text-base",children:u.email||"-"})]}),a.jsxs("div",{className:"animate-fadeIn",style:{animationDelay:"0.2s"},children:[a.jsx("h3",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:p("profileBio")}),a.jsx("p",{className:"text-[var(--color-text-primary)] text-base whitespace-pre-line break-words",children:y||a.jsx("span",{className:"italic text-[var(--color-text-muted)]",children:p("profileBioPlaceholder")})})]})]})]})}),a.jsx(m.div,{variants:C,className:"md:col-span-3",children:a.jsxs(l,{useGlassEffect:!0,className:"p-6 sm:p-8 !rounded-2xl shadow-xl",children:[a.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-6 border-b border-[var(--color-border-default)] pb-4",children:p("profileStats")}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-5",children:S.map((e,s)=>a.jsxs(m.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1*s,ease:"easeOut"},className:"bg-[var(--color-bg-surface-2)]/50 p-5 rounded-xl border border-[var(--color-border-default)] text-center shadow-md hover:shadow-lg transition-shadow",children:[a.jsx("h3",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1.5",children:p(e.labelKey)}),a.jsxs("p",{className:"text-3xl font-bold text-[var(--color-primary-accent)]",children:[void 0!==e.value&&null!==e.value?e.value:"-",e.suffix]})]},e.labelKey))}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx(i,{variant:"outline",onClick:()=>v("/history"),className:"px-6 py-2",children:"ðŸ“Š View Quiz History"})})]})})]})]})};p.displayName="ProfilePage";export{p as default};
