import{r as e,j as s}from"./core-react-DcE6uGcR.js";import{u as t,C as r,L as a,B as c,v as o}from"./app-components-CFPFxe5x.js";import{c as i,l}from"./services-BHj8px4z.js";import{a as n}from"./router-Dk7yDelZ.js";import"./katex-core-BbYO2yyT.js";import"./katex-extras-AZS8NW-4.js";import"./service-supabase-wASzC9XA.js";import"./google-services-Bc_loC93.js";/* empty css                        */import"./feature-quiz-home-Ch5jepSG.js";import"./feature-quiz-components-CChsAlA6.js";import"./ui-framework-CdNWeEQR.js";import"./feature-quiz-dashboard-C8yrEGC7.js";import"./markdown-processors-D3jN8hOQ.js";import"./react-markdown-Cej2CoYR.js";import"./feature-quiz-sharedquiz-Clu9xfzS.js";import"./feature-quiz-2SquOiTn.js";import"./util-storage-UFVse9kk.js";import"./util-document-Dv5rbOR1.js";import"./util-pdf-CkIVnOzu.js";const d=()=>{const{currentUser:d}=t(),m=n(),[x,u]=e.useState([]),[h,j]=e.useState(!0),[p,v]=e.useState(null);e.useEffect(()=>{d?g():m("/")},[d,m]);const g=async()=>{if(d)try{j(!0),v(null);const e=await i.getUserQuizHistory(d.id,50);u(e),j(!1),l.info("User quiz history loaded","QuizHistoryPage",{userId:d.id,resultCount:e.length})}catch(e){l.error("Failed to load user quiz history","QuizHistoryPage",{},e),v("Failed to load your quiz history"),j(!1)}},y=e=>e>=80?"text-[var(--color-success-accent)]":e>=60?"text-[var(--color-warning-accent)]":"text-[var(--color-danger-accent)]";return d?s.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-primary)] mb-2",children:"Your Quiz History"}),s.jsx("p",{className:"text-[var(--color-text-secondary)]",children:"View all your quiz attempts and track your progress"})]}),h&&s.jsx(r,{className:"p-8",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx(a,{}),s.jsx("span",{className:"ml-3 text-[var(--color-text-secondary)]",children:"Loading your quiz history..."})]})}),p&&s.jsx(r,{className:"p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-[var(--color-danger-accent)] mb-4",children:p}),s.jsx(c,{onClick:g,variant:"outline",size:"sm",children:"Try Again"})]})}),!h&&!p&&0===x.length&&s.jsx(r,{className:"p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx(o,{className:"w-16 h-16 mx-auto text-[var(--color-text-muted)] mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)] mb-2",children:"No Quiz History Yet"}),s.jsx("p",{className:"text-[var(--color-text-secondary)] mb-4",children:"You haven't taken any quizzes yet. Start taking quizzes to see your progress here!"}),s.jsx(c,{onClick:()=>m("/"),variant:"primary",children:"Browse Quizzes"})]})}),!h&&!p&&x.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(r,{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-[var(--color-primary-accent)]",children:x.length}),s.jsx("div",{className:"text-sm text-[var(--color-text-secondary)]",children:"Total Attempts"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-[var(--color-success-accent)]",children:[x.length>0?Math.round(x.reduce((e,s)=>e+s.score,0)/x.length):0,"%"]}),s.jsx("div",{className:"text-sm text-[var(--color-text-secondary)]",children:"Average Score"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-[var(--color-warning-accent)]",children:[x.length>0?Math.max(...x.map(e=>e.score)):0,"%"]}),s.jsx("div",{className:"text-sm text-[var(--color-text-secondary)]",children:"Best Score"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-[var(--color-primary-accent)]",children:new Set(x.map(e=>e.quiz_id)).size}),s.jsx("div",{className:"text-sm text-[var(--color-text-secondary)]",children:"Unique Quizzes"})]})]})}),s.jsxs(r,{className:"p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-4",children:"Recent Attempts"}),s.jsx("div",{className:"space-y-3",children:x.map(e=>{return s.jsx("div",{className:"p-4 rounded-lg border-2 border-[var(--color-border-default)] "+(a=e.score,a>=80?"bg-[var(--color-success-accent)]/10 border-[var(--color-success-accent)]/30":a>=60?"bg-[var(--color-warning-accent)]/10 border-[var(--color-warning-accent)]/30":"bg-[var(--color-danger-accent)]/10 border-[var(--color-danger-accent)]/30"),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-[var(--color-text-primary)] mb-1",children:e.quiz_title||"Unknown Quiz"}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-[var(--color-text-secondary)]",children:[s.jsxs("span",{className:`font-bold ${y(e.score)}`,children:[e.score,"% (",Math.round(e.score/100*e.total_questions),"/",e.total_questions,")"]}),s.jsxs("span",{children:["Time: ",(t=e.time_taken,t?`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`:"--:--")]}),s.jsx("span",{children:(r=e.created_at,new Date(r).toLocaleDateString("vi-VN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]})]}),s.jsx(c,{variant:"ghost",size:"sm",onClick:()=>m(`/quiz/${e.quiz_id}`),children:"Take Again"})]})},e.id);var t,r,a})})]})]})]}):null};export{d as default};
