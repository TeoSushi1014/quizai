import{r as e,j as s}from"./core-react-DcE6uGcR.js";import{u as a,L as t,C as r,B as i,S as l,H as o,P as c}from"./app-components-CFPFxe5x.js";import{a as n}from"./service-supabase-wASzC9XA.js";import{l as d,c as m}from"./services-BHj8px4z.js";import{a as x}from"./router-Dk7yDelZ.js";import"./katex-core-BbYO2yyT.js";import"./katex-extras-AZS8NW-4.js";import"./google-services-Bc_loC93.js";/* empty css                        */import"./feature-quiz-home-Ch5jepSG.js";import"./feature-quiz-components-CChsAlA6.js";import"./ui-framework-CdNWeEQR.js";import"./feature-quiz-dashboard-C8yrEGC7.js";import"./markdown-processors-D3jN8hOQ.js";import"./react-markdown-Cej2CoYR.js";import"./feature-quiz-sharedquiz-Clu9xfzS.js";import"./feature-quiz-2SquOiTn.js";import"./util-storage-UFVse9kk.js";import"./util-document-Dv5rbOR1.js";import"./util-pdf-CkIVnOzu.js";const u=()=>{const{currentUser:u,showErrorNotification:h}=a(),p=x(),[j,v]=e.useState([]),[g,z]=e.useState(!0),[f,N]=e.useState(null);e.useEffect(()=>{u?y():p("/")},[u,p]);const y=async()=>{if(u)try{z(!0),d.info("Loading user quizzes","MyQuizzesPage",{userId:u.id});const e=await n.getUserQuizzes(u.id),s=await Promise.all(e.map(async e=>{const s=await m.getQuizStats(e.id);return{...e,totalAttempts:s.totalAttempts,averageScore:s.averageScore,bestScore:s.bestScore,uniqueUsers:s.uniqueUsers,isShared:!1,shareUrl:`${window.location.origin}/#/shared/${e.id}`}}));v(s),d.info("User quizzes loaded successfully","MyQuizzesPage",{quizCount:s.length})}catch(e){d.error("Failed to load user quizzes","MyQuizzesPage",{},e),N("Failed to load your quizzes")}finally{z(!1)}};return u?g?s.jsx("div",{className:"flex justify-center items-center min-h-[calc(100vh-200px)]",children:s.jsx(t,{size:"xl",text:"Loading your quizzes..."})}):f?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs(r,{className:"max-w-md mx-auto p-8 text-center",children:[s.jsx("p",{className:"text-red-600 mb-4",children:f}),s.jsx(i,{onClick:y,children:"Try Again"})]})}):s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-primary)]",children:"My Quizzes"}),s.jsx(i,{variant:"primary",onClick:()=>p("/create"),className:"px-6 py-2",children:"Create New Quiz"})]}),0===j.length?s.jsxs(r,{className:"max-w-md mx-auto p-8 text-center",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"No Quizzes Yet"}),s.jsx("p",{className:"text-[var(--color-text-muted)] mb-6",children:"You haven't created any quizzes yet. Start by creating your first quiz!"}),s.jsx(i,{variant:"primary",onClick:()=>p("/create"),children:"Create Your First Quiz"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(e=>{var a;return s.jsxs(r,{className:"p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)] mb-2 line-clamp-2",children:e.title}),s.jsxs("p",{className:"text-sm text-[var(--color-text-muted)]",children:[(null==(a=e.questions)?void 0:a.length)||0," questions"]}),s.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:["Created: ",new Date(e.createdAt).toLocaleDateString()]})]}),s.jsx("div",{className:"mb-4 p-3 bg-[var(--color-bg-surface-2)] rounded-lg",children:s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Attempts:"}),s.jsx("span",{className:"ml-1 font-semibold",children:e.totalAttempts})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Users:"}),s.jsx("span",{className:"ml-1 font-semibold",children:e.uniqueUsers})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Avg Score:"}),s.jsxs("span",{className:"ml-1 font-semibold",children:[e.averageScore,"%"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-[var(--color-text-muted)]",children:"Best:"}),s.jsxs("span",{className:"ml-1 font-semibold",children:[e.bestScore,"%"]})]})]})}),e.isShared&&s.jsx("div",{className:"mb-4 p-2 bg-green-50 dark:bg-green-900/20 rounded border border-green-200 dark:border-green-800",children:s.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center",children:[s.jsx(l,{className:"w-3 h-3 mr-1"}),"Shared publicly"]})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(i,{variant:"outline",size:"sm",onClick:()=>{return s=e.id,void(u?p(`/quiz-analytics/${s}`):h("Please log in to view analytics"));var s},leftIcon:s.jsx(o,{className:"w-4 h-4"}),className:"flex-1",children:"Analytics"}),e.isShared?s.jsx(i,{variant:"outline",size:"sm",onClick:()=>navigator.clipboard.writeText(e.shareUrl||""),leftIcon:s.jsx(l,{className:"w-4 h-4"}),className:"flex-1",children:"Copy Link"}):s.jsx(i,{variant:"outline",size:"sm",onClick:()=>(async e=>{try{const s=await n.shareQuiz(e.id);(null==s?void 0:s.shareUrl)&&(await navigator.clipboard.writeText(s.shareUrl),y())}catch(s){d.error("Failed to share quiz","MyQuizzesPage",{},s)}})(e),leftIcon:s.jsx(l,{className:"w-4 h-4"}),className:"flex-1",children:"Share"}),s.jsx(i,{variant:"outline",size:"sm",onClick:()=>p(`/review/${e.id}`),leftIcon:s.jsx(c,{className:"w-4 h-4"}),children:"Edit"})]})]},e.id)})})]}):null};export{u as default};
