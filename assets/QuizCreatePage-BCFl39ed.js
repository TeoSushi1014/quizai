import{a as Wo,b as Yo,c as Zo,_ as Vt}from"./utils-rUpm7H1u.js";import{j as g,m as lt,A as Ko}from"./ui-BGuvgkTr.js";import{u as Qo,r as G,R as ut}from"./router-BxjC687J.js";import{l as q,G as Jt,g as Xo,a as cn,s as jo,b as Ve,u as es,c as ts,C as Fe,M as _n,D as bt,d as ns,I as xn,B as ye,P as En,e as In,T as is,f as Sn,h as os,S as An,i as ct,j as ss,k as rs,m as as,n as ls}from"./index-BRRMTy5t.js";import{g as us}from"./vendor-DoC2WAmd.js";import"./markdown-Bj7tmv2T.js";var O;(function(i){i.assertEqual=o=>{};function t(o){}i.assertIs=t;function e(o){throw new Error}i.assertNever=e,i.arrayToEnum=o=>{const a={};for(const l of o)a[l]=l;return a},i.getValidEnumValues=o=>{const a=i.objectKeys(o).filter(u=>typeof o[o[u]]!="number"),l={};for(const u of a)l[u]=o[u];return i.objectValues(l)},i.objectValues=o=>i.objectKeys(o).map(function(a){return o[a]}),i.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const a=[];for(const l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.push(l);return a},i.find=(o,a)=>{for(const l of o)if(a(l))return l},i.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,a=" | "){return o.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}i.joinValues=n,i.jsonStringifyReplacer=(o,a)=>typeof a=="bigint"?a.toString():a})(O||(O={}));var Mn;(function(i){i.mergeShapes=(t,e)=>({...t,...e})})(Mn||(Mn={}));const x=O.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ce=i=>{switch(typeof i){case"undefined":return x.undefined;case"string":return x.string;case"number":return Number.isNaN(i)?x.nan:x.number;case"boolean":return x.boolean;case"function":return x.function;case"bigint":return x.bigint;case"symbol":return x.symbol;case"object":return Array.isArray(i)?x.array:i===null?x.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?x.promise:typeof Map<"u"&&i instanceof Map?x.map:typeof Set<"u"&&i instanceof Set?x.set:typeof Date<"u"&&i instanceof Date?x.date:x.object;default:return x.unknown}},T=O.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Te extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}format(t){const e=t||function(a){return a.message},n={_errors:[]},o=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(o);else if(l.code==="invalid_return_type")o(l.returnTypeError);else if(l.code==="invalid_arguments")o(l.argumentsError);else if(l.path.length===0)n._errors.push(e(l));else{let u=n,d=0;for(;d<l.path.length;){const c=l.path[d];d===l.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(e(l))):u[c]=u[c]||{_errors:[]},u=u[c],d++}}};return o(this),n}static assert(t){if(!(t instanceof Te))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,O.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=e=>e.message){const e={},n=[];for(const o of this.issues)o.path.length>0?(e[o.path[0]]=e[o.path[0]]||[],e[o.path[0]].push(t(o))):n.push(t(o));return{formErrors:n,fieldErrors:e}}get formErrors(){return this.flatten()}}Te.create=i=>new Te(i);const Ht=(i,t)=>{let e;switch(i.code){case T.invalid_type:i.received===x.undefined?e="Required":e=`Expected ${i.expected}, received ${i.received}`;break;case T.invalid_literal:e=`Invalid literal value, expected ${JSON.stringify(i.expected,O.jsonStringifyReplacer)}`;break;case T.unrecognized_keys:e=`Unrecognized key(s) in object: ${O.joinValues(i.keys,", ")}`;break;case T.invalid_union:e="Invalid input";break;case T.invalid_union_discriminator:e=`Invalid discriminator value. Expected ${O.joinValues(i.options)}`;break;case T.invalid_enum_value:e=`Invalid enum value. Expected ${O.joinValues(i.options)}, received '${i.received}'`;break;case T.invalid_arguments:e="Invalid function arguments";break;case T.invalid_return_type:e="Invalid function return type";break;case T.invalid_date:e="Invalid date";break;case T.invalid_string:typeof i.validation=="object"?"includes"in i.validation?(e=`Invalid input: must include "${i.validation.includes}"`,typeof i.validation.position=="number"&&(e=`${e} at one or more positions greater than or equal to ${i.validation.position}`)):"startsWith"in i.validation?e=`Invalid input: must start with "${i.validation.startsWith}"`:"endsWith"in i.validation?e=`Invalid input: must end with "${i.validation.endsWith}"`:O.assertNever(i.validation):i.validation!=="regex"?e=`Invalid ${i.validation}`:e="Invalid";break;case T.too_small:i.type==="array"?e=`Array must contain ${i.exact?"exactly":i.inclusive?"at least":"more than"} ${i.minimum} element(s)`:i.type==="string"?e=`String must contain ${i.exact?"exactly":i.inclusive?"at least":"over"} ${i.minimum} character(s)`:i.type==="number"?e=`Number must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${i.minimum}`:i.type==="date"?e=`Date must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(i.minimum))}`:e="Invalid input";break;case T.too_big:i.type==="array"?e=`Array must contain ${i.exact?"exactly":i.inclusive?"at most":"less than"} ${i.maximum} element(s)`:i.type==="string"?e=`String must contain ${i.exact?"exactly":i.inclusive?"at most":"under"} ${i.maximum} character(s)`:i.type==="number"?e=`Number must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="bigint"?e=`BigInt must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="date"?e=`Date must be ${i.exact?"exactly":i.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(i.maximum))}`:e="Invalid input";break;case T.custom:e="Invalid input";break;case T.invalid_intersection_types:e="Intersection results could not be merged";break;case T.not_multiple_of:e=`Number must be a multiple of ${i.multipleOf}`;break;case T.not_finite:e="Number must be finite";break;default:e=t.defaultError,O.assertNever(i)}return{message:e}};let cs=Ht;function ds(){return cs}const fs=i=>{const{data:t,path:e,errorMaps:n,issueData:o}=i,a=[...e,...o.path||[]],l={...o,path:a};if(o.message!==void 0)return{...o,path:a,message:o.message};let u="";const d=n.filter(c=>!!c).slice().reverse();for(const c of d)u=c(l,{data:t,defaultError:u}).message;return{...o,path:a,message:u}};function _(i,t){const e=ds(),n=fs({issueData:t,data:i.data,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,e,e===Ht?void 0:Ht].filter(o=>!!o)});i.common.issues.push(n)}class se{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,e){const n=[];for(const o of e){if(o.status==="aborted")return D;o.status==="dirty"&&t.dirty(),n.push(o.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,e){const n=[];for(const o of e){const a=await o.key,l=await o.value;n.push({key:a,value:l})}return se.mergeObjectSync(t,n)}static mergeObjectSync(t,e){const n={};for(const o of e){const{key:a,value:l}=o;if(a.status==="aborted"||l.status==="aborted")return D;a.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||o.alwaysSet)&&(n[a.value]=l.value)}return{status:t.value,value:n}}}const D=Object.freeze({status:"aborted"}),je=i=>({status:"dirty",value:i}),ue=i=>({status:"valid",value:i}),wn=i=>i.status==="aborted",Nn=i=>i.status==="dirty",Ge=i=>i.status==="valid",vt=i=>typeof Promise<"u"&&i instanceof Promise;var E;(function(i){i.errToObj=t=>typeof t=="string"?{message:t}:t||{},i.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(E||(E={}));var Tt=function(i,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(i):n?n.value:t.get(i)},no=function(i,t,e,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!o:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(i,e):o?o.value=e:t.set(i,e),e},et,tt;class he{constructor(t,e,n,o){this._cachedPath=[],this.parent=t,this.data=e,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Pn=(i,t)=>{if(Ge(t))return{success:!0,data:t.value};if(!i.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new Te(i.common.issues);return this._error=e,this._error}}};function F(i){if(!i)return{};const{errorMap:t,invalid_type_error:e,required_error:n,description:o}=i;if(t&&(e||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(l,u)=>{const{message:d}=i;return l.code==="invalid_enum_value"?{message:d??u.defaultError}:typeof u.data>"u"?{message:d??n??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:d??e??u.defaultError}},description:o}}class b{get description(){return this._def.description}_getType(t){return Ce(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:Ce(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new se,ctx:{common:t.parent.common,data:t.data,parsedType:Ce(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(vt(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const n=this.safeParse(t,e);if(n.success)return n.data;throw n.error}safeParse(t,e){const n={common:{issues:[],async:(e==null?void 0:e.async)??!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ce(t)},o=this._parseSync({data:t,path:n.path,parent:n});return Pn(n,o)}"~validate"(t){var n,o;const e={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ce(t)};if(!this["~standard"].async)try{const a=this._parseSync({data:t,path:[],parent:e});return Ge(a)?{value:a.value}:{issues:e.common.issues}}catch(a){(o=(n=a==null?void 0:a.message)==null?void 0:n.toLowerCase())!=null&&o.includes("encountered")&&(this["~standard"].async=!0),e.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:e}).then(a=>Ge(a)?{value:a.value}:{issues:e.common.issues})}async parseAsync(t,e){const n=await this.safeParseAsync(t,e);if(n.success)return n.data;throw n.error}async safeParseAsync(t,e){const n={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ce(t)},o=this._parse({data:t,path:n.path,parent:n}),a=await(vt(o)?o:Promise.resolve(o));return Pn(n,a)}refine(t,e){const n=o=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(o):e;return this._refinement((o,a)=>{const l=t(o),u=()=>a.addIssue({code:T.custom,...n(o)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(t,e){return this._refinement((n,o)=>t(n)?!0:(o.addIssue(typeof e=="function"?e(n,o):e),!1))}_refinement(t){return new $e({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return _e.create(this,this._def)}nullable(){return ze.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return me.create(this)}promise(){return It.create(this,this._def)}or(t){return _t.create([this,t],this._def)}and(t){return xt.create(this,t,this._def)}transform(t){return new $e({...F(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e=typeof t=="function"?t:()=>t;return new Kt({...F(this._def),innerType:this,defaultValue:e,typeName:w.ZodDefault})}brand(){return new Fs({typeName:w.ZodBranded,type:this,...F(this._def)})}catch(t){const e=typeof t=="function"?t:()=>t;return new Qt({...F(this._def),innerType:this,catchValue:e,typeName:w.ZodCatch})}describe(t){const e=this.constructor;return new e({...this._def,description:t})}pipe(t){return dn.create(this,t)}readonly(){return Xt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ps=/^c[^\s-]{8,}$/i,ms=/^[0-9a-z]+$/,hs=/^[0-9A-HJKMNP-TV-Z]{26}$/i,gs=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ys=/^[a-z0-9_-]{21}$/i,vs=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ts=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Cs=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_s="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let qt;const xs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Es=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Is=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ss=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,As=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ms=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,io="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ws=new RegExp(`^${io}$`);function oo(i){let t="[0-5]\\d";i.precision?t=`${t}\\.\\d{${i.precision}}`:i.precision==null&&(t=`${t}(\\.\\d+)?`);const e=i.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e}`}function Ns(i){return new RegExp(`^${oo(i)}$`)}function Ps(i){let t=`${io}T${oo(i)}`;const e=[];return e.push(i.local?"Z?":"Z"),i.offset&&e.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${e.join("|")})`,new RegExp(`^${t}$`)}function Rs(i,t){return!!((t==="v4"||!t)&&xs.test(i)||(t==="v6"||!t)&&Is.test(i))}function Ds(i,t){if(!vs.test(i))return!1;try{const[e]=i.split("."),n=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||t&&o.alg!==t)}catch{return!1}}function ks(i,t){return!!((t==="v4"||!t)&&Es.test(i)||(t==="v6"||!t)&&Ss.test(i))}class pe extends b{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==x.string){const a=this._getOrReturnCtx(t);return _(a,{code:T.invalid_type,expected:x.string,received:a.parsedType}),D}const n=new se;let o;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(o=this._getOrReturnCtx(t,o),_(o,{code:T.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")t.data.length>a.value&&(o=this._getOrReturnCtx(t,o),_(o,{code:T.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const l=t.data.length>a.value,u=t.data.length<a.value;(l||u)&&(o=this._getOrReturnCtx(t,o),l?_(o,{code:T.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&_(o,{code:T.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")Cs.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"email",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")qt||(qt=new RegExp(_s,"u")),qt.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"emoji",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")gs.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"uuid",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")ys.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"nanoid",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")ps.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"cuid",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")ms.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"cuid2",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")hs.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"ulid",code:T.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{o=this._getOrReturnCtx(t,o),_(o,{validation:"url",code:T.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"regex",code:T.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(o=this._getOrReturnCtx(t,o),_(o,{code:T.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(o=this._getOrReturnCtx(t,o),_(o,{code:T.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(o=this._getOrReturnCtx(t,o),_(o,{code:T.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Ps(a).test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{code:T.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?ws.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{code:T.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?Ns(a).test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{code:T.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?Ts.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"duration",code:T.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?Rs(t.data,a.version)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"ip",code:T.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?Ds(t.data,a.alg)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"jwt",code:T.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?ks(t.data,a.version)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"cidr",code:T.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?As.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"base64",code:T.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?Ms.test(t.data)||(o=this._getOrReturnCtx(t,o),_(o,{validation:"base64url",code:T.invalid_string,message:a.message}),n.dirty()):O.assertNever(a);return{status:n.value,value:t.data}}_regex(t,e,n){return this.refinement(o=>t.test(o),{validation:e,code:T.invalid_string,...E.errToObj(n)})}_addCheck(t){return new pe({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...E.errToObj(t)})}url(t){return this._addCheck({kind:"url",...E.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...E.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...E.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...E.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...E.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...E.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...E.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...E.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...E.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...E.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...E.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...E.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...E.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...E.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...E.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...E.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:e==null?void 0:e.position,...E.errToObj(e==null?void 0:e.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...E.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...E.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...E.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...E.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...E.errToObj(e)})}nonempty(t){return this.min(1,E.errToObj(t))}trim(){return new pe({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new pe({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new pe({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}pe.create=i=>new pe({checks:[],typeName:w.ZodString,coerce:(i==null?void 0:i.coerce)??!1,...F(i)});function Ls(i,t){const e=(i.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=e>n?e:n,a=Number.parseInt(i.toFixed(o).replace(".","")),l=Number.parseInt(t.toFixed(o).replace(".",""));return a%l/10**o}class Ne extends b{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==x.number){const a=this._getOrReturnCtx(t);return _(a,{code:T.invalid_type,expected:x.number,received:a.parsedType}),D}let n;const o=new se;for(const a of this._def.checks)a.kind==="int"?O.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),_(n,{code:T.invalid_type,expected:"integer",received:"float",message:a.message}),o.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(n=this._getOrReturnCtx(t,n),_(n,{code:T.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(n=this._getOrReturnCtx(t,n),_(n,{code:T.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="multipleOf"?Ls(t.data,a.value)!==0&&(n=this._getOrReturnCtx(t,n),_(n,{code:T.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),_(n,{code:T.not_finite,message:a.message}),o.dirty()):O.assertNever(a);return{status:o.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,E.toString(e))}gt(t,e){return this.setLimit("min",t,!1,E.toString(e))}lte(t,e){return this.setLimit("max",t,!0,E.toString(e))}lt(t,e){return this.setLimit("max",t,!1,E.toString(e))}setLimit(t,e,n,o){return new Ne({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:n,message:E.toString(o)}]})}_addCheck(t){return new Ne({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:E.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:E.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:E.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&O.isInteger(t.value))}get isFinite(){let t=null,e=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(e===null||n.value>e)&&(e=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(e)&&Number.isFinite(t)}}Ne.create=i=>new Ne({checks:[],typeName:w.ZodNumber,coerce:(i==null?void 0:i.coerce)||!1,...F(i)});class Pe extends b{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==x.bigint)return this._getInvalidInput(t);let n;const o=new se;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(n=this._getOrReturnCtx(t,n),_(n,{code:T.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(n=this._getOrReturnCtx(t,n),_(n,{code:T.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),_(n,{code:T.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):O.assertNever(a);return{status:o.value,value:t.data}}_getInvalidInput(t){const e=this._getOrReturnCtx(t);return _(e,{code:T.invalid_type,expected:x.bigint,received:e.parsedType}),D}gte(t,e){return this.setLimit("min",t,!0,E.toString(e))}gt(t,e){return this.setLimit("min",t,!1,E.toString(e))}lte(t,e){return this.setLimit("max",t,!0,E.toString(e))}lt(t,e){return this.setLimit("max",t,!1,E.toString(e))}setLimit(t,e,n,o){return new Pe({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:n,message:E.toString(o)}]})}_addCheck(t){return new Pe({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:E.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}Pe.create=i=>new Pe({checks:[],typeName:w.ZodBigInt,coerce:(i==null?void 0:i.coerce)??!1,...F(i)});class Ct extends b{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==x.boolean){const n=this._getOrReturnCtx(t);return _(n,{code:T.invalid_type,expected:x.boolean,received:n.parsedType}),D}return ue(t.data)}}Ct.create=i=>new Ct({typeName:w.ZodBoolean,coerce:(i==null?void 0:i.coerce)||!1,...F(i)});class Oe extends b{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==x.date){const a=this._getOrReturnCtx(t);return _(a,{code:T.invalid_type,expected:x.date,received:a.parsedType}),D}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return _(a,{code:T.invalid_date}),D}const n=new se;let o;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(o=this._getOrReturnCtx(t,o),_(o,{code:T.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(o=this._getOrReturnCtx(t,o),_(o,{code:T.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):O.assertNever(a);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Oe({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:E.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:E.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t!=null?new Date(t):null}}Oe.create=i=>new Oe({checks:[],coerce:(i==null?void 0:i.coerce)||!1,typeName:w.ZodDate,...F(i)});class Rn extends b{_parse(t){if(this._getType(t)!==x.symbol){const n=this._getOrReturnCtx(t);return _(n,{code:T.invalid_type,expected:x.symbol,received:n.parsedType}),D}return ue(t.data)}}Rn.create=i=>new Rn({typeName:w.ZodSymbol,...F(i)});class Dn extends b{_parse(t){if(this._getType(t)!==x.undefined){const n=this._getOrReturnCtx(t);return _(n,{code:T.invalid_type,expected:x.undefined,received:n.parsedType}),D}return ue(t.data)}}Dn.create=i=>new Dn({typeName:w.ZodUndefined,...F(i)});class kn extends b{_parse(t){if(this._getType(t)!==x.null){const n=this._getOrReturnCtx(t);return _(n,{code:T.invalid_type,expected:x.null,received:n.parsedType}),D}return ue(t.data)}}kn.create=i=>new kn({typeName:w.ZodNull,...F(i)});class Ln extends b{constructor(){super(...arguments),this._any=!0}_parse(t){return ue(t.data)}}Ln.create=i=>new Ln({typeName:w.ZodAny,...F(i)});class Wt extends b{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ue(t.data)}}Wt.create=i=>new Wt({typeName:w.ZodUnknown,...F(i)});class xe extends b{_parse(t){const e=this._getOrReturnCtx(t);return _(e,{code:T.invalid_type,expected:x.never,received:e.parsedType}),D}}xe.create=i=>new xe({typeName:w.ZodNever,...F(i)});class Fn extends b{_parse(t){if(this._getType(t)!==x.undefined){const n=this._getOrReturnCtx(t);return _(n,{code:T.invalid_type,expected:x.void,received:n.parsedType}),D}return ue(t.data)}}Fn.create=i=>new Fn({typeName:w.ZodVoid,...F(i)});class me extends b{_parse(t){const{ctx:e,status:n}=this._processInputParams(t),o=this._def;if(e.parsedType!==x.array)return _(e,{code:T.invalid_type,expected:x.array,received:e.parsedType}),D;if(o.exactLength!==null){const l=e.data.length>o.exactLength.value,u=e.data.length<o.exactLength.value;(l||u)&&(_(e,{code:l?T.too_big:T.too_small,minimum:u?o.exactLength.value:void 0,maximum:l?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&e.data.length<o.minLength.value&&(_(e,{code:T.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&e.data.length>o.maxLength.value&&(_(e,{code:T.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),e.common.async)return Promise.all([...e.data].map((l,u)=>o.type._parseAsync(new he(e,l,e.path,u)))).then(l=>se.mergeArray(n,l));const a=[...e.data].map((l,u)=>o.type._parseSync(new he(e,l,e.path,u)));return se.mergeArray(n,a)}get element(){return this._def.type}min(t,e){return new me({...this._def,minLength:{value:t,message:E.toString(e)}})}max(t,e){return new me({...this._def,maxLength:{value:t,message:E.toString(e)}})}length(t,e){return new me({...this._def,exactLength:{value:t,message:E.toString(e)}})}nonempty(t){return this.min(1,t)}}me.create=(i,t)=>new me({type:i,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...F(t)});function be(i){if(i instanceof Q){const t={};for(const e in i.shape){const n=i.shape[e];t[e]=_e.create(be(n))}return new Q({...i._def,shape:()=>t})}else return i instanceof me?new me({...i._def,type:be(i.element)}):i instanceof _e?_e.create(be(i.unwrap())):i instanceof ze?ze.create(be(i.unwrap())):i instanceof Re?Re.create(i.items.map(t=>be(t))):i}class Q extends b{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),e=O.objectKeys(t);return this._cached={shape:t,keys:e},this._cached}_parse(t){if(this._getType(t)!==x.object){const c=this._getOrReturnCtx(t);return _(c,{code:T.invalid_type,expected:x.object,received:c.parsedType}),D}const{status:n,ctx:o}=this._processInputParams(t),{shape:a,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof xe&&this._def.unknownKeys==="strip"))for(const c in o.data)l.includes(c)||u.push(c);const d=[];for(const c of l){const f=a[c],p=o.data[c];d.push({key:{status:"valid",value:c},value:f._parse(new he(o,p,o.path,c)),alwaysSet:c in o.data})}if(this._def.catchall instanceof xe){const c=this._def.unknownKeys;if(c==="passthrough")for(const f of u)d.push({key:{status:"valid",value:f},value:{status:"valid",value:o.data[f]}});else if(c==="strict")u.length>0&&(_(o,{code:T.unrecognized_keys,keys:u}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const f of u){const p=o.data[f];d.push({key:{status:"valid",value:f},value:c._parse(new he(o,p,o.path,f)),alwaysSet:f in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const c=[];for(const f of d){const p=await f.key,m=await f.value;c.push({key:p,value:m,alwaysSet:f.alwaysSet})}return c}).then(c=>se.mergeObjectSync(n,c)):se.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(t){return E.errToObj,new Q({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(e,n)=>{var a,l;const o=((l=(a=this._def).errorMap)==null?void 0:l.call(a,e,n).message)??n.defaultError;return e.code==="unrecognized_keys"?{message:E.errToObj(t).message??o}:{message:o}}}:{}})}strip(){return new Q({...this._def,unknownKeys:"strip"})}passthrough(){return new Q({...this._def,unknownKeys:"passthrough"})}extend(t){return new Q({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Q({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:w.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new Q({...this._def,catchall:t})}pick(t){const e={};for(const n of O.objectKeys(t))t[n]&&this.shape[n]&&(e[n]=this.shape[n]);return new Q({...this._def,shape:()=>e})}omit(t){const e={};for(const n of O.objectKeys(this.shape))t[n]||(e[n]=this.shape[n]);return new Q({...this._def,shape:()=>e})}deepPartial(){return be(this)}partial(t){const e={};for(const n of O.objectKeys(this.shape)){const o=this.shape[n];t&&!t[n]?e[n]=o:e[n]=o.optional()}return new Q({...this._def,shape:()=>e})}required(t){const e={};for(const n of O.objectKeys(this.shape))if(t&&!t[n])e[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof _e;)a=a._def.innerType;e[n]=a}return new Q({...this._def,shape:()=>e})}keyof(){return so(O.objectKeys(this.shape))}}Q.create=(i,t)=>new Q({shape:()=>i,unknownKeys:"strip",catchall:xe.create(),typeName:w.ZodObject,...F(t)});Q.strictCreate=(i,t)=>new Q({shape:()=>i,unknownKeys:"strict",catchall:xe.create(),typeName:w.ZodObject,...F(t)});Q.lazycreate=(i,t)=>new Q({shape:i,unknownKeys:"strip",catchall:xe.create(),typeName:w.ZodObject,...F(t)});class _t extends b{_parse(t){const{ctx:e}=this._processInputParams(t),n=this._def.options;function o(a){for(const u of a)if(u.result.status==="valid")return u.result;for(const u of a)if(u.result.status==="dirty")return e.common.issues.push(...u.ctx.common.issues),u.result;const l=a.map(u=>new Te(u.ctx.common.issues));return _(e,{code:T.invalid_union,unionErrors:l}),D}if(e.common.async)return Promise.all(n.map(async a=>{const l={...e,common:{...e.common,issues:[]},parent:null};return{result:await a._parseAsync({data:e.data,path:e.path,parent:l}),ctx:l}})).then(o);{let a;const l=[];for(const d of n){const c={...e,common:{...e.common,issues:[]},parent:null},f=d._parseSync({data:e.data,path:e.path,parent:c});if(f.status==="valid")return f;f.status==="dirty"&&!a&&(a={result:f,ctx:c}),c.common.issues.length&&l.push(c.common.issues)}if(a)return e.common.issues.push(...a.ctx.common.issues),a.result;const u=l.map(d=>new Te(d));return _(e,{code:T.invalid_union,unionErrors:u}),D}}get options(){return this._def.options}}_t.create=(i,t)=>new _t({options:i,typeName:w.ZodUnion,...F(t)});function Yt(i,t){const e=Ce(i),n=Ce(t);if(i===t)return{valid:!0,data:i};if(e===x.object&&n===x.object){const o=O.objectKeys(t),a=O.objectKeys(i).filter(u=>o.indexOf(u)!==-1),l={...i,...t};for(const u of a){const d=Yt(i[u],t[u]);if(!d.valid)return{valid:!1};l[u]=d.data}return{valid:!0,data:l}}else if(e===x.array&&n===x.array){if(i.length!==t.length)return{valid:!1};const o=[];for(let a=0;a<i.length;a++){const l=i[a],u=t[a],d=Yt(l,u);if(!d.valid)return{valid:!1};o.push(d.data)}return{valid:!0,data:o}}else return e===x.date&&n===x.date&&+i==+t?{valid:!0,data:i}:{valid:!1}}class xt extends b{_parse(t){const{status:e,ctx:n}=this._processInputParams(t),o=(a,l)=>{if(wn(a)||wn(l))return D;const u=Yt(a.value,l.value);return u.valid?((Nn(a)||Nn(l))&&e.dirty(),{status:e.value,value:u.data}):(_(n,{code:T.invalid_intersection_types}),D)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,l])=>o(a,l)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}xt.create=(i,t,e)=>new xt({left:i,right:t,typeName:w.ZodIntersection,...F(e)});class Re extends b{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==x.array)return _(n,{code:T.invalid_type,expected:x.array,received:n.parsedType}),D;if(n.data.length<this._def.items.length)return _(n,{code:T.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),D;!this._def.rest&&n.data.length>this._def.items.length&&(_(n,{code:T.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const a=[...n.data].map((l,u)=>{const d=this._def.items[u]||this._def.rest;return d?d._parse(new he(n,l,n.path,u)):null}).filter(l=>!!l);return n.common.async?Promise.all(a).then(l=>se.mergeArray(e,l)):se.mergeArray(e,a)}get items(){return this._def.items}rest(t){return new Re({...this._def,rest:t})}}Re.create=(i,t)=>{if(!Array.isArray(i))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Re({items:i,typeName:w.ZodTuple,rest:null,...F(t)})};class Et extends b{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==x.object)return _(n,{code:T.invalid_type,expected:x.object,received:n.parsedType}),D;const o=[],a=this._def.keyType,l=this._def.valueType;for(const u in n.data)o.push({key:a._parse(new he(n,u,n.path,u)),value:l._parse(new he(n,n.data[u],n.path,u)),alwaysSet:u in n.data});return n.common.async?se.mergeObjectAsync(e,o):se.mergeObjectSync(e,o)}get element(){return this._def.valueType}static create(t,e,n){return e instanceof b?new Et({keyType:t,valueType:e,typeName:w.ZodRecord,...F(n)}):new Et({keyType:pe.create(),valueType:t,typeName:w.ZodRecord,...F(e)})}}class Un extends b{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==x.map)return _(n,{code:T.invalid_type,expected:x.map,received:n.parsedType}),D;const o=this._def.keyType,a=this._def.valueType,l=[...n.data.entries()].map(([u,d],c)=>({key:o._parse(new he(n,u,n.path,[c,"key"])),value:a._parse(new he(n,d,n.path,[c,"value"]))}));if(n.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const d of l){const c=await d.key,f=await d.value;if(c.status==="aborted"||f.status==="aborted")return D;(c.status==="dirty"||f.status==="dirty")&&e.dirty(),u.set(c.value,f.value)}return{status:e.value,value:u}})}else{const u=new Map;for(const d of l){const c=d.key,f=d.value;if(c.status==="aborted"||f.status==="aborted")return D;(c.status==="dirty"||f.status==="dirty")&&e.dirty(),u.set(c.value,f.value)}return{status:e.value,value:u}}}}Un.create=(i,t,e)=>new Un({valueType:t,keyType:i,typeName:w.ZodMap,...F(e)});class st extends b{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==x.set)return _(n,{code:T.invalid_type,expected:x.set,received:n.parsedType}),D;const o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(_(n,{code:T.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),e.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(_(n,{code:T.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),e.dirty());const a=this._def.valueType;function l(d){const c=new Set;for(const f of d){if(f.status==="aborted")return D;f.status==="dirty"&&e.dirty(),c.add(f.value)}return{status:e.value,value:c}}const u=[...n.data.values()].map((d,c)=>a._parse(new he(n,d,n.path,c)));return n.common.async?Promise.all(u).then(d=>l(d)):l(u)}min(t,e){return new st({...this._def,minSize:{value:t,message:E.toString(e)}})}max(t,e){return new st({...this._def,maxSize:{value:t,message:E.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}st.create=(i,t)=>new st({valueType:i,minSize:null,maxSize:null,typeName:w.ZodSet,...F(t)});class Zt extends b{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}Zt.create=(i,t)=>new Zt({getter:i,typeName:w.ZodLazy,...F(t)});class Vn extends b{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return _(e,{received:e.data,code:T.invalid_literal,expected:this._def.value}),D}return{status:"valid",value:t.data}}get value(){return this._def.value}}Vn.create=(i,t)=>new Vn({value:i,typeName:w.ZodLiteral,...F(t)});function so(i,t){return new Be({values:i,typeName:w.ZodEnum,...F(t)})}class Be extends b{constructor(){super(...arguments),et.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const e=this._getOrReturnCtx(t),n=this._def.values;return _(e,{expected:O.joinValues(n),received:e.parsedType,code:T.invalid_type}),D}if(Tt(this,et,"f")||no(this,et,new Set(this._def.values),"f"),!Tt(this,et,"f").has(t.data)){const e=this._getOrReturnCtx(t),n=this._def.values;return _(e,{received:e.data,code:T.invalid_enum_value,options:n}),D}return ue(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return Be.create(t,{...this._def,...e})}exclude(t,e=this._def){return Be.create(this.options.filter(n=>!t.includes(n)),{...this._def,...e})}}et=new WeakMap;Be.create=so;class bn extends b{constructor(){super(...arguments),tt.set(this,void 0)}_parse(t){const e=O.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==x.string&&n.parsedType!==x.number){const o=O.objectValues(e);return _(n,{expected:O.joinValues(o),received:n.parsedType,code:T.invalid_type}),D}if(Tt(this,tt,"f")||no(this,tt,new Set(O.getValidEnumValues(this._def.values)),"f"),!Tt(this,tt,"f").has(t.data)){const o=O.objectValues(e);return _(n,{received:n.data,code:T.invalid_enum_value,options:o}),D}return ue(t.data)}get enum(){return this._def.values}}tt=new WeakMap;bn.create=(i,t)=>new bn({values:i,typeName:w.ZodNativeEnum,...F(t)});class It extends b{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==x.promise&&e.common.async===!1)return _(e,{code:T.invalid_type,expected:x.promise,received:e.parsedType}),D;const n=e.parsedType===x.promise?e.data:Promise.resolve(e.data);return ue(n.then(o=>this._def.type.parseAsync(o,{path:e.path,errorMap:e.common.contextualErrorMap})))}}It.create=(i,t)=>new It({type:i,typeName:w.ZodPromise,...F(t)});class $e extends b{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:n}=this._processInputParams(t),o=this._def.effect||null,a={addIssue:l=>{_(n,l),l.fatal?e.abort():e.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),o.type==="preprocess"){const l=o.transform(n.data,a);if(n.common.async)return Promise.resolve(l).then(async u=>{if(e.value==="aborted")return D;const d=await this._def.schema._parseAsync({data:u,path:n.path,parent:n});return d.status==="aborted"?D:d.status==="dirty"||e.value==="dirty"?je(d.value):d});{if(e.value==="aborted")return D;const u=this._def.schema._parseSync({data:l,path:n.path,parent:n});return u.status==="aborted"?D:u.status==="dirty"||e.value==="dirty"?je(u.value):u}}if(o.type==="refinement"){const l=u=>{const d=o.refinement(u,a);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return u.status==="aborted"?D:(u.status==="dirty"&&e.dirty(),l(u.value),{status:e.value,value:u.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>u.status==="aborted"?D:(u.status==="dirty"&&e.dirty(),l(u.value).then(()=>({status:e.value,value:u.value}))))}if(o.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ge(l))return l;const u=o.transform(l.value,a);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:u}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>Ge(l)?Promise.resolve(o.transform(l.value,a)).then(u=>({status:e.value,value:u})):l);O.assertNever(o)}}$e.create=(i,t,e)=>new $e({schema:i,typeName:w.ZodEffects,effect:t,...F(e)});$e.createWithPreprocess=(i,t,e)=>new $e({schema:t,effect:{type:"preprocess",transform:i},typeName:w.ZodEffects,...F(e)});class _e extends b{_parse(t){return this._getType(t)===x.undefined?ue(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_e.create=(i,t)=>new _e({innerType:i,typeName:w.ZodOptional,...F(t)});class ze extends b{_parse(t){return this._getType(t)===x.null?ue(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ze.create=(i,t)=>new ze({innerType:i,typeName:w.ZodNullable,...F(t)});class Kt extends b{_parse(t){const{ctx:e}=this._processInputParams(t);let n=e.data;return e.parsedType===x.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}Kt.create=(i,t)=>new Kt({innerType:i,typeName:w.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...F(t)});class Qt extends b{_parse(t){const{ctx:e}=this._processInputParams(t),n={...e,common:{...e.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return vt(o)?o.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Te(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Te(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Qt.create=(i,t)=>new Qt({innerType:i,typeName:w.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...F(t)});class qn extends b{_parse(t){if(this._getType(t)!==x.nan){const n=this._getOrReturnCtx(t);return _(n,{code:T.invalid_type,expected:x.nan,received:n.parsedType}),D}return{status:"valid",value:t.data}}}qn.create=i=>new qn({typeName:w.ZodNaN,...F(i)});class Fs extends b{_parse(t){const{ctx:e}=this._processInputParams(t),n=e.data;return this._def.type._parse({data:n,path:e.path,parent:e})}unwrap(){return this._def.type}}class dn extends b{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?D:a.status==="dirty"?(e.dirty(),je(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?D:o.status==="dirty"?(e.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(t,e){return new dn({in:t,out:e,typeName:w.ZodPipeline})}}class Xt extends b{_parse(t){const e=this._def.innerType._parse(t),n=o=>(Ge(o)&&(o.value=Object.freeze(o.value)),o);return vt(e)?e.then(o=>n(o)):n(e)}unwrap(){return this._def.innerType}}Xt.create=(i,t)=>new Xt({innerType:i,typeName:w.ZodReadonly,...F(t)});var w;(function(i){i.ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodSymbol="ZodSymbol",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodCatch="ZodCatch",i.ZodPromise="ZodPromise",i.ZodBranded="ZodBranded",i.ZodPipeline="ZodPipeline",i.ZodReadonly="ZodReadonly"})(w||(w={}));const we=pe.create,Gn=Ne.create;Pe.create;const Us=Ct.create;Oe.create;const On=Wt.create;xe.create;const nt=me.create,Vs=Q.create,bs=_t.create;xt.create;Re.create;const qs=Et.create,Gs=Zt.create,Os=Be.create;It.create;_e.create;ze.create;const Ue={string:i=>pe.create({...i,coerce:!0}),number:i=>Ne.create({...i,coerce:!0}),boolean:i=>Ct.create({...i,coerce:!0}),bigint:i=>Pe.create({...i,coerce:!0}),date:i=>Oe.create({...i,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Bs,$s;function zs(){return{geminiUrl:Bs,vertexUrl:$s}}function Js(i,t,e){var n,o,a;if(!(!((n=i.httpOptions)===null||n===void 0)&&n.baseUrl)){const l=zs();return i.vertexai?(o=l.vertexUrl)!==null&&o!==void 0?o:t:(a=l.geminiUrl)!==null&&a!==void 0?a:e}return i.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rt{}function A(i,t){const e=/\{([^}]+)\}/g;return i.replace(e,(n,o)=>{if(Object.prototype.hasOwnProperty.call(t,o)){const a=t[o];return a!=null?String(a):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function r(i,t,e){for(let a=0;a<t.length-1;a++){const l=t[a];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in i))if(Array.isArray(e))i[u]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[u])){const d=i[u];if(Array.isArray(e))for(let c=0;c<d.length;c++){const f=d[c];r(f,t.slice(a+1),e[c])}else for(const c of d)r(c,t.slice(a+1),e)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in i||(i[u]=[{}]);const d=i[u];r(d[0],t.slice(a+1),e);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=t[t.length-1],o=i[n];if(o!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===o)return;if(typeof o=="object"&&typeof e=="object"&&o!==null&&e!==null)Object.assign(o,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else i[n]=e}function s(i,t){try{if(t.length===1&&t[0]==="_self")return i;for(let e=0;e<t.length;e++){if(typeof i!="object"||i===null)return;const n=t[e];if(n.endsWith("[]")){const o=n.slice(0,-2);if(o in i){const a=i[o];return Array.isArray(a)?a.map(l=>s(l,t.slice(e+1))):void 0}else return}else i=i[n]}return i}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Bn;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Bn||(Bn={}));var $n;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})($n||($n={}));var fe;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(fe||(fe={}));var zn;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(zn||(zn={}));var Jn;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(Jn||(Jn={}));var Hn;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(Hn||(Hn={}));var Wn;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Wn||(Wn={}));var Yn;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(Yn||(Yn={}));var Zn;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY"})(Zn||(Zn={}));var Kn;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(Kn||(Kn={}));var Qn;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Qn||(Qn={}));var Xn;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Xn||(Xn={}));var jn;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(jn||(jn={}));var St;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(St||(St={}));var ei;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ei||(ei={}));var jt;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(jt||(jt={}));var ti;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ti||(ti={}));var ni;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(ni||(ni={}));var ii;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(ii||(ii={}));var oi;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(oi||(oi={}));var si;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(si||(si={}));var ri;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(ri||(ri={}));var ai;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(ai||(ai={}));var li;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(li||(li={}));var ui;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi"})(ui||(ui={}));var ci;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ci||(ci={}));var di;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(di||(di={}));var fi;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(fi||(fi={}));var pi;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(pi||(pi={}));var mi;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(mi||(mi={}));var hi;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(hi||(hi={}));var gi;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(gi||(gi={}));var yi;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(yi||(yi={}));var vi;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(vi||(vi={}));var Ti;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(Ti||(Ti={}));var Ci;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Ci||(Ci={}));var _i;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(_i||(_i={}));var xi;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(xi||(xi={}));var Ei;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY"})(Ei||(Ei={}));var qe;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(qe||(qe={}));class Qe{get text(){var t,e,n,o,a,l,u,d;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const p=[];for(const m of(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[h,y]of Object.entries(m))h!=="text"&&h!=="thought"&&(y!==null||y!==void 0)&&p.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,c+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var t,e,n,o,a,l,u,d;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const p of(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,h]of Object.entries(p))m!=="inlineData"&&(h!==null||h!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(c+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var t,e,n,o,a,l,u,d;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var t,e,n,o,a,l,u,d,c;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var t,e,n,o,a,l,u,d,c;if(((o=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class Ii{}class Si{}class Hs{}class Ws{}class Ai{}class Mi{}class wi{}class Ys{}class Ni{}class Pi{}class Ri{}class Zs{}class en{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class Ks{}class Qs{}class Xs{get text(){var t,e,n;let o="",a=!1;const l=[];for(const u of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;a=!0,o+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?o:void 0}get data(){var t,e,n;let o="";const a=[];for(const l of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&a.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(o+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class js{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W(i,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function ro(i,t){const e=W(i,t);return e?e.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:e.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${e}`:e:""}function ao(i,t){return Array.isArray(t)?t.map(e=>At(i,e)):[At(i,t)]}function At(i,t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function er(i,t){const e=At(i,t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function tr(i,t){const e=At(i,t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Di(i,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function lo(i,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Di(i,e)):[Di(i,t)]}function tn(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function ki(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function Li(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function ae(i,t){if(t==null)throw new Error("ContentUnion is required");return tn(t)?t:{role:"user",parts:lo(i,t)}}function uo(i,t){if(!t)return[];if(i.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=ae(i,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const e=ae(i,t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>ae(i,e)):[ae(i,t)]}function ce(i,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ki(t)||Li(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ae(i,t)]}const e=[],n=[],o=tn(t[0]);for(const a of t){const l=tn(a);if(l!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(a);else{if(ki(a)||Li(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return o||e.push({role:"user",parts:lo(i,n)}),e}const Fi=Os(["string","number","integer","object","array","boolean","null"]),nr=bs([Fi,nt(Fi)]);function ir(i=!0){const t=Gs(()=>{const e=Vs({type:nr.optional(),format:we().optional(),title:we().optional(),description:we().optional(),default:On().optional(),items:t.optional(),minItems:Ue.string().optional(),maxItems:Ue.string().optional(),enum:nt(On()).optional(),properties:qs(we(),t).optional(),required:nt(we()).optional(),minProperties:Ue.string().optional(),maxProperties:Ue.string().optional(),propertyOrdering:nt(we()).optional(),minimum:Gn().optional(),maximum:Gn().optional(),minLength:Ue.string().optional(),maxLength:Ue.string().optional(),pattern:we().optional(),anyOf:nt(t).optional(),additionalProperties:Us().optional()});return i?e.strict():e});return t}function or(i,t){i.includes("null")&&(t.nullable=!0);const e=i.filter(n=>n!=="null");if(e.length===1)t.type=Object.keys(fe).includes(e[0].toUpperCase())?fe[e[0].toUpperCase()]:fe.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of e)t.anyOf.push({type:Object.keys(fe).includes(n.toUpperCase())?fe[n.toUpperCase()]:fe.TYPE_UNSPECIFIED})}}function it(i){const t={},e=["items"],n=["anyOf"],o=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=i.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(t.nullable=!0,i=a[1]):a[1].type==="null"&&(t.nullable=!0,i=a[0])),i.type instanceof Array&&or(i.type,t);for(const[l,u]of Object.entries(i))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.keys(fe).includes(u.toUpperCase())?u.toUpperCase():fe.TYPE_UNSPECIFIED}else if(e.includes(l))t[l]=it(u);else if(n.includes(l)){const d=[];for(const c of u){if(c.type=="null"){t.nullable=!0;continue}d.push(it(c))}t[l]=d}else if(o.includes(l)){const d={};for(const[c,f]of Object.entries(u))d[c]=it(f);t[l]=d}else{if(l==="additionalProperties")continue;t[l]=u}return t}function Mt(i,t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=ir().parse(t);return it(e)}else return it(t)}function co(i,t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function fo(i,t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function wt(i,t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Mt(i,e.parameters)),e.response&&(e.response=Mt(i,e.response));return t}function Nt(i,t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function sr(i,t,e,n=1){const o=!t.startsWith(`${e}/`)&&t.split("/").length===n;return i.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${i.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:o?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}/${t}`:t:o?`${e}/${t}`:t}function Ee(i,t){if(typeof t!="string")throw new Error("name must be a string");return sr(i,t,"cachedContents")}function po(i,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Ie(i,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function rr(i){return i!=null&&typeof i=="object"&&"name"in i}function ar(i){return i!=null&&typeof i=="object"&&"video"in i}function lr(i){return i!=null&&typeof i=="object"&&"uri"in i}function mo(i,t){var e;let n;if(rr(t)&&(n=t.name),!(lr(t)&&(n=t.uri,n===void 0))&&!(ar(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ho(i,t){let e;return i.isVertexAI()?e=t?"publishers/google/models":"models":e=t?"models":"tunedModels",e}function go(i,t){for(const e of["models","tunedModels","publisherModels"])if(ur(t,e))return t[e];return[]}function ur(i,t){return i!==null&&typeof i=="object"&&t in i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cr(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function dr(i,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&r(e,["data"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function fr(i,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function pr(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],cr(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],dr(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],fr(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Ui(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>pr(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function mr(i,t){const e={},n=s(t,["behavior"]);n!=null&&r(e,["behavior"],n);const o=s(t,["description"]);o!=null&&r(e,["description"],o);const a=s(t,["name"]);a!=null&&r(e,["name"],a);const l=s(t,["parameters"]);l!=null&&r(e,["parameters"],l);const u=s(t,["response"]);return u!=null&&r(e,["response"],u),e}function hr(i,t){const e={},n=s(t,["startTime"]);n!=null&&r(e,["startTime"],n);const o=s(t,["endTime"]);return o!=null&&r(e,["endTime"],o),e}function gr(i,t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],hr(i,n)),e}function yr(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["dynamicThreshold"]);return o!=null&&r(e,["dynamicThreshold"],o),e}function vr(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],yr(i,n)),e}function Tr(){return{}}function Cr(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>mr(i,c))),r(e,["functionDeclarations"],d)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(t,["googleSearch"]);o!=null&&r(e,["googleSearch"],gr(i,o));const a=s(t,["googleSearchRetrieval"]);if(a!=null&&r(e,["googleSearchRetrieval"],vr(i,a)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&r(e,["urlContext"],Tr());const u=s(t,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function _r(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["allowedFunctionNames"]);return o!=null&&r(e,["allowedFunctionNames"],o),e}function xr(i,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const o=s(t,["longitude"]);return o!=null&&r(e,["longitude"],o),e}function Er(i,t){const e={},n=s(t,["latLng"]);n!=null&&r(e,["latLng"],xr(i,n));const o=s(t,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function Ir(i,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],_r(i,n));const o=s(t,["retrievalConfig"]);return o!=null&&r(e,["retrievalConfig"],Er(i,o)),e}function Sr(i,t,e){const n={},o=s(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const a=s(t,["expireTime"]);e!==void 0&&a!=null&&r(e,["expireTime"],a);const l=s(t,["displayName"]);e!==void 0&&l!=null&&r(e,["displayName"],l);const u=s(t,["contents"]);if(e!==void 0&&u!=null){let p=ce(i,u);Array.isArray(p)&&(p=p.map(m=>Ui(i,m))),r(e,["contents"],p)}const d=s(t,["systemInstruction"]);e!==void 0&&d!=null&&r(e,["systemInstruction"],Ui(i,ae(i,d)));const c=s(t,["tools"]);if(e!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>Cr(i,m))),r(e,["tools"],p)}const f=s(t,["toolConfig"]);if(e!==void 0&&f!=null&&r(e,["toolConfig"],Ir(i,f)),s(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Ar(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],ro(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],Sr(i,o,e)),e}function Mr(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],Ee(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function wr(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],Ee(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function Nr(i,t,e){const n={},o=s(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const a=s(t,["expireTime"]);return e!==void 0&&a!=null&&r(e,["expireTime"],a),n}function Pr(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],Ee(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],Nr(i,o,e)),e}function Rr(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);return e!==void 0&&a!=null&&r(e,["_query","pageToken"],a),n}function Dr(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Rr(i,n,e)),e}function kr(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function Lr(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["data"]);o!=null&&r(e,["data"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Fr(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["fileUri"]);o!=null&&r(e,["fileUri"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Ur(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],kr(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],Lr(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],Fr(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Vi(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ur(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function Vr(i,t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&r(e,["description"],n);const o=s(t,["name"]);o!=null&&r(e,["name"],o);const a=s(t,["parameters"]);a!=null&&r(e,["parameters"],a);const l=s(t,["response"]);return l!=null&&r(e,["response"],l),e}function br(i,t){const e={},n=s(t,["startTime"]);n!=null&&r(e,["startTime"],n);const o=s(t,["endTime"]);return o!=null&&r(e,["endTime"],o),e}function qr(i,t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],br(i,n)),e}function Gr(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["dynamicThreshold"]);return o!=null&&r(e,["dynamicThreshold"],o),e}function Or(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Gr(i,n)),e}function Br(){return{}}function $r(i,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function zr(i,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],$r(i,n));const o=s(t,["authType"]);o!=null&&r(e,["authType"],o);const a=s(t,["googleServiceAccountConfig"]);a!=null&&r(e,["googleServiceAccountConfig"],a);const l=s(t,["httpBasicAuthConfig"]);l!=null&&r(e,["httpBasicAuthConfig"],l);const u=s(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const d=s(t,["oidcConfig"]);return d!=null&&r(e,["oidcConfig"],d),e}function Jr(i,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],zr(i,n)),e}function Hr(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>Vr(i,p))),r(e,["functionDeclarations"],f)}const o=s(t,["retrieval"]);o!=null&&r(e,["retrieval"],o);const a=s(t,["googleSearch"]);a!=null&&r(e,["googleSearch"],qr(i,a));const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],Or(i,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],Br());const d=s(t,["googleMaps"]);if(d!=null&&r(e,["googleMaps"],Jr(i,d)),s(t,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=s(t,["codeExecution"]);return c!=null&&r(e,["codeExecution"],c),e}function Wr(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["allowedFunctionNames"]);return o!=null&&r(e,["allowedFunctionNames"],o),e}function Yr(i,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const o=s(t,["longitude"]);return o!=null&&r(e,["longitude"],o),e}function Zr(i,t){const e={},n=s(t,["latLng"]);n!=null&&r(e,["latLng"],Yr(i,n));const o=s(t,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function Kr(i,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],Wr(i,n));const o=s(t,["retrievalConfig"]);return o!=null&&r(e,["retrievalConfig"],Zr(i,o)),e}function Qr(i,t,e){const n={},o=s(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const a=s(t,["expireTime"]);e!==void 0&&a!=null&&r(e,["expireTime"],a);const l=s(t,["displayName"]);e!==void 0&&l!=null&&r(e,["displayName"],l);const u=s(t,["contents"]);if(e!==void 0&&u!=null){let m=ce(i,u);Array.isArray(m)&&(m=m.map(h=>Vi(i,h))),r(e,["contents"],m)}const d=s(t,["systemInstruction"]);e!==void 0&&d!=null&&r(e,["systemInstruction"],Vi(i,ae(i,d)));const c=s(t,["tools"]);if(e!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>Hr(i,h))),r(e,["tools"],m)}const f=s(t,["toolConfig"]);e!==void 0&&f!=null&&r(e,["toolConfig"],Kr(i,f));const p=s(t,["kmsKeyName"]);return e!==void 0&&p!=null&&r(e,["encryption_spec","kmsKeyName"],p),n}function Xr(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],ro(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],Qr(i,o,e)),e}function jr(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],Ee(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function ea(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],Ee(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function ta(i,t,e){const n={},o=s(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const a=s(t,["expireTime"]);return e!==void 0&&a!=null&&r(e,["expireTime"],a),n}function na(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],Ee(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],ta(i,o,e)),e}function ia(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);return e!==void 0&&a!=null&&r(e,["_query","pageToken"],a),n}function oa(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],ia(i,n,e)),e}function mt(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["displayName"]);o!=null&&r(e,["displayName"],o);const a=s(t,["model"]);a!=null&&r(e,["model"],a);const l=s(t,["createTime"]);l!=null&&r(e,["createTime"],l);const u=s(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const d=s(t,["expireTime"]);d!=null&&r(e,["expireTime"],d);const c=s(t,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function sa(){return{}}function ra(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["cachedContents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>mt(i,l))),r(e,["cachedContents"],a)}return e}function ht(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["displayName"]);o!=null&&r(e,["displayName"],o);const a=s(t,["model"]);a!=null&&r(e,["model"],a);const l=s(t,["createTime"]);l!=null&&r(e,["createTime"],l);const u=s(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const d=s(t,["expireTime"]);d!=null&&r(e,["expireTime"],d);const c=s(t,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function aa(){return{}}function la(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["cachedContents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>ht(i,l))),r(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Je;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Je||(Je={}));class Pt{constructor(t,e,n,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,o)}init(t,e,n){var o,a;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};n?typeof n=="object"?l=Object.assign({},n):l=n:l={config:{}},l.config&&(l.config.pageToken=e.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(o=l.config)===null||o===void 0?void 0:o.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ua extends rt{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new Pt(Je.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Xr(this.apiClient,t);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ht(this.apiClient,f))}else{const c=Ar(this.apiClient,t);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}}async get(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=jr(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ht(this.apiClient,f))}else{const c=Mr(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}}async delete(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ea(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(()=>{const f=aa(),p=new Pi;return Object.assign(p,f),p})}else{const c=wr(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(()=>{const f=sa(),p=new Pi;return Object.assign(p,f),p})}}async update(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=na(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>ht(this.apiClient,f))}else{const c=Pr(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>mt(this.apiClient,f))}}async listInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=oa(this.apiClient,t);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=la(this.apiClient,f),m=new Ri;return Object.assign(m,p),m})}else{const c=Dr(this.apiClient,t);return u=A("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=ra(this.apiClient,f),m=new Ri;return Object.assign(m,p),m})}}}function bi(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Y(i){return this instanceof Y?(this.v=i,this):new Y(i)}function ot(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),o,a=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),o[Symbol.asyncIterator]=function(){return this},o;function l(h){return function(y){return Promise.resolve(y).then(h,p)}}function u(h,y){n[h]&&(o[h]=function(v){return new Promise(function(C,I){a.push([h,v,C,I])>1||d(h,v)})},y&&(o[h]=y(o[h])))}function d(h,y){try{c(n[h](y))}catch(v){m(a[0][3],v)}}function c(h){h.value instanceof Y?Promise.resolve(h.value.v).then(f,p):m(a[0][2],h)}function f(h){d("next",h)}function p(h){d("throw",h)}function m(h,y){h(y),a.shift(),a.length&&d(a[0][0],a[0][1])}}function gt(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof bi=="function"?bi(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(a){e[a]=i[a]&&function(l){return new Promise(function(u,d){l=i[a](l),o(u,d,l.done,l.value)})}}function o(a,l,u,d){Promise.resolve(d).then(function(c){a({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ca(i){var t;if(i.candidates==null||i.candidates.length===0)return!1;const e=(t=i.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:yo(e)}function yo(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const t of i.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function da(i){if(i.length!==0){for(const t of i)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function qi(i){if(i===void 0||i.length===0)return[];const t=[],e=i.length;let n=0;for(;n<e;)if(i[n].role==="user")t.push(i[n]),n++;else{const o=[];let a=!0;for(;n<e&&i[n].role==="model";)o.push(i[n]),a&&!yo(i[n])&&(a=!1),n++;a?t.push(...o):t.pop()}return t}class fa{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new pa(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class pa{constructor(t,e,n,o={},a=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=o,this.history=a,this.sendPromise=Promise.resolve(),da(a)}async sendMessage(t){var e;await this.sendPromise;const n=ae(this.apiClient,t.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var a,l,u;const d=await o,c=(l=(a=d.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,f=d.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];f!=null&&(m=(u=f.slice(p))!==null&&u!==void 0?u:[]);const h=c?[c]:[];this.recordHistory(n,h,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(t){var e;await this.sendPromise;const n=ae(this.apiClient,t.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const a=await o;return this.processStreamResponse(a,n)}getHistory(t=!1){const e=t?qi(this.history):this.history;return structuredClone(e)}processStreamResponse(t,e){var n,o;return ot(this,arguments,function*(){var l,u,d,c;const f=[];try{for(var p=!0,m=gt(t),h;h=yield Y(m.next()),l=h.done,!l;p=!0){c=h.value,p=!1;const y=c;if(ca(y)){const v=(o=(n=y.candidates)===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.content;v!==void 0&&f.push(v)}yield yield Y(y)}}catch(y){u={error:y}}finally{try{!p&&!l&&(d=m.return)&&(yield Y(d.call(m)))}finally{if(u)throw u.error}}this.recordHistory(e,f)})}recordHistory(t,e,n){let o=[];e.length>0&&e.every(a=>a.role!==void 0)?o=e:o.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...qi(n)):this.history.push(t),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ma(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);return e!==void 0&&a!=null&&r(e,["_query","pageToken"],a),n}function ha(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],ma(i,n,e)),e}function ga(i,t){const e={},n=s(t,["details"]);n!=null&&r(e,["details"],n);const o=s(t,["message"]);o!=null&&r(e,["message"],o);const a=s(t,["code"]);return a!=null&&r(e,["code"],a),e}function ya(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["displayName"]);o!=null&&r(e,["displayName"],o);const a=s(t,["mimeType"]);a!=null&&r(e,["mimeType"],a);const l=s(t,["sizeBytes"]);l!=null&&r(e,["sizeBytes"],l);const u=s(t,["createTime"]);u!=null&&r(e,["createTime"],u);const d=s(t,["expirationTime"]);d!=null&&r(e,["expirationTime"],d);const c=s(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const f=s(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=s(t,["uri"]);p!=null&&r(e,["uri"],p);const m=s(t,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const h=s(t,["state"]);h!=null&&r(e,["state"],h);const y=s(t,["source"]);y!=null&&r(e,["source"],y);const v=s(t,["videoMetadata"]);v!=null&&r(e,["videoMetadata"],v);const C=s(t,["error"]);return C!=null&&r(e,["error"],ga(i,C)),e}function va(i,t){const e={},n=s(t,["file"]);n!=null&&r(e,["file"],ya(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function Ta(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","file"],mo(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function Ca(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","file"],mo(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function _a(i,t){const e={},n=s(t,["details"]);n!=null&&r(e,["details"],n);const o=s(t,["message"]);o!=null&&r(e,["message"],o);const a=s(t,["code"]);return a!=null&&r(e,["code"],a),e}function nn(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["displayName"]);o!=null&&r(e,["displayName"],o);const a=s(t,["mimeType"]);a!=null&&r(e,["mimeType"],a);const l=s(t,["sizeBytes"]);l!=null&&r(e,["sizeBytes"],l);const u=s(t,["createTime"]);u!=null&&r(e,["createTime"],u);const d=s(t,["expirationTime"]);d!=null&&r(e,["expirationTime"],d);const c=s(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const f=s(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=s(t,["uri"]);p!=null&&r(e,["uri"],p);const m=s(t,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const h=s(t,["state"]);h!=null&&r(e,["state"],h);const y=s(t,["source"]);y!=null&&r(e,["source"],y);const v=s(t,["videoMetadata"]);v!=null&&r(e,["videoMetadata"],v);const C=s(t,["error"]);return C!=null&&r(e,["error"],_a(i,C)),e}function xa(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["files"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>nn(i,l))),r(e,["files"],a)}return e}function Ea(){return{}}function Ia(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sa extends rt{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new Pt(Je.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>nn(this.apiClient,e))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ha(this.apiClient,t);return a=A("files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const c=xa(this.apiClient,d),f=new Zs;return Object.assign(f,c),f})}}async createInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=va(this.apiClient,t);return a=A("upload/v1beta/files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Ea(),c=new Ks;return Object.assign(c,d),c})}}async get(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ta(this.apiClient,t);return a=A("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>nn(this.apiClient,d))}}async delete(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ca(this.apiClient,t);return a=A("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Ia(),c=new Qs;return Object.assign(c,d),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Aa(i,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function Ma(i,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function vo(i,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Aa(i,n)),e}function wa(i,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Ma(i,n)),e}function Na(i,t){const e={},n=s(t,["speaker"]);n!=null&&r(e,["speaker"],n);const o=s(t,["voiceConfig"]);return o!=null&&r(e,["voiceConfig"],vo(i,o)),e}function Pa(i,t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>Na(i,a))),r(e,["speakerVoiceConfigs"],o)}return e}function Ra(i,t){const e={},n=s(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],vo(i,n));const o=s(t,["multiSpeakerVoiceConfig"]);o!=null&&r(e,["multiSpeakerVoiceConfig"],Pa(i,o));const a=s(t,["languageCode"]);return a!=null&&r(e,["languageCode"],a),e}function Da(i,t){const e={},n=s(t,["voiceConfig"]);if(n!=null&&r(e,["voiceConfig"],wa(i,n)),s(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=s(t,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function ka(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function La(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function Fa(i,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&r(e,["data"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Ua(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["data"]);o!=null&&r(e,["data"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Va(i,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function ba(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["fileUri"]);o!=null&&r(e,["fileUri"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function qa(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],ka(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],Fa(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],Va(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Ga(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],La(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],Ua(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],ba(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Oa(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>qa(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function Ba(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ga(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function $a(i,t){const e={},n=s(t,["behavior"]);n!=null&&r(e,["behavior"],n);const o=s(t,["description"]);o!=null&&r(e,["description"],o);const a=s(t,["name"]);a!=null&&r(e,["name"],a);const l=s(t,["parameters"]);l!=null&&r(e,["parameters"],l);const u=s(t,["response"]);return u!=null&&r(e,["response"],u),e}function za(i,t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&r(e,["description"],n);const o=s(t,["name"]);o!=null&&r(e,["name"],o);const a=s(t,["parameters"]);a!=null&&r(e,["parameters"],a);const l=s(t,["response"]);return l!=null&&r(e,["response"],l),e}function Ja(i,t){const e={},n=s(t,["startTime"]);n!=null&&r(e,["startTime"],n);const o=s(t,["endTime"]);return o!=null&&r(e,["endTime"],o),e}function Ha(i,t){const e={},n=s(t,["startTime"]);n!=null&&r(e,["startTime"],n);const o=s(t,["endTime"]);return o!=null&&r(e,["endTime"],o),e}function Wa(i,t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],Ja(i,n)),e}function Ya(i,t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],Ha(i,n)),e}function Za(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["dynamicThreshold"]);return o!=null&&r(e,["dynamicThreshold"],o),e}function Ka(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["dynamicThreshold"]);return o!=null&&r(e,["dynamicThreshold"],o),e}function Qa(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Za(i,n)),e}function Xa(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Ka(i,n)),e}function ja(){return{}}function el(i,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function tl(i,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],el(i,n));const o=s(t,["authType"]);o!=null&&r(e,["authType"],o);const a=s(t,["googleServiceAccountConfig"]);a!=null&&r(e,["googleServiceAccountConfig"],a);const l=s(t,["httpBasicAuthConfig"]);l!=null&&r(e,["httpBasicAuthConfig"],l);const u=s(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const d=s(t,["oidcConfig"]);return d!=null&&r(e,["oidcConfig"],d),e}function nl(i,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],tl(i,n)),e}function il(){return{}}function ol(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>$a(i,c))),r(e,["functionDeclarations"],d)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(t,["googleSearch"]);o!=null&&r(e,["googleSearch"],Wa(i,o));const a=s(t,["googleSearchRetrieval"]);if(a!=null&&r(e,["googleSearchRetrieval"],Qa(i,a)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&r(e,["urlContext"],il());const u=s(t,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function sl(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>za(i,p))),r(e,["functionDeclarations"],f)}const o=s(t,["retrieval"]);o!=null&&r(e,["retrieval"],o);const a=s(t,["googleSearch"]);a!=null&&r(e,["googleSearch"],Ya(i,a));const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],Xa(i,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],ja());const d=s(t,["googleMaps"]);if(d!=null&&r(e,["googleMaps"],nl(i,d)),s(t,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=s(t,["codeExecution"]);return c!=null&&r(e,["codeExecution"],c),e}function rl(i,t){const e={},n=s(t,["handle"]);if(n!=null&&r(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function al(i,t){const e={},n=s(t,["handle"]);n!=null&&r(e,["handle"],n);const o=s(t,["transparent"]);return o!=null&&r(e,["transparent"],o),e}function Gi(){return{}}function Oi(){return{}}function ll(i,t){const e={},n=s(t,["disabled"]);n!=null&&r(e,["disabled"],n);const o=s(t,["startOfSpeechSensitivity"]);o!=null&&r(e,["startOfSpeechSensitivity"],o);const a=s(t,["endOfSpeechSensitivity"]);a!=null&&r(e,["endOfSpeechSensitivity"],a);const l=s(t,["prefixPaddingMs"]);l!=null&&r(e,["prefixPaddingMs"],l);const u=s(t,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function ul(i,t){const e={},n=s(t,["disabled"]);n!=null&&r(e,["disabled"],n);const o=s(t,["startOfSpeechSensitivity"]);o!=null&&r(e,["startOfSpeechSensitivity"],o);const a=s(t,["endOfSpeechSensitivity"]);a!=null&&r(e,["endOfSpeechSensitivity"],a);const l=s(t,["prefixPaddingMs"]);l!=null&&r(e,["prefixPaddingMs"],l);const u=s(t,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function cl(i,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],ll(i,n));const o=s(t,["activityHandling"]);o!=null&&r(e,["activityHandling"],o);const a=s(t,["turnCoverage"]);return a!=null&&r(e,["turnCoverage"],a),e}function dl(i,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],ul(i,n));const o=s(t,["activityHandling"]);o!=null&&r(e,["activityHandling"],o);const a=s(t,["turnCoverage"]);return a!=null&&r(e,["turnCoverage"],a),e}function fl(i,t){const e={},n=s(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function pl(i,t){const e={},n=s(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function ml(i,t){const e={},n=s(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const o=s(t,["slidingWindow"]);return o!=null&&r(e,["slidingWindow"],fl(i,o)),e}function hl(i,t){const e={},n=s(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const o=s(t,["slidingWindow"]);return o!=null&&r(e,["slidingWindow"],pl(i,o)),e}function gl(i,t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&r(e,["proactiveAudio"],n),e}function yl(i,t){const e={},n=s(t,["proactiveAudio"]);return n!=null&&r(e,["proactiveAudio"],n),e}function vl(i,t,e){const n={},o=s(t,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],o);const a=s(t,["responseModalities"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","responseModalities"],a);const l=s(t,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const u=s(t,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const d=s(t,["topK"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","topK"],d);const c=s(t,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=s(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=s(t,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],Ra(i,fo(i,m)));const h=s(t,["enableAffectiveDialog"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],h);const y=s(t,["systemInstruction"]);e!==void 0&&y!=null&&r(e,["setup","systemInstruction"],Oa(i,ae(i,y)));const v=s(t,["tools"]);if(e!==void 0&&v!=null){let z=Nt(i,v);Array.isArray(z)&&(z=z.map(B=>ol(i,wt(i,B)))),r(e,["setup","tools"],z)}const C=s(t,["sessionResumption"]);e!==void 0&&C!=null&&r(e,["setup","sessionResumption"],rl(i,C));const I=s(t,["inputAudioTranscription"]);e!==void 0&&I!=null&&r(e,["setup","inputAudioTranscription"],Gi());const S=s(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","outputAudioTranscription"],Gi());const M=s(t,["realtimeInputConfig"]);e!==void 0&&M!=null&&r(e,["setup","realtimeInputConfig"],cl(i,M));const U=s(t,["contextWindowCompression"]);e!==void 0&&U!=null&&r(e,["setup","contextWindowCompression"],ml(i,U));const k=s(t,["proactivity"]);return e!==void 0&&k!=null&&r(e,["setup","proactivity"],gl(i,k)),n}function Tl(i,t,e){const n={},o=s(t,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],o);const a=s(t,["responseModalities"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","responseModalities"],a);const l=s(t,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const u=s(t,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const d=s(t,["topK"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","topK"],d);const c=s(t,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=s(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=s(t,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],Da(i,fo(i,m)));const h=s(t,["enableAffectiveDialog"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],h);const y=s(t,["systemInstruction"]);e!==void 0&&y!=null&&r(e,["setup","systemInstruction"],Ba(i,ae(i,y)));const v=s(t,["tools"]);if(e!==void 0&&v!=null){let z=Nt(i,v);Array.isArray(z)&&(z=z.map(B=>sl(i,wt(i,B)))),r(e,["setup","tools"],z)}const C=s(t,["sessionResumption"]);e!==void 0&&C!=null&&r(e,["setup","sessionResumption"],al(i,C));const I=s(t,["inputAudioTranscription"]);e!==void 0&&I!=null&&r(e,["setup","inputAudioTranscription"],Oi());const S=s(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","outputAudioTranscription"],Oi());const M=s(t,["realtimeInputConfig"]);e!==void 0&&M!=null&&r(e,["setup","realtimeInputConfig"],dl(i,M));const U=s(t,["contextWindowCompression"]);e!==void 0&&U!=null&&r(e,["setup","contextWindowCompression"],hl(i,U));const k=s(t,["proactivity"]);return e!==void 0&&k!=null&&r(e,["setup","proactivity"],yl(i,k)),n}function Cl(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["setup","model"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],vl(i,o,e)),e}function _l(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["setup","model"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],Tl(i,o,e)),e}function xl(){return{}}function El(){return{}}function Il(){return{}}function Sl(){return{}}function Al(i,t){const e={},n=s(t,["media"]);n!=null&&r(e,["mediaChunks"],ao(i,n));const o=s(t,["audio"]);o!=null&&r(e,["audio"],tr(i,o));const a=s(t,["audioStreamEnd"]);a!=null&&r(e,["audioStreamEnd"],a);const l=s(t,["video"]);l!=null&&r(e,["video"],er(i,l));const u=s(t,["text"]);return u!=null&&r(e,["text"],u),s(t,["activityStart"])!=null&&r(e,["activityStart"],xl()),s(t,["activityEnd"])!=null&&r(e,["activityEnd"],Il()),e}function Ml(i,t){const e={},n=s(t,["media"]);if(n!=null&&r(e,["mediaChunks"],ao(i,n)),s(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const o=s(t,["audioStreamEnd"]);if(o!=null&&r(e,["audioStreamEnd"],o),s(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(s(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return s(t,["activityStart"])!=null&&r(e,["activityStart"],El()),s(t,["activityEnd"])!=null&&r(e,["activityEnd"],Sl()),e}function To(i,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const o=s(t,["weight"]);return o!=null&&r(e,["weight"],o),e}function wl(i,t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>To(i,a))),r(e,["weightedPrompts"],o)}return e}function Co(i,t){const e={},n=s(t,["temperature"]);n!=null&&r(e,["temperature"],n);const o=s(t,["topK"]);o!=null&&r(e,["topK"],o);const a=s(t,["seed"]);a!=null&&r(e,["seed"],a);const l=s(t,["guidance"]);l!=null&&r(e,["guidance"],l);const u=s(t,["bpm"]);u!=null&&r(e,["bpm"],u);const d=s(t,["density"]);d!=null&&r(e,["density"],d);const c=s(t,["brightness"]);c!=null&&r(e,["brightness"],c);const f=s(t,["scale"]);f!=null&&r(e,["scale"],f);const p=s(t,["muteBass"]);p!=null&&r(e,["muteBass"],p);const m=s(t,["muteDrums"]);m!=null&&r(e,["muteDrums"],m);const h=s(t,["onlyBassAndDrums"]);h!=null&&r(e,["onlyBassAndDrums"],h);const y=s(t,["musicGenerationMode"]);return y!=null&&r(e,["musicGenerationMode"],y),e}function Nl(i,t){const e={},n=s(t,["musicGenerationConfig"]);return n!=null&&r(e,["musicGenerationConfig"],Co(i,n)),e}function _o(i,t){const e={},n=s(t,["model"]);return n!=null&&r(e,["model"],n),e}function xo(i,t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>To(i,a))),r(e,["weightedPrompts"],o)}return e}function on(i,t){const e={},n=s(t,["setup"]);n!=null&&r(e,["setup"],_o(i,n));const o=s(t,["clientContent"]);o!=null&&r(e,["clientContent"],xo(i,o));const a=s(t,["musicGenerationConfig"]);a!=null&&r(e,["musicGenerationConfig"],Co(i,a));const l=s(t,["playbackControl"]);return l!=null&&r(e,["playbackControl"],l),e}function Pl(){return{}}function Rl(){return{}}function Dl(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function kl(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function Ll(i,t){const e={},n=s(t,["data"]);n!=null&&r(e,["data"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Fl(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["data"]);o!=null&&r(e,["data"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Ul(i,t){const e={},n=s(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Vl(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["fileUri"]);o!=null&&r(e,["fileUri"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function bl(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],Dl(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],Ll(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],Ul(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function ql(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],kl(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],Fl(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],Vl(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Gl(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>bl(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function Ol(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>ql(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function Bi(i,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const o=s(t,["finished"]);return o!=null&&r(e,["finished"],o),e}function $i(i,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const o=s(t,["finished"]);return o!=null&&r(e,["finished"],o),e}function Bl(i,t){const e={},n=s(t,["retrievedUrl"]);n!=null&&r(e,["retrievedUrl"],n);const o=s(t,["urlRetrievalStatus"]);return o!=null&&r(e,["urlRetrievalStatus"],o),e}function $l(i,t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>Bl(i,a))),r(e,["urlMetadata"],o)}return e}function zl(i,t){const e={},n=s(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],Gl(i,n));const o=s(t,["turnComplete"]);o!=null&&r(e,["turnComplete"],o);const a=s(t,["interrupted"]);a!=null&&r(e,["interrupted"],a);const l=s(t,["groundingMetadata"]);l!=null&&r(e,["groundingMetadata"],l);const u=s(t,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const d=s(t,["inputTranscription"]);d!=null&&r(e,["inputTranscription"],Bi(i,d));const c=s(t,["outputTranscription"]);c!=null&&r(e,["outputTranscription"],Bi(i,c));const f=s(t,["urlContextMetadata"]);return f!=null&&r(e,["urlContextMetadata"],$l(i,f)),e}function Jl(i,t){const e={},n=s(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],Ol(i,n));const o=s(t,["turnComplete"]);o!=null&&r(e,["turnComplete"],o);const a=s(t,["interrupted"]);a!=null&&r(e,["interrupted"],a);const l=s(t,["groundingMetadata"]);l!=null&&r(e,["groundingMetadata"],l);const u=s(t,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const d=s(t,["inputTranscription"]);d!=null&&r(e,["inputTranscription"],$i(i,d));const c=s(t,["outputTranscription"]);return c!=null&&r(e,["outputTranscription"],$i(i,c)),e}function Hl(i,t){const e={},n=s(t,["id"]);n!=null&&r(e,["id"],n);const o=s(t,["args"]);o!=null&&r(e,["args"],o);const a=s(t,["name"]);return a!=null&&r(e,["name"],a),e}function Wl(i,t){const e={},n=s(t,["args"]);n!=null&&r(e,["args"],n);const o=s(t,["name"]);return o!=null&&r(e,["name"],o),e}function Yl(i,t){const e={},n=s(t,["functionCalls"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>Hl(i,a))),r(e,["functionCalls"],o)}return e}function Zl(i,t){const e={},n=s(t,["functionCalls"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>Wl(i,a))),r(e,["functionCalls"],o)}return e}function Kl(i,t){const e={},n=s(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function Ql(i,t){const e={},n=s(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function dt(i,t){const e={},n=s(t,["modality"]);n!=null&&r(e,["modality"],n);const o=s(t,["tokenCount"]);return o!=null&&r(e,["tokenCount"],o),e}function ft(i,t){const e={},n=s(t,["modality"]);n!=null&&r(e,["modality"],n);const o=s(t,["tokenCount"]);return o!=null&&r(e,["tokenCount"],o),e}function Xl(i,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const o=s(t,["cachedContentTokenCount"]);o!=null&&r(e,["cachedContentTokenCount"],o);const a=s(t,["responseTokenCount"]);a!=null&&r(e,["responseTokenCount"],a);const l=s(t,["toolUsePromptTokenCount"]);l!=null&&r(e,["toolUsePromptTokenCount"],l);const u=s(t,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const d=s(t,["totalTokenCount"]);d!=null&&r(e,["totalTokenCount"],d);const c=s(t,["promptTokensDetails"]);if(c!=null){let h=c;Array.isArray(h)&&(h=h.map(y=>dt(i,y))),r(e,["promptTokensDetails"],h)}const f=s(t,["cacheTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(y=>dt(i,y))),r(e,["cacheTokensDetails"],h)}const p=s(t,["responseTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(y=>dt(i,y))),r(e,["responseTokensDetails"],h)}const m=s(t,["toolUsePromptTokensDetails"]);if(m!=null){let h=m;Array.isArray(h)&&(h=h.map(y=>dt(i,y))),r(e,["toolUsePromptTokensDetails"],h)}return e}function jl(i,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const o=s(t,["cachedContentTokenCount"]);o!=null&&r(e,["cachedContentTokenCount"],o);const a=s(t,["candidatesTokenCount"]);a!=null&&r(e,["responseTokenCount"],a);const l=s(t,["toolUsePromptTokenCount"]);l!=null&&r(e,["toolUsePromptTokenCount"],l);const u=s(t,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const d=s(t,["totalTokenCount"]);d!=null&&r(e,["totalTokenCount"],d);const c=s(t,["promptTokensDetails"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(v=>ft(i,v))),r(e,["promptTokensDetails"],y)}const f=s(t,["cacheTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(v=>ft(i,v))),r(e,["cacheTokensDetails"],y)}const p=s(t,["candidatesTokensDetails"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(v=>ft(i,v))),r(e,["responseTokensDetails"],y)}const m=s(t,["toolUsePromptTokensDetails"]);if(m!=null){let y=m;Array.isArray(y)&&(y=y.map(v=>ft(i,v))),r(e,["toolUsePromptTokensDetails"],y)}const h=s(t,["trafficType"]);return h!=null&&r(e,["trafficType"],h),e}function eu(i,t){const e={},n=s(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function tu(i,t){const e={},n=s(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function nu(i,t){const e={},n=s(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const o=s(t,["resumable"]);o!=null&&r(e,["resumable"],o);const a=s(t,["lastConsumedClientMessageIndex"]);return a!=null&&r(e,["lastConsumedClientMessageIndex"],a),e}function iu(i,t){const e={},n=s(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const o=s(t,["resumable"]);o!=null&&r(e,["resumable"],o);const a=s(t,["lastConsumedClientMessageIndex"]);return a!=null&&r(e,["lastConsumedClientMessageIndex"],a),e}function ou(i,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],Pl());const o=s(t,["serverContent"]);o!=null&&r(e,["serverContent"],zl(i,o));const a=s(t,["toolCall"]);a!=null&&r(e,["toolCall"],Yl(i,a));const l=s(t,["toolCallCancellation"]);l!=null&&r(e,["toolCallCancellation"],Kl(i,l));const u=s(t,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],Xl(i,u));const d=s(t,["goAway"]);d!=null&&r(e,["goAway"],eu(i,d));const c=s(t,["sessionResumptionUpdate"]);return c!=null&&r(e,["sessionResumptionUpdate"],nu(i,c)),e}function su(i,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],Rl());const o=s(t,["serverContent"]);o!=null&&r(e,["serverContent"],Jl(i,o));const a=s(t,["toolCall"]);a!=null&&r(e,["toolCall"],Zl(i,a));const l=s(t,["toolCallCancellation"]);l!=null&&r(e,["toolCallCancellation"],Ql(i,l));const u=s(t,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],jl(i,u));const d=s(t,["goAway"]);d!=null&&r(e,["goAway"],tu(i,d));const c=s(t,["sessionResumptionUpdate"]);return c!=null&&r(e,["sessionResumptionUpdate"],iu(i,c)),e}function ru(){return{}}function au(i,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const o=s(t,["weight"]);return o!=null&&r(e,["weight"],o),e}function lu(i,t){const e={},n=s(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>au(i,a))),r(e,["weightedPrompts"],o)}return e}function uu(i,t){const e={},n=s(t,["temperature"]);n!=null&&r(e,["temperature"],n);const o=s(t,["topK"]);o!=null&&r(e,["topK"],o);const a=s(t,["seed"]);a!=null&&r(e,["seed"],a);const l=s(t,["guidance"]);l!=null&&r(e,["guidance"],l);const u=s(t,["bpm"]);u!=null&&r(e,["bpm"],u);const d=s(t,["density"]);d!=null&&r(e,["density"],d);const c=s(t,["brightness"]);c!=null&&r(e,["brightness"],c);const f=s(t,["scale"]);f!=null&&r(e,["scale"],f);const p=s(t,["muteBass"]);p!=null&&r(e,["muteBass"],p);const m=s(t,["muteDrums"]);m!=null&&r(e,["muteDrums"],m);const h=s(t,["onlyBassAndDrums"]);h!=null&&r(e,["onlyBassAndDrums"],h);const y=s(t,["musicGenerationMode"]);return y!=null&&r(e,["musicGenerationMode"],y),e}function cu(i,t){const e={},n=s(t,["clientContent"]);n!=null&&r(e,["clientContent"],lu(i,n));const o=s(t,["musicGenerationConfig"]);return o!=null&&r(e,["musicGenerationConfig"],uu(i,o)),e}function du(i,t){const e={},n=s(t,["data"]);n!=null&&r(e,["data"],n);const o=s(t,["mimeType"]);o!=null&&r(e,["mimeType"],o);const a=s(t,["sourceMetadata"]);return a!=null&&r(e,["sourceMetadata"],cu(i,a)),e}function fu(i,t){const e={},n=s(t,["audioChunks"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>du(i,a))),r(e,["audioChunks"],o)}return e}function pu(i,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const o=s(t,["filteredReason"]);return o!=null&&r(e,["filteredReason"],o),e}function mu(i,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],ru());const o=s(t,["serverContent"]);o!=null&&r(e,["serverContent"],fu(i,o));const a=s(t,["filteredPrompt"]);return a!=null&&r(e,["filteredPrompt"],pu(i,a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hu(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function gu(i,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&r(e,["data"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function yu(i,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function vu(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],hu(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],gu(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],yu(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Rt(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>vu(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function Tu(i,t){const e={},n=s(t,["anyOf"]);n!=null&&r(e,["anyOf"],n);const o=s(t,["default"]);o!=null&&r(e,["default"],o);const a=s(t,["description"]);a!=null&&r(e,["description"],a);const l=s(t,["enum"]);l!=null&&r(e,["enum"],l);const u=s(t,["example"]);u!=null&&r(e,["example"],u);const d=s(t,["format"]);d!=null&&r(e,["format"],d);const c=s(t,["items"]);c!=null&&r(e,["items"],c);const f=s(t,["maxItems"]);f!=null&&r(e,["maxItems"],f);const p=s(t,["maxLength"]);p!=null&&r(e,["maxLength"],p);const m=s(t,["maxProperties"]);m!=null&&r(e,["maxProperties"],m);const h=s(t,["maximum"]);h!=null&&r(e,["maximum"],h);const y=s(t,["minItems"]);y!=null&&r(e,["minItems"],y);const v=s(t,["minLength"]);v!=null&&r(e,["minLength"],v);const C=s(t,["minProperties"]);C!=null&&r(e,["minProperties"],C);const I=s(t,["minimum"]);I!=null&&r(e,["minimum"],I);const S=s(t,["nullable"]);S!=null&&r(e,["nullable"],S);const M=s(t,["pattern"]);M!=null&&r(e,["pattern"],M);const U=s(t,["properties"]);U!=null&&r(e,["properties"],U);const k=s(t,["propertyOrdering"]);k!=null&&r(e,["propertyOrdering"],k);const z=s(t,["required"]);z!=null&&r(e,["required"],z);const B=s(t,["title"]);B!=null&&r(e,["title"],B);const Z=s(t,["type"]);return Z!=null&&r(e,["type"],Z),e}function Cu(i,t){const e={};if(s(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(t,["category"]);n!=null&&r(e,["category"],n);const o=s(t,["threshold"]);return o!=null&&r(e,["threshold"],o),e}function _u(i,t){const e={},n=s(t,["behavior"]);n!=null&&r(e,["behavior"],n);const o=s(t,["description"]);o!=null&&r(e,["description"],o);const a=s(t,["name"]);a!=null&&r(e,["name"],a);const l=s(t,["parameters"]);l!=null&&r(e,["parameters"],l);const u=s(t,["response"]);return u!=null&&r(e,["response"],u),e}function xu(i,t){const e={},n=s(t,["startTime"]);n!=null&&r(e,["startTime"],n);const o=s(t,["endTime"]);return o!=null&&r(e,["endTime"],o),e}function Eu(i,t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],xu(i,n)),e}function Iu(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["dynamicThreshold"]);return o!=null&&r(e,["dynamicThreshold"],o),e}function Su(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Iu(i,n)),e}function Au(){return{}}function Mu(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(c=>_u(i,c))),r(e,["functionDeclarations"],d)}if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(t,["googleSearch"]);o!=null&&r(e,["googleSearch"],Eu(i,o));const a=s(t,["googleSearchRetrieval"]);if(a!=null&&r(e,["googleSearchRetrieval"],Su(i,a)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(t,["urlContext"])!=null&&r(e,["urlContext"],Au());const u=s(t,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function wu(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["allowedFunctionNames"]);return o!=null&&r(e,["allowedFunctionNames"],o),e}function Nu(i,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const o=s(t,["longitude"]);return o!=null&&r(e,["longitude"],o),e}function Pu(i,t){const e={},n=s(t,["latLng"]);n!=null&&r(e,["latLng"],Nu(i,n));const o=s(t,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function Ru(i,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],wu(i,n));const o=s(t,["retrievalConfig"]);return o!=null&&r(e,["retrievalConfig"],Pu(i,o)),e}function Du(i,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function Eo(i,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Du(i,n)),e}function ku(i,t){const e={},n=s(t,["speaker"]);n!=null&&r(e,["speaker"],n);const o=s(t,["voiceConfig"]);return o!=null&&r(e,["voiceConfig"],Eo(i,o)),e}function Lu(i,t){const e={},n=s(t,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>ku(i,a))),r(e,["speakerVoiceConfigs"],o)}return e}function Fu(i,t){const e={},n=s(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],Eo(i,n));const o=s(t,["multiSpeakerVoiceConfig"]);o!=null&&r(e,["multiSpeakerVoiceConfig"],Lu(i,o));const a=s(t,["languageCode"]);return a!=null&&r(e,["languageCode"],a),e}function Uu(i,t){const e={},n=s(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const o=s(t,["thinkingBudget"]);return o!=null&&r(e,["thinkingBudget"],o),e}function Vu(i,t,e){const n={},o=s(t,["systemInstruction"]);e!==void 0&&o!=null&&r(e,["systemInstruction"],Rt(i,ae(i,o)));const a=s(t,["temperature"]);a!=null&&r(n,["temperature"],a);const l=s(t,["topP"]);l!=null&&r(n,["topP"],l);const u=s(t,["topK"]);u!=null&&r(n,["topK"],u);const d=s(t,["candidateCount"]);d!=null&&r(n,["candidateCount"],d);const c=s(t,["maxOutputTokens"]);c!=null&&r(n,["maxOutputTokens"],c);const f=s(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=s(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const m=s(t,["logprobs"]);m!=null&&r(n,["logprobs"],m);const h=s(t,["presencePenalty"]);h!=null&&r(n,["presencePenalty"],h);const y=s(t,["frequencyPenalty"]);y!=null&&r(n,["frequencyPenalty"],y);const v=s(t,["seed"]);v!=null&&r(n,["seed"],v);const C=s(t,["responseMimeType"]);C!=null&&r(n,["responseMimeType"],C);const I=s(t,["responseSchema"]);if(I!=null&&r(n,["responseSchema"],Tu(i,Mt(i,I))),s(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=s(t,["safetySettings"]);if(e!==void 0&&S!=null){let $=S;Array.isArray($)&&($=$.map(ee=>Cu(i,ee))),r(e,["safetySettings"],$)}const M=s(t,["tools"]);if(e!==void 0&&M!=null){let $=Nt(i,M);Array.isArray($)&&($=$.map(ee=>Mu(i,wt(i,ee)))),r(e,["tools"],$)}const U=s(t,["toolConfig"]);if(e!==void 0&&U!=null&&r(e,["toolConfig"],Ru(i,U)),s(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=s(t,["cachedContent"]);e!==void 0&&k!=null&&r(e,["cachedContent"],Ee(i,k));const z=s(t,["responseModalities"]);z!=null&&r(n,["responseModalities"],z);const B=s(t,["mediaResolution"]);B!=null&&r(n,["mediaResolution"],B);const Z=s(t,["speechConfig"]);if(Z!=null&&r(n,["speechConfig"],Fu(i,co(i,Z))),s(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=s(t,["thinkingConfig"]);return L!=null&&r(n,["thinkingConfig"],Uu(i,L)),n}function zi(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);if(o!=null){let l=ce(i,o);Array.isArray(l)&&(l=l.map(u=>Rt(i,u))),r(e,["contents"],l)}const a=s(t,["config"]);return a!=null&&r(e,["generationConfig"],Vu(i,a,e)),e}function bu(i,t,e){const n={},o=s(t,["taskType"]);e!==void 0&&o!=null&&r(e,["requests[]","taskType"],o);const a=s(t,["title"]);e!==void 0&&a!=null&&r(e,["requests[]","title"],a);const l=s(t,["outputDimensionality"]);if(e!==void 0&&l!=null&&r(e,["requests[]","outputDimensionality"],l),s(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function qu(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);o!=null&&r(e,["requests[]","content"],uo(i,o));const a=s(t,["config"]);a!=null&&r(e,["config"],bu(i,a,e));const l=s(t,["model"]);return l!==void 0&&r(e,["requests[]","model"],W(i,l)),e}function Gu(i,t,e){const n={};if(s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=s(t,["numberOfImages"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const a=s(t,["aspectRatio"]);e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a);const l=s(t,["guidanceScale"]);if(e!==void 0&&l!=null&&r(e,["parameters","guidanceScale"],l),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=s(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&r(e,["parameters","safetySetting"],u);const d=s(t,["personGeneration"]);e!==void 0&&d!=null&&r(e,["parameters","personGeneration"],d);const c=s(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&r(e,["parameters","includeSafetyAttributes"],c);const f=s(t,["includeRaiReason"]);e!==void 0&&f!=null&&r(e,["parameters","includeRaiReason"],f);const p=s(t,["language"]);e!==void 0&&p!=null&&r(e,["parameters","language"],p);const m=s(t,["outputMimeType"]);e!==void 0&&m!=null&&r(e,["parameters","outputOptions","mimeType"],m);const h=s(t,["outputCompressionQuality"]);if(e!==void 0&&h!=null&&r(e,["parameters","outputOptions","compressionQuality"],h),s(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Ou(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["prompt"]);o!=null&&r(e,["instances[0]","prompt"],o);const a=s(t,["config"]);return a!=null&&r(e,["config"],Gu(i,a,e)),e}function Bu(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function $u(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);e!==void 0&&a!=null&&r(e,["_query","pageToken"],a);const l=s(t,["filter"]);e!==void 0&&l!=null&&r(e,["_query","filter"],l);const u=s(t,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],ho(i,u)),n}function zu(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],$u(i,n,e)),e}function Ju(i,t,e){const n={},o=s(t,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const a=s(t,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);const l=s(t,["defaultCheckpointId"]);return e!==void 0&&l!=null&&r(e,["defaultCheckpointId"],l),n}function Hu(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],Ju(i,o,e)),e}function Wu(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function Yu(i,t){const e={};if(s(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Zu(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);if(o!=null){let l=ce(i,o);Array.isArray(l)&&(l=l.map(u=>Rt(i,u))),r(e,["contents"],l)}const a=s(t,["config"]);return a!=null&&r(e,["config"],Yu(i,a)),e}function Ku(i,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["imageBytes"]);n!=null&&r(e,["bytesBase64Encoded"],Ie(i,n));const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Qu(i,t,e){const n={},o=s(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o),s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=s(t,["durationSeconds"]);if(e!==void 0&&a!=null&&r(e,["parameters","durationSeconds"],a),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=s(t,["aspectRatio"]);if(e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l),s(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=s(t,["personGeneration"]);if(e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u),s(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=s(t,["negativePrompt"]);if(e!==void 0&&d!=null&&r(e,["parameters","negativePrompt"],d),s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Xu(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["prompt"]);o!=null&&r(e,["instances[0]","prompt"],o);const a=s(t,["image"]);a!=null&&r(e,["instances[0]","image"],Ku(i,a));const l=s(t,["config"]);return l!=null&&r(e,["config"],Qu(i,l,e)),e}function ju(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function ec(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["data"]);o!=null&&r(e,["data"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function tc(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["fileUri"]);o!=null&&r(e,["fileUri"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function nc(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],ju(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],ec(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],tc(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function He(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>nc(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function ic(i,t){const e={},n=s(t,["anyOf"]);n!=null&&r(e,["anyOf"],n);const o=s(t,["default"]);o!=null&&r(e,["default"],o);const a=s(t,["description"]);a!=null&&r(e,["description"],a);const l=s(t,["enum"]);l!=null&&r(e,["enum"],l);const u=s(t,["example"]);u!=null&&r(e,["example"],u);const d=s(t,["format"]);d!=null&&r(e,["format"],d);const c=s(t,["items"]);c!=null&&r(e,["items"],c);const f=s(t,["maxItems"]);f!=null&&r(e,["maxItems"],f);const p=s(t,["maxLength"]);p!=null&&r(e,["maxLength"],p);const m=s(t,["maxProperties"]);m!=null&&r(e,["maxProperties"],m);const h=s(t,["maximum"]);h!=null&&r(e,["maximum"],h);const y=s(t,["minItems"]);y!=null&&r(e,["minItems"],y);const v=s(t,["minLength"]);v!=null&&r(e,["minLength"],v);const C=s(t,["minProperties"]);C!=null&&r(e,["minProperties"],C);const I=s(t,["minimum"]);I!=null&&r(e,["minimum"],I);const S=s(t,["nullable"]);S!=null&&r(e,["nullable"],S);const M=s(t,["pattern"]);M!=null&&r(e,["pattern"],M);const U=s(t,["properties"]);U!=null&&r(e,["properties"],U);const k=s(t,["propertyOrdering"]);k!=null&&r(e,["propertyOrdering"],k);const z=s(t,["required"]);z!=null&&r(e,["required"],z);const B=s(t,["title"]);B!=null&&r(e,["title"],B);const Z=s(t,["type"]);return Z!=null&&r(e,["type"],Z),e}function oc(i,t){const e={},n=s(t,["featureSelectionPreference"]);return n!=null&&r(e,["featureSelectionPreference"],n),e}function sc(i,t){const e={},n=s(t,["method"]);n!=null&&r(e,["method"],n);const o=s(t,["category"]);o!=null&&r(e,["category"],o);const a=s(t,["threshold"]);return a!=null&&r(e,["threshold"],a),e}function rc(i,t){const e={};if(s(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(t,["description"]);n!=null&&r(e,["description"],n);const o=s(t,["name"]);o!=null&&r(e,["name"],o);const a=s(t,["parameters"]);a!=null&&r(e,["parameters"],a);const l=s(t,["response"]);return l!=null&&r(e,["response"],l),e}function ac(i,t){const e={},n=s(t,["startTime"]);n!=null&&r(e,["startTime"],n);const o=s(t,["endTime"]);return o!=null&&r(e,["endTime"],o),e}function lc(i,t){const e={},n=s(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],ac(i,n)),e}function uc(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["dynamicThreshold"]);return o!=null&&r(e,["dynamicThreshold"],o),e}function cc(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],uc(i,n)),e}function dc(){return{}}function fc(i,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function pc(i,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],fc(i,n));const o=s(t,["authType"]);o!=null&&r(e,["authType"],o);const a=s(t,["googleServiceAccountConfig"]);a!=null&&r(e,["googleServiceAccountConfig"],a);const l=s(t,["httpBasicAuthConfig"]);l!=null&&r(e,["httpBasicAuthConfig"],l);const u=s(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const d=s(t,["oidcConfig"]);return d!=null&&r(e,["oidcConfig"],d),e}function mc(i,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],pc(i,n)),e}function Io(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>rc(i,p))),r(e,["functionDeclarations"],f)}const o=s(t,["retrieval"]);o!=null&&r(e,["retrieval"],o);const a=s(t,["googleSearch"]);a!=null&&r(e,["googleSearch"],lc(i,a));const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],cc(i,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],dc());const d=s(t,["googleMaps"]);if(d!=null&&r(e,["googleMaps"],mc(i,d)),s(t,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const c=s(t,["codeExecution"]);return c!=null&&r(e,["codeExecution"],c),e}function hc(i,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const o=s(t,["allowedFunctionNames"]);return o!=null&&r(e,["allowedFunctionNames"],o),e}function gc(i,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const o=s(t,["longitude"]);return o!=null&&r(e,["longitude"],o),e}function yc(i,t){const e={},n=s(t,["latLng"]);n!=null&&r(e,["latLng"],gc(i,n));const o=s(t,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function vc(i,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],hc(i,n));const o=s(t,["retrievalConfig"]);return o!=null&&r(e,["retrievalConfig"],yc(i,o)),e}function Tc(i,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function Cc(i,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Tc(i,n)),e}function _c(i,t){const e={},n=s(t,["voiceConfig"]);if(n!=null&&r(e,["voiceConfig"],Cc(i,n)),s(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=s(t,["languageCode"]);return o!=null&&r(e,["languageCode"],o),e}function xc(i,t){const e={},n=s(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const o=s(t,["thinkingBudget"]);return o!=null&&r(e,["thinkingBudget"],o),e}function Ec(i,t,e){const n={},o=s(t,["systemInstruction"]);e!==void 0&&o!=null&&r(e,["systemInstruction"],He(i,ae(i,o)));const a=s(t,["temperature"]);a!=null&&r(n,["temperature"],a);const l=s(t,["topP"]);l!=null&&r(n,["topP"],l);const u=s(t,["topK"]);u!=null&&r(n,["topK"],u);const d=s(t,["candidateCount"]);d!=null&&r(n,["candidateCount"],d);const c=s(t,["maxOutputTokens"]);c!=null&&r(n,["maxOutputTokens"],c);const f=s(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=s(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const m=s(t,["logprobs"]);m!=null&&r(n,["logprobs"],m);const h=s(t,["presencePenalty"]);h!=null&&r(n,["presencePenalty"],h);const y=s(t,["frequencyPenalty"]);y!=null&&r(n,["frequencyPenalty"],y);const v=s(t,["seed"]);v!=null&&r(n,["seed"],v);const C=s(t,["responseMimeType"]);C!=null&&r(n,["responseMimeType"],C);const I=s(t,["responseSchema"]);I!=null&&r(n,["responseSchema"],ic(i,Mt(i,I)));const S=s(t,["routingConfig"]);S!=null&&r(n,["routingConfig"],S);const M=s(t,["modelSelectionConfig"]);M!=null&&r(n,["modelConfig"],oc(i,M));const U=s(t,["safetySettings"]);if(e!==void 0&&U!=null){let le=U;Array.isArray(le)&&(le=le.map(Ye=>sc(i,Ye))),r(e,["safetySettings"],le)}const k=s(t,["tools"]);if(e!==void 0&&k!=null){let le=Nt(i,k);Array.isArray(le)&&(le=le.map(Ye=>Io(i,wt(i,Ye)))),r(e,["tools"],le)}const z=s(t,["toolConfig"]);e!==void 0&&z!=null&&r(e,["toolConfig"],vc(i,z));const B=s(t,["labels"]);e!==void 0&&B!=null&&r(e,["labels"],B);const Z=s(t,["cachedContent"]);e!==void 0&&Z!=null&&r(e,["cachedContent"],Ee(i,Z));const L=s(t,["responseModalities"]);L!=null&&r(n,["responseModalities"],L);const $=s(t,["mediaResolution"]);$!=null&&r(n,["mediaResolution"],$);const ee=s(t,["speechConfig"]);ee!=null&&r(n,["speechConfig"],_c(i,co(i,ee)));const de=s(t,["audioTimestamp"]);de!=null&&r(n,["audioTimestamp"],de);const We=s(t,["thinkingConfig"]);return We!=null&&r(n,["thinkingConfig"],xc(i,We)),n}function Ji(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);if(o!=null){let l=ce(i,o);Array.isArray(l)&&(l=l.map(u=>He(i,u))),r(e,["contents"],l)}const a=s(t,["config"]);return a!=null&&r(e,["generationConfig"],Ec(i,a,e)),e}function Ic(i,t,e){const n={},o=s(t,["taskType"]);e!==void 0&&o!=null&&r(e,["instances[]","task_type"],o);const a=s(t,["title"]);e!==void 0&&a!=null&&r(e,["instances[]","title"],a);const l=s(t,["outputDimensionality"]);e!==void 0&&l!=null&&r(e,["parameters","outputDimensionality"],l);const u=s(t,["mimeType"]);e!==void 0&&u!=null&&r(e,["instances[]","mimeType"],u);const d=s(t,["autoTruncate"]);return e!==void 0&&d!=null&&r(e,["parameters","autoTruncate"],d),n}function Sc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);o!=null&&r(e,["instances[]","content"],uo(i,o));const a=s(t,["config"]);return a!=null&&r(e,["config"],Ic(i,a,e)),e}function Ac(i,t,e){const n={},o=s(t,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const a=s(t,["negativePrompt"]);e!==void 0&&a!=null&&r(e,["parameters","negativePrompt"],a);const l=s(t,["numberOfImages"]);e!==void 0&&l!=null&&r(e,["parameters","sampleCount"],l);const u=s(t,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const d=s(t,["guidanceScale"]);e!==void 0&&d!=null&&r(e,["parameters","guidanceScale"],d);const c=s(t,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const f=s(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const h=s(t,["includeRaiReason"]);e!==void 0&&h!=null&&r(e,["parameters","includeRaiReason"],h);const y=s(t,["language"]);e!==void 0&&y!=null&&r(e,["parameters","language"],y);const v=s(t,["outputMimeType"]);e!==void 0&&v!=null&&r(e,["parameters","outputOptions","mimeType"],v);const C=s(t,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const I=s(t,["addWatermark"]);e!==void 0&&I!=null&&r(e,["parameters","addWatermark"],I);const S=s(t,["enhancePrompt"]);return e!==void 0&&S!=null&&r(e,["parameters","enhancePrompt"],S),n}function Mc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["prompt"]);o!=null&&r(e,["instances[0]","prompt"],o);const a=s(t,["config"]);return a!=null&&r(e,["config"],Ac(i,a,e)),e}function fn(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const o=s(t,["imageBytes"]);o!=null&&r(e,["bytesBase64Encoded"],Ie(i,o));const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function wc(i,t){const e={},n=s(t,["maskMode"]);n!=null&&r(e,["maskMode"],n);const o=s(t,["segmentationClasses"]);o!=null&&r(e,["maskClasses"],o);const a=s(t,["maskDilation"]);return a!=null&&r(e,["dilation"],a),e}function Nc(i,t){const e={},n=s(t,["controlType"]);n!=null&&r(e,["controlType"],n);const o=s(t,["enableControlImageComputation"]);return o!=null&&r(e,["computeControl"],o),e}function Pc(i,t){const e={},n=s(t,["styleDescription"]);return n!=null&&r(e,["styleDescription"],n),e}function Rc(i,t){const e={},n=s(t,["subjectType"]);n!=null&&r(e,["subjectType"],n);const o=s(t,["subjectDescription"]);return o!=null&&r(e,["subjectDescription"],o),e}function Dc(i,t){const e={},n=s(t,["referenceImage"]);n!=null&&r(e,["referenceImage"],fn(i,n));const o=s(t,["referenceId"]);o!=null&&r(e,["referenceId"],o);const a=s(t,["referenceType"]);a!=null&&r(e,["referenceType"],a);const l=s(t,["maskImageConfig"]);l!=null&&r(e,["maskImageConfig"],wc(i,l));const u=s(t,["controlImageConfig"]);u!=null&&r(e,["controlImageConfig"],Nc(i,u));const d=s(t,["styleImageConfig"]);d!=null&&r(e,["styleImageConfig"],Pc(i,d));const c=s(t,["subjectImageConfig"]);return c!=null&&r(e,["subjectImageConfig"],Rc(i,c)),e}function kc(i,t,e){const n={},o=s(t,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const a=s(t,["negativePrompt"]);e!==void 0&&a!=null&&r(e,["parameters","negativePrompt"],a);const l=s(t,["numberOfImages"]);e!==void 0&&l!=null&&r(e,["parameters","sampleCount"],l);const u=s(t,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const d=s(t,["guidanceScale"]);e!==void 0&&d!=null&&r(e,["parameters","guidanceScale"],d);const c=s(t,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const f=s(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const h=s(t,["includeRaiReason"]);e!==void 0&&h!=null&&r(e,["parameters","includeRaiReason"],h);const y=s(t,["language"]);e!==void 0&&y!=null&&r(e,["parameters","language"],y);const v=s(t,["outputMimeType"]);e!==void 0&&v!=null&&r(e,["parameters","outputOptions","mimeType"],v);const C=s(t,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const I=s(t,["editMode"]);e!==void 0&&I!=null&&r(e,["parameters","editMode"],I);const S=s(t,["baseSteps"]);return e!==void 0&&S!=null&&r(e,["parameters","editConfig","baseSteps"],S),n}function Lc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["prompt"]);o!=null&&r(e,["instances[0]","prompt"],o);const a=s(t,["referenceImages"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>Dc(i,d))),r(e,["instances[0]","referenceImages"],u)}const l=s(t,["config"]);return l!=null&&r(e,["config"],kc(i,l,e)),e}function Fc(i,t,e){const n={},o=s(t,["includeRaiReason"]);e!==void 0&&o!=null&&r(e,["parameters","includeRaiReason"],o);const a=s(t,["outputMimeType"]);e!==void 0&&a!=null&&r(e,["parameters","outputOptions","mimeType"],a);const l=s(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&r(e,["parameters","outputOptions","compressionQuality"],l);const u=s(t,["numberOfImages"]);e!==void 0&&u!=null&&r(e,["parameters","sampleCount"],u);const d=s(t,["mode"]);return e!==void 0&&d!=null&&r(e,["parameters","mode"],d),n}function Uc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["image"]);o!=null&&r(e,["instances[0]","image"],fn(i,o));const a=s(t,["upscaleFactor"]);a!=null&&r(e,["parameters","upscaleConfig","upscaleFactor"],a);const l=s(t,["config"]);return l!=null&&r(e,["config"],Fc(i,l,e)),e}function Vc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function bc(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);e!==void 0&&a!=null&&r(e,["_query","pageToken"],a);const l=s(t,["filter"]);e!==void 0&&l!=null&&r(e,["_query","filter"],l);const u=s(t,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],ho(i,u)),n}function qc(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],bc(i,n,e)),e}function Gc(i,t,e){const n={},o=s(t,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const a=s(t,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);const l=s(t,["defaultCheckpointId"]);return e!==void 0&&l!=null&&r(e,["defaultCheckpointId"],l),n}function Oc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],Gc(i,o,e)),e}function Bc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],W(i,n));const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function $c(i,t,e){const n={},o=s(t,["systemInstruction"]);e!==void 0&&o!=null&&r(e,["systemInstruction"],He(i,ae(i,o)));const a=s(t,["tools"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>Io(i,d))),r(e,["tools"],u)}const l=s(t,["generationConfig"]);return e!==void 0&&l!=null&&r(e,["generationConfig"],l),n}function zc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);if(o!=null){let l=ce(i,o);Array.isArray(l)&&(l=l.map(u=>He(i,u))),r(e,["contents"],l)}const a=s(t,["config"]);return a!=null&&r(e,["config"],$c(i,a,e)),e}function Jc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["contents"]);if(o!=null){let l=ce(i,o);Array.isArray(l)&&(l=l.map(u=>He(i,u))),r(e,["contents"],l)}const a=s(t,["config"]);return a!=null&&r(e,["config"],a),e}function Hc(i,t,e){const n={},o=s(t,["numberOfVideos"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const a=s(t,["outputGcsUri"]);e!==void 0&&a!=null&&r(e,["parameters","storageUri"],a);const l=s(t,["fps"]);e!==void 0&&l!=null&&r(e,["parameters","fps"],l);const u=s(t,["durationSeconds"]);e!==void 0&&u!=null&&r(e,["parameters","durationSeconds"],u);const d=s(t,["seed"]);e!==void 0&&d!=null&&r(e,["parameters","seed"],d);const c=s(t,["aspectRatio"]);e!==void 0&&c!=null&&r(e,["parameters","aspectRatio"],c);const f=s(t,["resolution"]);e!==void 0&&f!=null&&r(e,["parameters","resolution"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["pubsubTopic"]);e!==void 0&&m!=null&&r(e,["parameters","pubsubTopic"],m);const h=s(t,["negativePrompt"]);e!==void 0&&h!=null&&r(e,["parameters","negativePrompt"],h);const y=s(t,["enhancePrompt"]);return e!==void 0&&y!=null&&r(e,["parameters","enhancePrompt"],y),n}function Wc(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],W(i,n));const o=s(t,["prompt"]);o!=null&&r(e,["instances[0]","prompt"],o);const a=s(t,["image"]);a!=null&&r(e,["instances[0]","image"],fn(i,a));const l=s(t,["config"]);return l!=null&&r(e,["config"],Hc(i,l,e)),e}function Yc(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function Zc(i,t){const e={},n=s(t,["data"]);n!=null&&r(e,["data"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Kc(i,t){const e={},n=s(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Qc(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],Yc(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],Zc(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],Kc(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Xc(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Qc(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function jc(i,t){const e={},n=s(t,["citationSources"]);return n!=null&&r(e,["citations"],n),e}function ed(i,t){const e={},n=s(t,["retrievedUrl"]);n!=null&&r(e,["retrievedUrl"],n);const o=s(t,["urlRetrievalStatus"]);return o!=null&&r(e,["urlRetrievalStatus"],o),e}function td(i,t){const e={},n=s(t,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>ed(i,a))),r(e,["urlMetadata"],o)}return e}function nd(i,t){const e={},n=s(t,["content"]);n!=null&&r(e,["content"],Xc(i,n));const o=s(t,["citationMetadata"]);o!=null&&r(e,["citationMetadata"],jc(i,o));const a=s(t,["tokenCount"]);a!=null&&r(e,["tokenCount"],a);const l=s(t,["finishReason"]);l!=null&&r(e,["finishReason"],l);const u=s(t,["urlContextMetadata"]);u!=null&&r(e,["urlContextMetadata"],td(i,u));const d=s(t,["avgLogprobs"]);d!=null&&r(e,["avgLogprobs"],d);const c=s(t,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const f=s(t,["index"]);f!=null&&r(e,["index"],f);const p=s(t,["logprobsResult"]);p!=null&&r(e,["logprobsResult"],p);const m=s(t,["safetyRatings"]);return m!=null&&r(e,["safetyRatings"],m),e}function Hi(i,t){const e={},n=s(t,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(d=>nd(i,d))),r(e,["candidates"],u)}const o=s(t,["modelVersion"]);o!=null&&r(e,["modelVersion"],o);const a=s(t,["promptFeedback"]);a!=null&&r(e,["promptFeedback"],a);const l=s(t,["usageMetadata"]);return l!=null&&r(e,["usageMetadata"],l),e}function id(i,t){const e={},n=s(t,["values"]);return n!=null&&r(e,["values"],n),e}function od(){return{}}function sd(i,t){const e={},n=s(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>id(i,l))),r(e,["embeddings"],a)}return s(t,["metadata"])!=null&&r(e,["metadata"],od()),e}function rd(i,t){const e={},n=s(t,["bytesBase64Encoded"]);n!=null&&r(e,["imageBytes"],Ie(i,n));const o=s(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function So(i,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const o=s(t,["safetyAttributes","scores"]);o!=null&&r(e,["scores"],o);const a=s(t,["contentType"]);return a!=null&&r(e,["contentType"],a),e}function ad(i,t){const e={},n=s(t,["_self"]);n!=null&&r(e,["image"],rd(i,n));const o=s(t,["raiFilteredReason"]);o!=null&&r(e,["raiFilteredReason"],o);const a=s(t,["_self"]);return a!=null&&r(e,["safetyAttributes"],So(i,a)),e}function ld(i,t){const e={},n=s(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>ad(i,l))),r(e,["generatedImages"],a)}const o=s(t,["positivePromptSafetyAttributes"]);return o!=null&&r(e,["positivePromptSafetyAttributes"],So(i,o)),e}function ud(i,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const o=s(t,["createTime"]);o!=null&&r(e,["createTime"],o);const a=s(t,["updateTime"]);return a!=null&&r(e,["updateTime"],a),e}function sn(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["displayName"]);o!=null&&r(e,["displayName"],o);const a=s(t,["description"]);a!=null&&r(e,["description"],a);const l=s(t,["version"]);l!=null&&r(e,["version"],l);const u=s(t,["_self"]);u!=null&&r(e,["tunedModelInfo"],ud(i,u));const d=s(t,["inputTokenLimit"]);d!=null&&r(e,["inputTokenLimit"],d);const c=s(t,["outputTokenLimit"]);c!=null&&r(e,["outputTokenLimit"],c);const f=s(t,["supportedGenerationMethods"]);return f!=null&&r(e,["supportedActions"],f),e}function cd(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["_self"]);if(o!=null){let a=go(i,o);Array.isArray(a)&&(a=a.map(l=>sn(i,l))),r(e,["models"],a)}return e}function dd(){return{}}function fd(i,t){const e={},n=s(t,["totalTokens"]);n!=null&&r(e,["totalTokens"],n);const o=s(t,["cachedContentTokenCount"]);return o!=null&&r(e,["cachedContentTokenCount"],o),e}function pd(i,t){const e={},n=s(t,["video","uri"]);n!=null&&r(e,["uri"],n);const o=s(t,["video","encodedVideo"]);o!=null&&r(e,["videoBytes"],Ie(i,o));const a=s(t,["encoding"]);return a!=null&&r(e,["mimeType"],a),e}function md(i,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],pd(i,n)),e}function hd(i,t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>md(i,u))),r(e,["generatedVideos"],l)}const o=s(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const a=s(t,["raiMediaFilteredReasons"]);return a!=null&&r(e,["raiMediaFilteredReasons"],a),e}function gd(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["metadata"]);o!=null&&r(e,["metadata"],o);const a=s(t,["done"]);a!=null&&r(e,["done"],a);const l=s(t,["error"]);l!=null&&r(e,["error"],l);const u=s(t,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],hd(i,u)),e}function yd(i,t){const e={},n=s(t,["fps"]);n!=null&&r(e,["fps"],n);const o=s(t,["endOffset"]);o!=null&&r(e,["endOffset"],o);const a=s(t,["startOffset"]);return a!=null&&r(e,["startOffset"],a),e}function vd(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["data"]);o!=null&&r(e,["data"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Td(i,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const o=s(t,["fileUri"]);o!=null&&r(e,["fileUri"],o);const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Cd(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],yd(i,n));const o=s(t,["thought"]);o!=null&&r(e,["thought"],o);const a=s(t,["inlineData"]);a!=null&&r(e,["inlineData"],vd(i,a));const l=s(t,["fileData"]);l!=null&&r(e,["fileData"],Td(i,l));const u=s(t,["codeExecutionResult"]);u!=null&&r(e,["codeExecutionResult"],u);const d=s(t,["executableCode"]);d!=null&&r(e,["executableCode"],d);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function _d(i,t){const e={},n=s(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Cd(i,l))),r(e,["parts"],a)}const o=s(t,["role"]);return o!=null&&r(e,["role"],o),e}function xd(i,t){const e={},n=s(t,["citations"]);return n!=null&&r(e,["citations"],n),e}function Ed(i,t){const e={},n=s(t,["content"]);n!=null&&r(e,["content"],_d(i,n));const o=s(t,["citationMetadata"]);o!=null&&r(e,["citationMetadata"],xd(i,o));const a=s(t,["finishMessage"]);a!=null&&r(e,["finishMessage"],a);const l=s(t,["finishReason"]);l!=null&&r(e,["finishReason"],l);const u=s(t,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const d=s(t,["groundingMetadata"]);d!=null&&r(e,["groundingMetadata"],d);const c=s(t,["index"]);c!=null&&r(e,["index"],c);const f=s(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=s(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function Wi(i,t){const e={},n=s(t,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>Ed(i,f))),r(e,["candidates"],c)}const o=s(t,["createTime"]);o!=null&&r(e,["createTime"],o);const a=s(t,["responseId"]);a!=null&&r(e,["responseId"],a);const l=s(t,["modelVersion"]);l!=null&&r(e,["modelVersion"],l);const u=s(t,["promptFeedback"]);u!=null&&r(e,["promptFeedback"],u);const d=s(t,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function Id(i,t){const e={},n=s(t,["truncated"]);n!=null&&r(e,["truncated"],n);const o=s(t,["token_count"]);return o!=null&&r(e,["tokenCount"],o),e}function Sd(i,t){const e={},n=s(t,["values"]);n!=null&&r(e,["values"],n);const o=s(t,["statistics"]);return o!=null&&r(e,["statistics"],Id(i,o)),e}function Ad(i,t){const e={},n=s(t,["billableCharacterCount"]);return n!=null&&r(e,["billableCharacterCount"],n),e}function Md(i,t){const e={},n=s(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Sd(i,l))),r(e,["embeddings"],a)}const o=s(t,["metadata"]);return o!=null&&r(e,["metadata"],Ad(i,o)),e}function wd(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const o=s(t,["bytesBase64Encoded"]);o!=null&&r(e,["imageBytes"],Ie(i,o));const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Ao(i,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const o=s(t,["safetyAttributes","scores"]);o!=null&&r(e,["scores"],o);const a=s(t,["contentType"]);return a!=null&&r(e,["contentType"],a),e}function pn(i,t){const e={},n=s(t,["_self"]);n!=null&&r(e,["image"],wd(i,n));const o=s(t,["raiFilteredReason"]);o!=null&&r(e,["raiFilteredReason"],o);const a=s(t,["_self"]);a!=null&&r(e,["safetyAttributes"],Ao(i,a));const l=s(t,["prompt"]);return l!=null&&r(e,["enhancedPrompt"],l),e}function Nd(i,t){const e={},n=s(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>pn(i,l))),r(e,["generatedImages"],a)}const o=s(t,["positivePromptSafetyAttributes"]);return o!=null&&r(e,["positivePromptSafetyAttributes"],Ao(i,o)),e}function Pd(i,t){const e={},n=s(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>pn(i,a))),r(e,["generatedImages"],o)}return e}function Rd(i,t){const e={},n=s(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>pn(i,a))),r(e,["generatedImages"],o)}return e}function Dd(i,t){const e={},n=s(t,["endpoint"]);n!=null&&r(e,["name"],n);const o=s(t,["deployedModelId"]);return o!=null&&r(e,["deployedModelId"],o),e}function kd(i,t){const e={},n=s(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&r(e,["baseModel"],n);const o=s(t,["createTime"]);o!=null&&r(e,["createTime"],o);const a=s(t,["updateTime"]);return a!=null&&r(e,["updateTime"],a),e}function Ld(i,t){const e={},n=s(t,["checkpointId"]);n!=null&&r(e,["checkpointId"],n);const o=s(t,["epoch"]);o!=null&&r(e,["epoch"],o);const a=s(t,["step"]);return a!=null&&r(e,["step"],a),e}function rn(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["displayName"]);o!=null&&r(e,["displayName"],o);const a=s(t,["description"]);a!=null&&r(e,["description"],a);const l=s(t,["versionId"]);l!=null&&r(e,["version"],l);const u=s(t,["deployedModels"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(h=>Dd(i,h))),r(e,["endpoints"],m)}const d=s(t,["labels"]);d!=null&&r(e,["labels"],d);const c=s(t,["_self"]);c!=null&&r(e,["tunedModelInfo"],kd(i,c));const f=s(t,["defaultCheckpointId"]);f!=null&&r(e,["defaultCheckpointId"],f);const p=s(t,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>Ld(i,h))),r(e,["checkpoints"],m)}return e}function Fd(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["_self"]);if(o!=null){let a=go(i,o);Array.isArray(a)&&(a=a.map(l=>rn(i,l))),r(e,["models"],a)}return e}function Ud(){return{}}function Vd(i,t){const e={},n=s(t,["totalTokens"]);return n!=null&&r(e,["totalTokens"],n),e}function bd(i,t){const e={},n=s(t,["tokensInfo"]);return n!=null&&r(e,["tokensInfo"],n),e}function qd(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const o=s(t,["bytesBase64Encoded"]);o!=null&&r(e,["videoBytes"],Ie(i,o));const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function Gd(i,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],qd(i,n)),e}function Od(i,t){const e={},n=s(t,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Gd(i,u))),r(e,["generatedVideos"],l)}const o=s(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const a=s(t,["raiMediaFilteredReasons"]);return a!=null&&r(e,["raiMediaFilteredReasons"],a),e}function Bd(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["metadata"]);o!=null&&r(e,["metadata"],o);const a=s(t,["done"]);a!=null&&r(e,["done"],a);const l=s(t,["error"]);l!=null&&r(e,["error"],l);const u=s(t,["response"]);return u!=null&&r(e,["response"],Od(i,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $d="Content-Type",zd="X-Server-Timeout",Jd="User-Agent",an="x-goog-api-client",Hd="1.1.0",Wd=`google-genai-sdk/${Hd}`,Yd="v1beta1",Zd="v1beta",Yi=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Mo extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class ln extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class Kd{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:Yd,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Zd,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const o=[this.getRequestUrlInternal(e)];return n&&o.push(this.getBaseResourcePath()),t!==""&&o.push(t),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[l,u]of Object.entries(t.queryParams))o.searchParams.append(l,String(u));let a={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=t.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,e,t.abortSignal),this.unaryApiCall(o,a,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[o,a]of Object.entries(e))typeof a=="object"?n[o]=Object.assign(Object.assign({},n[o]),a):a!==void 0&&(n[o]=a);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,e,n);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let a={};return a.body=t.body,a=await this.includeExtraHttpOptionsToRequestInit(a,e,t.abortSignal),this.streamApiCall(o,a,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e,n){if(e&&e.timeout||n){const o=new AbortController,a=o.signal;e.timeout&&(e==null?void 0:e.timeout)>0&&setTimeout(()=>o.abort(),e.timeout),n&&n.addEventListener("abort",()=>{o.abort()}),t.signal=a}return t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async o=>(await Zi(o),new en(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async o=>(await Zi(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(t){var e;return ot(this,arguments,function*(){const o=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),a=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let l="";for(;;){const{done:u,value:d}=yield Y(o.read());if(u){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=a.decode(d);try{const p=JSON.parse(c);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),h=m.status,y=m.code,v=`got status: ${h}. ${JSON.stringify(p)}`;if(y>=400&&y<500)throw new Mo(v);if(y>=500&&y<600)throw new ln(v)}}catch(p){const m=p;if(m.name==="ClientError"||m.name==="ServerError")throw p}l+=c;let f=l.match(Yi);for(;f;){const p=f[1];try{const m=new Response(p,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Y(new en(m)),l=l.slice(f[0].length),f=l.match(Yi)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{o.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=Wd+" "+this.clientOptions.userAgentExtra;return t[Jd]=e,t[an]=e,t[$d]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,o]of Object.entries(t.headers))e.append(n,o);t.timeout&&t.timeout>0&&e.append(zd,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const o={};e!=null&&(o.mimeType=e.mimeType,o.name=e.name,o.displayName=e.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const a=this.clientOptions.uploader,l=await a.stat(t);o.sizeBytes=String(l.size);const u=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=u;const d=await this.fetchUploadUrl(o,e);return a.upload(t,d,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,e){var n;let o={};e!=null&&e.httpOptions?o=e.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const a={file:t},l=await this.request({path:A("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:o});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=l==null?void 0:l.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function Zi(i){var t;if(i===void 0)throw new ln("response is undefined");if(!i.ok){const e=i.status,n=i.statusText;let o;!((t=i.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?o=await i.json():o={error:{message:await i.text(),code:i.status,status:i.statusText}};const a=`got status: ${e} ${n}. ${JSON.stringify(o)}`;throw e>=400&&e<500?new Mo(a):e>=500&&e<600?new ln(a):new Error(a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ki="mcp_used/unknown";function wo(i){for(const t of i)if(mn(t)||typeof t=="object"&&"inputSchema"in t)return!0;return!1}function No(i){var t;const e=(t=i[an])!==null&&t!==void 0?t:"";e.includes(Ki)||(i[an]=(e+` ${Ki}`).trimStart())}function Qd(i){var t,e,n;return(n=(e=(t=i.config)===null||t===void 0?void 0:t.tools)===null||e===void 0?void 0:e.some(o=>mn(o)))!==null&&n!==void 0?n:!1}function Xd(i){var t,e,n;return(n=(e=(t=i.config)===null||t===void 0?void 0:t.tools)===null||e===void 0?void 0:e.some(o=>!mn(o)))!==null&&n!==void 0?n:!1}function mn(i){return i!==null&&typeof i=="object"&&"tool"in i&&"callTool"in i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function jd(i,t,e){const n=new js;let o;e.data instanceof Blob?o=JSON.parse(await e.data.text()):o=JSON.parse(e.data);const a=mu(i,o);Object.assign(n,a),t(n)}class ef{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=of(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${o}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const f=new Promise(M=>{c=M}),p=t.callbacks,m=function(){c({})},h=this.apiClient,y={onopen:m,onmessage:M=>{jd(h,p.onmessage,M)},onerror:(e=p==null?void 0:p.onerror)!==null&&e!==void 0?e:function(M){},onclose:(n=p==null?void 0:p.onclose)!==null&&n!==void 0?n:function(M){}},v=this.webSocketFactory.create(d,nf(l),y);v.connect(),await f;const C=W(this.apiClient,t.model),I=_o(this.apiClient,{model:C}),S=on(this.apiClient,{setup:I});return v.send(JSON.stringify(S)),new tf(v,this.apiClient)}}class tf{constructor(t,e){this.conn=t,this.apiClient=e}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const e=wl(this.apiClient,t),n=xo(this.apiClient,e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const e=Nl(this.apiClient,t),n=on(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const e=on(this.apiClient,{playbackControl:t});this.conn.send(JSON.stringify(e))}play(){this.sendPlaybackControl(qe.PLAY)}pause(){this.sendPlaybackControl(qe.PAUSE)}stop(){this.sendPlaybackControl(qe.STOP)}resetContext(){this.sendPlaybackControl(qe.RESET_CONTEXT)}close(){this.conn.close()}}function nf(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function of(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sf="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function rf(i,t,e){const n=new Xs;let o;if(e.data instanceof Blob?o=JSON.parse(await e.data.text()):o=JSON.parse(e.data),i.isVertexAI()){const a=su(i,o);Object.assign(n,a)}else{const a=ou(i,o);Object.assign(n,a)}t(n)}class af{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n,this.music=new ef(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var e,n,o,a,l,u;const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const p=this.apiClient.getDefaultHeaders();t.config&&t.config.tools&&wo(t.config.tools)&&No(p);const m=df(p);if(this.apiClient.isVertexAI())f=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const L=this.apiClient.getApiKey();f=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateContent?key=${L}`}let h=()=>{};const y=new Promise(L=>{h=L}),v=t.callbacks,C=function(){var L;(L=v==null?void 0:v.onopen)===null||L===void 0||L.call(v),h({})},I=this.apiClient,S={onopen:C,onmessage:L=>{rf(I,v.onmessage,L)},onerror:(e=v==null?void 0:v.onerror)!==null&&e!==void 0?e:function(L){},onclose:(n=v==null?void 0:v.onclose)!==null&&n!==void 0?n:function(L){}},M=this.webSocketFactory.create(f,cf(m),S);M.connect(),await y;let U=W(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const L=this.apiClient.getProject(),$=this.apiClient.getLocation();U=`projects/${L}/locations/${$}/`+U}let k={};this.apiClient.isVertexAI()&&((o=t.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[St.AUDIO]}:t.config.responseModalities=[St.AUDIO]),!((a=t.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],B=[];for(const L of z)if(this.isCallableTool(L)){const $=L;B.push(await $.tool())}else B.push(L);B.length>0&&(t.config.tools=B);const Z={model:U,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?k=_l(this.apiClient,Z):k=Cl(this.apiClient,Z),delete k.config,M.send(JSON.stringify(k)),new uf(M,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const lf={turnComplete:!0};class uf{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=ce(t,e.turns),t.isVertexAI()?n=n.map(o=>He(t,o)):n=n.map(o=>Rt(t,o))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const a of n){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!t.isVertexAI()&&!("id"in a))throw new Error(sf)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},lf),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){let e={};this.apiClient.isVertexAI()?e={realtimeInput:Ml(this.apiClient,t)}:e={realtimeInput:Al(this.apiClient,t)},this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function cf(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function df(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qi=10;function Xi(i){var t,e,n;if(!((t=i==null?void 0:i.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let o=!1;for(const l of(e=i==null?void 0:i.tools)!==null&&e!==void 0?e:[])if(yt(l)){o=!0;break}if(!o)return!0;const a=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function yt(i){return"callTool"in i&&typeof i.callTool=="function"}function ji(i){var t;return!(!((t=i==null?void 0:i.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ff extends rt{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>{var n,o,a,l,u;const d=await this.processParamsForMcpUsage(e);if(!Qd(e)||Xi(e.config))return await this.generateContentInternal(d);if(Xd(e))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let c,f;const p=ce(this.apiClient,d.contents),m=(a=(o=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&a!==void 0?a:Qi;let h=0;for(;h<m&&(c=await this.generateContentInternal(d),!(!c.functionCalls||c.functionCalls.length===0));){const y=c.candidates[0].content,v=[];for(const C of(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(yt(C)){const S=await C.callTool(c.functionCalls);v.push(...S)}h++,f={role:"user",parts:v},d.contents=ce(this.apiClient,d.contents),d.contents.push(y),d.contents.push(f),ji(d.config)&&(p.push(y),p.push(f))}return ji(d.config)&&(c.automaticFunctionCallingHistory=p),c},this.generateContentStream=async e=>{if(Xi(e.config)){const n=await this.processParamsForMcpUsage(e);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var o;let a;const l=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((o=d==null?void 0:d.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?a=d==null?void 0:d.safetyAttributes:l.push(d);let u;return a?u={generatedImages:l,positivePromptSafetyAttributes:a}:u={generatedImages:l},u}),this.list=async e=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Pt(Je.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async e=>{const n={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(n.referenceImages=e.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async e=>{let n={numberOfImages:1,mode:"upscale"};e.config&&(n=Object.assign(Object.assign({},n),e.config));const o={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:n};return await this.upscaleImageInternal(o)}}async processParamsForMcpUsage(t){var e,n,o;const a=(e=t.config)===null||e===void 0?void 0:e.tools;if(!a)return t;const l=await Promise.all(a.map(async d=>yt(d)?await d.tool():d)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:l})};if(u.config.tools=l,t.config&&t.config.tools&&wo(t.config.tools)){const d=(o=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&o!==void 0?o:{};let c=Object.assign({},d);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),No(c),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:c})}return u}async initAfcToolsMap(t){var e,n,o;const a=new Map;for(const l of(n=(e=t.config)===null||e===void 0?void 0:e.tools)!==null&&n!==void 0?n:[])if(yt(l)){const u=l,d=await u.tool();for(const c of(o=d.functionDeclarations)!==null&&o!==void 0?o:[]){if(!c.name)throw new Error("Function declaration name is required.");if(a.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);a.set(c.name,u)}}return a}async processAfcStream(t){var e,n,o;const a=(o=(n=(e=t.config)===null||e===void 0?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&o!==void 0?o:Qi;let l=!1,u=0;const d=await this.initAfcToolsMap(t);return function(c,f,p){var m,h;return ot(this,arguments,function*(){for(var y,v,C,I;u<a;){l&&(u++,l=!1);const k=yield Y(c.processParamsForMcpUsage(p)),z=yield Y(c.generateContentStreamInternal(k)),B=[],Z=[];try{for(var S=!0,M=(v=void 0,gt(z)),U;U=yield Y(M.next()),y=U.done,!y;S=!0){I=U.value,S=!1;const L=I;if(yield yield Y(L),L.candidates&&(!((m=L.candidates[0])===null||m===void 0)&&m.content)){Z.push(L.candidates[0].content);for(const $ of(h=L.candidates[0].content.parts)!==null&&h!==void 0?h:[])if(u<a&&$.functionCall){if(!$.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has($.functionCall.name)){const ee=yield Y(f.get($.functionCall.name).callTool([$.functionCall]));B.push(...ee)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${$.functionCall.name}`)}}}}catch(L){v={error:L}}finally{try{!S&&!y&&(C=M.return)&&(yield Y(C.call(M)))}finally{if(v)throw v.error}}if(B.length>0){l=!0;const L=new Qe;L.candidates=[{content:{role:"user",parts:B}}],yield yield Y(L);const $=[];$.push(...Z),$.push({role:"user",parts:B});const ee=ce(c.apiClient,p.contents).concat($);p.contents=ee}else break}})}(this,d,t)}async generateContentInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ji(this.apiClient,t);return u=A("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Wi(this.apiClient,f),m=new Qe;return Object.assign(m,p),m})}else{const c=zi(this.apiClient,t);return u=A("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Hi(this.apiClient,f),m=new Qe;return Object.assign(m,p),m})}}async generateContentStreamInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ji(this.apiClient,t);u=A("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;const f=this.apiClient;return l=f.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(p){return ot(this,arguments,function*(){var m,h,y,v;try{for(var C=!0,I=gt(p),S;S=yield Y(I.next()),m=S.done,!m;C=!0){v=S.value,C=!1;const U=Wi(f,yield Y(v.json())),k=new Qe;Object.assign(k,U),yield yield Y(k)}}catch(M){h={error:M}}finally{try{!C&&!m&&(y=I.return)&&(yield Y(y.call(I)))}finally{if(h)throw h.error}}})})}else{const c=zi(this.apiClient,t);u=A("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;const f=this.apiClient;return l=f.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(p){return ot(this,arguments,function*(){var m,h,y,v;try{for(var C=!0,I=gt(p),S;S=yield Y(I.next()),m=S.done,!m;C=!0){v=S.value,C=!1;const U=Hi(f,yield Y(v.json())),k=new Qe;Object.assign(k,U),yield yield Y(k)}}catch(M){h={error:M}}finally{try{!C&&!m&&(y=I.return)&&(yield Y(y.call(I)))}finally{if(h)throw h.error}}})})}}async embedContent(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Sc(this.apiClient,t);return u=A("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Md(this.apiClient,f),m=new Ii;return Object.assign(m,p),m})}else{const c=qu(this.apiClient,t);return u=A("{model}:batchEmbedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=sd(this.apiClient,f),m=new Ii;return Object.assign(m,p),m})}}async generateImagesInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Mc(this.apiClient,t);return u=A("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Nd(this.apiClient,f),m=new Si;return Object.assign(m,p),m})}else{const c=Ou(this.apiClient,t);return u=A("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=ld(this.apiClient,f),m=new Si;return Object.assign(m,p),m})}}async editImageInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Lc(this.apiClient,t);return a=A("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const c=Pd(this.apiClient,d),f=new Hs;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Uc(this.apiClient,t);return a=A("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const c=Rd(this.apiClient,d),f=new Ws;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Vc(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>rn(this.apiClient,f))}else{const c=Bu(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>sn(this.apiClient,f))}}async listInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=qc(this.apiClient,t);return u=A("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Fd(this.apiClient,f),m=new Ai;return Object.assign(m,p),m})}else{const c=zu(this.apiClient,t);return u=A("{models_url}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=cd(this.apiClient,f),m=new Ai;return Object.assign(m,p),m})}}async update(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Oc(this.apiClient,t);return u=A("{model}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>rn(this.apiClient,f))}else{const c=Hu(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>sn(this.apiClient,f))}}async delete(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Bc(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(()=>{const f=Ud(),p=new Mi;return Object.assign(p,f),p})}else{const c=Wu(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(()=>{const f=dd(),p=new Mi;return Object.assign(p,f),p})}}async countTokens(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=zc(this.apiClient,t);return u=A("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=Vd(this.apiClient,f),m=new wi;return Object.assign(m,p),m})}else{const c=Zu(this.apiClient,t);return u=A("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=fd(this.apiClient,f),m=new wi;return Object.assign(m,p),m})}}async computeTokens(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Jc(this.apiClient,t);return a=A("{model}:computeTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const c=bd(this.apiClient,d),f=new Ys;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Wc(this.apiClient,t);return u=A("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>Bd(this.apiClient,f))}else{const c=Xu(this.apiClient,t);return u=A("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>gd(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pf(i,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function mf(i,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function hf(i,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["operationName"],n);const o=s(t,["resourceName"]);o!=null&&r(e,["_url","resourceName"],o);const a=s(t,["config"]);return a!=null&&r(e,["config"],a),e}function gf(i,t){const e={},n=s(t,["video","uri"]);n!=null&&r(e,["uri"],n);const o=s(t,["video","encodedVideo"]);o!=null&&r(e,["videoBytes"],Ie(i,o));const a=s(t,["encoding"]);return a!=null&&r(e,["mimeType"],a),e}function yf(i,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],gf(i,n)),e}function vf(i,t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>yf(i,u))),r(e,["generatedVideos"],l)}const o=s(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const a=s(t,["raiMediaFilteredReasons"]);return a!=null&&r(e,["raiMediaFilteredReasons"],a),e}function Tf(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["metadata"]);o!=null&&r(e,["metadata"],o);const a=s(t,["done"]);a!=null&&r(e,["done"],a);const l=s(t,["error"]);l!=null&&r(e,["error"],l);const u=s(t,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],vf(i,u)),e}function Cf(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const o=s(t,["bytesBase64Encoded"]);o!=null&&r(e,["videoBytes"],Ie(i,o));const a=s(t,["mimeType"]);return a!=null&&r(e,["mimeType"],a),e}function _f(i,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],Cf(i,n)),e}function xf(i,t){const e={},n=s(t,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>_f(i,u))),r(e,["generatedVideos"],l)}const o=s(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const a=s(t,["raiMediaFilteredReasons"]);return a!=null&&r(e,["raiMediaFilteredReasons"],a),e}function eo(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["metadata"]);o!=null&&r(e,["metadata"],o);const a=s(t,["done"]);a!=null&&r(e,["done"],a);const l=s(t,["error"]);l!=null&&r(e,["error"],l);const u=s(t,["response"]);return u!=null&&r(e,["response"],xf(i,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ef extends rt{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=e.name.split("/operations/")[0];let a;return n&&"httpOptions"in n&&(a=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:o,config:{httpOptions:a}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=mf(this.apiClient,t);return u=A("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>eo(this.apiClient,f))}else{const c=pf(this.apiClient,t);return u=A("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>Tf(this.apiClient,f))}}async fetchPredictVideosOperationInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=hf(this.apiClient,t);return a=A("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>eo(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function If(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],n);const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function Sf(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);e!==void 0&&a!=null&&r(e,["_query","pageToken"],a);const l=s(t,["filter"]);return e!==void 0&&l!=null&&r(e,["_query","filter"],l),n}function Af(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Sf(i,n,e)),e}function Mf(i,t){const e={},n=s(t,["textInput"]);n!=null&&r(e,["textInput"],n);const o=s(t,["output"]);return o!=null&&r(e,["output"],o),e}function wf(i,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["examples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>Mf(i,a))),r(e,["examples","examples"],o)}return e}function Nf(i,t,e){const n={};if(s(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=s(t,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&r(e,["displayName"],o),s(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=s(t,["epochCount"]);e!==void 0&&a!=null&&r(e,["tuningTask","hyperparameters","epochCount"],a);const l=s(t,["learningRateMultiplier"]);if(l!=null&&r(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),s(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(s(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=s(t,["batchSize"]);e!==void 0&&u!=null&&r(e,["tuningTask","hyperparameters","batchSize"],u);const d=s(t,["learningRate"]);return e!==void 0&&d!=null&&r(e,["tuningTask","hyperparameters","learningRate"],d),n}function Pf(i,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const o=s(t,["trainingDataset"]);o!=null&&r(e,["tuningTask","trainingData"],wf(i,o));const a=s(t,["config"]);return a!=null&&r(e,["config"],Nf(i,a,e)),e}function Rf(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],n);const o=s(t,["config"]);return o!=null&&r(e,["config"],o),e}function Df(i,t,e){const n={},o=s(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const a=s(t,["pageToken"]);e!==void 0&&a!=null&&r(e,["_query","pageToken"],a);const l=s(t,["filter"]);return e!==void 0&&l!=null&&r(e,["_query","filter"],l),n}function kf(i,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Df(i,n,e)),e}function Lf(i,t,e){const n={},o=s(t,["gcsUri"]);if(e!==void 0&&o!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],o),s(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Ff(i,t){const e={},n=s(t,["gcsUri"]);return n!=null&&r(e,["validationDatasetUri"],n),e}function Uf(i,t,e){const n={},o=s(t,["validationDataset"]);e!==void 0&&o!=null&&r(e,["supervisedTuningSpec"],Ff(i,o));const a=s(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&r(e,["tunedModelDisplayName"],a);const l=s(t,["description"]);e!==void 0&&l!=null&&r(e,["description"],l);const u=s(t,["epochCount"]);e!==void 0&&u!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const d=s(t,["learningRateMultiplier"]);e!==void 0&&d!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const c=s(t,["exportLastCheckpointOnly"]);e!==void 0&&c!=null&&r(e,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const f=s(t,["adapterSize"]);if(e!==void 0&&f!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),s(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(s(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Vf(i,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const o=s(t,["trainingDataset"]);o!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],Lf(i,o,e));const a=s(t,["config"]);return a!=null&&r(e,["config"],Uf(i,a,e)),e}function bf(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["model"],n);const o=s(t,["name"]);return o!=null&&r(e,["endpoint"],o),e}function Po(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["state"]);o!=null&&r(e,["state"],po(i,o));const a=s(t,["createTime"]);a!=null&&r(e,["createTime"],a);const l=s(t,["tuningTask","startTime"]);l!=null&&r(e,["startTime"],l);const u=s(t,["tuningTask","completeTime"]);u!=null&&r(e,["endTime"],u);const d=s(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const c=s(t,["description"]);c!=null&&r(e,["description"],c);const f=s(t,["baseModel"]);f!=null&&r(e,["baseModel"],f);const p=s(t,["_self"]);p!=null&&r(e,["tunedModel"],bf(i,p));const m=s(t,["distillationSpec"]);m!=null&&r(e,["distillationSpec"],m);const h=s(t,["experiment"]);h!=null&&r(e,["experiment"],h);const y=s(t,["labels"]);y!=null&&r(e,["labels"],y);const v=s(t,["pipelineJob"]);v!=null&&r(e,["pipelineJob"],v);const C=s(t,["serviceAccount"]);C!=null&&r(e,["serviceAccount"],C);const I=s(t,["tunedModelDisplayName"]);return I!=null&&r(e,["tunedModelDisplayName"],I),e}function qf(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["tunedModels"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>Po(i,l))),r(e,["tuningJobs"],a)}return e}function Gf(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["metadata"]);o!=null&&r(e,["metadata"],o);const a=s(t,["done"]);a!=null&&r(e,["done"],a);const l=s(t,["error"]);return l!=null&&r(e,["error"],l),e}function Of(i,t){const e={},n=s(t,["checkpointId"]);n!=null&&r(e,["checkpointId"],n);const o=s(t,["epoch"]);o!=null&&r(e,["epoch"],o);const a=s(t,["step"]);a!=null&&r(e,["step"],a);const l=s(t,["endpoint"]);return l!=null&&r(e,["endpoint"],l),e}function Bf(i,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],n);const o=s(t,["endpoint"]);o!=null&&r(e,["endpoint"],o);const a=s(t,["checkpoints"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>Of(i,u))),r(e,["checkpoints"],l)}return e}function un(i,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const o=s(t,["state"]);o!=null&&r(e,["state"],po(i,o));const a=s(t,["createTime"]);a!=null&&r(e,["createTime"],a);const l=s(t,["startTime"]);l!=null&&r(e,["startTime"],l);const u=s(t,["endTime"]);u!=null&&r(e,["endTime"],u);const d=s(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const c=s(t,["error"]);c!=null&&r(e,["error"],c);const f=s(t,["description"]);f!=null&&r(e,["description"],f);const p=s(t,["baseModel"]);p!=null&&r(e,["baseModel"],p);const m=s(t,["tunedModel"]);m!=null&&r(e,["tunedModel"],Bf(i,m));const h=s(t,["supervisedTuningSpec"]);h!=null&&r(e,["supervisedTuningSpec"],h);const y=s(t,["tuningDataStats"]);y!=null&&r(e,["tuningDataStats"],y);const v=s(t,["encryptionSpec"]);v!=null&&r(e,["encryptionSpec"],v);const C=s(t,["partnerModelTuningSpec"]);C!=null&&r(e,["partnerModelTuningSpec"],C);const I=s(t,["distillationSpec"]);I!=null&&r(e,["distillationSpec"],I);const S=s(t,["experiment"]);S!=null&&r(e,["experiment"],S);const M=s(t,["labels"]);M!=null&&r(e,["labels"],M);const U=s(t,["pipelineJob"]);U!=null&&r(e,["pipelineJob"],U);const k=s(t,["serviceAccount"]);k!=null&&r(e,["serviceAccount"],k);const z=s(t,["tunedModelDisplayName"]);return z!=null&&r(e,["tunedModelDisplayName"],z),e}function $f(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const o=s(t,["tuningJobs"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>un(i,l))),r(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zf extends rt{constructor(t){super(),this.apiClient=t,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new Pt(Je.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const n=await this.tuneMldevInternal(e);let o="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?o=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(o=n.name.split("/operations/")[0]),{name:o,state:jt.JOB_STATE_QUEUED}}}}async getInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Rf(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>un(this.apiClient,f))}else{const c=If(this.apiClient,t);return u=A("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>Po(this.apiClient,f))}}async listInternal(t){var e,n,o,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=kf(this.apiClient,t);return u=A("tuningJobs",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),l.then(f=>{const p=$f(this.apiClient,f),m=new Ni;return Object.assign(m,p),m})}else{const c=Af(this.apiClient,t);return u=A("tunedModels",c._url),d=c._query,delete c.config,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),l.then(f=>{const p=qf(this.apiClient,f),m=new Ni;return Object.assign(m,p),m})}}async tuneInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Vf(this.apiClient,t);return a=A("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>un(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var e,n;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Pf(this.apiClient,t);return a=A("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>Gf(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Jf{async download(t,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Hf=1024*1024*8,Wf=3,Yf=1e3,Zf=2,Gt="x-goog-upload-status";async function Kf(i,t,e){var n,o,a;let l=0,u=0,d=new en(new Response),c="upload";for(l=i.size;u<l;){const p=Math.min(Hf,l-u),m=i.slice(u,u+p);u+p>=l&&(c+=", finalize");let h=0,y=Yf;for(;h<Wf&&(d=await e.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((n=d==null?void 0:d.headers)===null||n===void 0)&&n[Gt]));)h++,await Xf(y),y=y*Zf;if(u+=p,((o=d==null?void 0:d.headers)===null||o===void 0?void 0:o[Gt])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[Gt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function Qf(i){return{size:i.size,type:i.type}}function Xf(i){return new Promise(t=>setTimeout(t,i))}class jf{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Kf(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Qf(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ep{create(t,e,n){return new tp(t,e,n)}}class tp{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const to="x-goog-api-key";class np{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(to)===null&&t.append(to,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ip="gl-node/";class op{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey;const n=Js(t,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const o=new np(this.apiKey);this.apiClient=new Kd({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:ip+"web",uploader:new jf,downloader:new Jf}),this.models=new ff(this.apiClient),this.live=new af(this.apiClient,o,new ep),this.chats=new fa(this.models,this.apiClient),this.caches=new ua(this.apiClient),this.files=new Sa(this.apiClient),this.operations=new Ef(this.apiClient),this.tunings=new zf(this.apiClient)}}const Ro=i=>{if(!i||typeof i!="string")return!1;const t=[/(?:Question|Câu)\s*\d+\s*[:)]/i,/^\s*\d+\s*[.)]\s*\S+/m,/\b(?:Question|Câu)\s*\d+\s*[:)]/i],e=[/[A-D]\s*\.\s*\S+/i,/[A-D]\s*\)\s*\S+/i,/[A]\s*[.)].*?[B]\s*[.)]/is,/[B]\s*[.)].*?[C]\s*[.)]/is,/[C]\s*[.)].*?[D]\s*[.)]/is],n=t.some(l=>l.test(i)),a=e.filter(l=>l.test(i)).length>=2;return n&&a};let Ot=null;const Do=async()=>{if(!Ot){let i=await jo.getApiKey("GEMINI_API_KEY");if(i||(i=null,q.warn("Using fallback API key from environment","GeminiServiceInit")),typeof i!="string"||!i){const t="Google Gemini API Key not available. Please configure it in Supabase or environment variables. Quiz generation may fail.";throw q.error(t,"GeminiServiceInit"),new Error(t)}q.info("Gemini AI SDK Initializing with secure API Key.","GeminiServiceInit"),Ot=new op({apiKey:i})}return Ot},sp=i=>{let t=i.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s.exec(t);n&&n[1]&&(t=n[1].trim()),t=t.replace(/侬/g,""),t=t.replace(/ܘ/g,""),t=t.replace(/对着/g,""),t=t.replace(/"\s*```\s*([\]\},])/g,'"$1'),t=t.replace(/"\s*```\s*(,"[^"]+")/g,'"$1');try{const o='("[^"\\\\]*(?:\\\\.[^"\\\\]*)*")\\s*\\n\\s*([a-zA-Z_][a-zA-Z0-9_]*(?:\\s+[a-zA-Z_][a-zA-Z0-9_]*)*\\s*)"',a=new RegExp(o,"g");t=t.replace(a,(l,u,d)=>`${u.slice(0,-1)} ${d.trim()}"`)}catch(o){q.warn("Error during string newline fixing regex replacement.","GeminiServiceParse",void 0,o)}t=t.replace(/,\s*([\}\]])/g,"$1");try{t=t.replace(/\\(?![bfnrtv"\\/]|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{2})/g,"\\\\")}catch(o){q.warn("Error during bad escape fixing regex replacement.","GeminiServiceParse",void 0,o)}try{return JSON.parse(t)}catch(o){q.error("Primary JSON.parse failed for Gemini response.","GeminiServiceParse",{errorMsg:o.message,cleanedJsonPreview:t.substring(0,200),originalTextPreview:i.substring(0,200)},o);const a=t.indexOf("["),l=t.indexOf("{");let u=-1;if(a!==-1&&(l===-1||a<l)?u=a:l!==-1&&(u=l),u!==-1){let d=0,c=0,f=-1,p=!1;const m=t[u];for(let h=u;h<t.length;h++){const y=t[h];if(y==='"'&&(h===0||t[h-1]!=="\\"||t[h-1]==="\\"&&h>1&&t[h-2]==="\\")&&(p=!p),!p){if(y==="{"?c++:y==="}"?c--:y==="["?d++:y==="]"&&d--,m==="{"&&c===0&&d===0&&h>=u){f=h;break}if(m==="["&&d===0&&c===0&&h>=u){f=h;break}}}if(f!==-1)try{let h=t.substring(u,f+1);return h=h.replace(/,\s*([\}\]])/g,"$1"),q.info("Fallback parsing attempting with substring.","GeminiServiceParse",{substringPreview:h.substring(0,200)}),JSON.parse(h)}catch(h){q.error("Fallback JSON.parse also failed (Gemini).","GeminiServiceParse",{errorMsg:h.message,substringAttempted:t.substring(u,f+1).substring(0,200)},h)}else q.warn("Fallback parsing: Could not determine a valid JSON substring (Gemini).","GeminiServiceParse")}else q.warn("Fallback parsing: No JSON start characters ([ or {) found in the response (Gemini).","GeminiServiceParse");return null}},rp=i=>`
CRITICAL JSON Output Schema (MUST follow strictly):
{
  "title": "string (creative and relevant quiz title in ${i}, or use original title if preserving a formatted quiz)",
  "questions": [
    {
      "id": "string (unique identifier, e.g., 'q1', 'q2'. Make this reasonably unique.)",
      "questionText": "string (If preserving a formatted quiz: use the EXACT original question text including any numbering like 'Question 1:' or 'Câu 1:'. Otherwise: create a clear, unambiguous multiple-choice question in ${i}. This string MUST be formatted using Markdown, including lists, bolding, and LaTeX for math like $inline_math$ or $$block_math$$ where appropriate. Do not truncate.)",
      "options": ["string (A JSON array of EXACTLY 4 distinct option strings. If preserving a formatted quiz: use the exact original options, preserving their order as A, B, C, D. Each option string MUST be formatted using Markdown. CRITICAL: Each option MUST be a complete, valid JSON string, properly quoted (e.g., \\"Option Text\\"), and NOT TRUNCATED. All string content, including special characters and internal quotes, MUST be correctly escaped (e.g., \\"Option with \\\\\\"quote\\\\\\" inside\\"). Options in the array MUST be separated by commas. ABSOLUTELY NO extraneous text, unquoted characters, or non-JSON content should appear.)",
      ],
      "correctAnswer": "string (If preserving a formatted quiz with provided answers: use the exact correct answer from the original. If preserving a quiz without answers: research to find the correct answer. Otherwise for new quizzes: select one option as the correct answer. Must exactly match one of the option strings in the options array.)",
      "explanation": "string (Detailed explanation in ${i}, formatted using Markdown. For preserved formatted quizzes: provide explanation if available in original, otherwise create a brief explanation of why the answer is correct. For new quizzes: ideally 2-4 concise sentences explaining why the answer is correct and why distractors are wrong. Refer to source content if possible. This field can ALSO include supplementary information as requested by custom user prompts. Ensure this string is valid JSON content, formatted with Markdown, and not truncated.)"
    }
  ]
}
`,ap=i=>`You are an expert quiz creator for students. Your role is to:

1. Create high-quality multiple choice questions based on the provided content.
2. Each question MUST have EXACTLY 4 multiple-choice options (A, B, C, D).
3. Format all content using Markdown syntax for better readability.
4. For each question, provide:
   - A clear question text formatted with proper Markdown
   - Exactly 4 answer options (no more, no less)
   - The correct answer clearly identified
   - A detailed explanation that teaches the concept
   
5. IMPORTANT ROLE - FORMATTED QUIZ HANDLING: 
   If the user uploads a properly formatted quiz file, you MUST:
   - Use that quiz EXACTLY as provided without creating new questions
   - Keep the exact format, content, and options from the original quiz
   - Preserve all question numbering and formatting (e.g., "Question 1:" or "Câu 1:")
   - Preserve all option letters (A, B, C, D) and their exact content
   - Example: If content has "Câu 1: 1+1=? A. 2 B. 3 C. 4 D. 5", output this exact question and options
   - If answers are provided (e.g., "Answer: A"), use them
   - If answers are not provided, research to add the correct answers
   - Add explanations for each answer if not already included

IMPORTANT ROLE - FORMAT DETECTION:
If the user provides a properly formatted multiple-choice quiz file, you MUST:
- Use that quiz exactly as provided without creating new questions
- Keep the format, content, and options exactly the same
- For example, if the provided content has questions like:
  "Question 1: 1+1=?
   A. 2
   B. 3
   C. 4
   D. 5"
  You MUST use these exact questions and options in your output
- If the correct answers are provided, use them
- If correct answers are not provided, research and provide the correct answers
- Never create new questions when a properly formatted quiz is detected

FORMAT REQUIREMENTS:
- Use Markdown formatting for better readability (e.g., **bold**, *italic*, lists).
- Use **bold text** for emphasis.
- Use bullet lists for organizing information.
- Use > blockquotes for important notes.
- For math formulas, use proper LaTeX syntax with $...$ for inline and $$...$$ for block equations.
- NUMBER each question clearly (this is for conceptual structure; the JSON output will have question objects in an array).

EXPECTED OUTPUT FORMAT (This describes the conceptual structure that your JSON output should represent for each question object within the main JSON):
### Question {number} (This conceptual title should be mapped to the 'questionText' field in the JSON)

{question text with proper markdown} (This is the content for 'questionText' field)

A. {option A} (These are for the 'options' array in JSON)
B. {option B}
C. {option C}
D. {option D}

Correct Answer: {letter} (The 'correctAnswer' field in JSON should contain the full text of the correct option string, not just the letter)

**Explanation:**
{detailed explanation using markdown} (This is for the 'explanation' field in JSON)

IMPORTANT REQUIREMENTS FOR JSON:
- Always create EXACTLY 4 options (A, B, C, D) for each multiple-choice question. These go into the 'options' array.
- Make sure incorrect options are plausible but clearly incorrect upon analysis.
- All answers must be mutually exclusive with no ambiguity.
- Ensure questions test understanding, not just memorization.
- The entire output MUST be a single, valid JSON object, adhering to the schema specified in the user prompt.
- All string values (questionText, options, correctAnswer, explanation) must be valid JSON strings, with internal quotes and special characters properly escaped (e.g., "Option with a \\"quote\\""). For LaTeX, backslashes must be doubled (e.g., \\\\sqrt{x}).
- Do not truncate any JSON strings or the overall JSON structure.

USER CUSTOMIZATION:
Review the 'USER-PROVIDED INSTRUCTIONS' block in the user prompt.
IF IT CONTAINS TEXT:
    - These instructions DEFINE the *content, style, tone, and focus* for quiz elements. They OVERRIDE general guidelines.
    - Integrate any requested supplementary information (e.g., IPA, etymology) into the 'explanation' field, alongside the core explanation.
ELSE (if empty or states no custom instructions):
    - Generate the quiz based on general guidelines and the source content, prioritizing core requirements.
`,lp=(i,t,e)=>{let n="";const o=[],a=ap(),l=t.language||"English",u=cn(l==="Vietnamese"?"vi":"en"),d={Easy:u("step2DifficultyEasy"),Medium:u("step2DifficultyMedium"),Hard:u("step2DifficultyHard"),"AI-Determined":u("step2DifficultyAIDetermined")},c=d[t.difficulty]||d["AI-Determined"],f=t.numQuestions>0?t.numQuestions.toString():u("step2NumQuestionsAIPlaceholder"),p=u("step1PasteTextLabel");let m=`You are an expert quiz creator. Your task is to create a high-quality quiz based on the provided content.

`;return m+=`${p}

`,m+=`${u("step2DifficultyLabel")}: ${c}
`,m+=`${u("step2NumQuestionsLabel")}: ${f}

`,m+=`${u("step2LanguageLabel")}: ${l}

`,m+=`REQUIREMENTS:
`,m+=`- Use Markdown formatting throughout for better readability.
`,m+=`- EVERY question MUST have EXACTLY 4 multiple choice options (A, B, C, D).
`,m+=`- Present questions in clear, concise language.
`,m+=`- Provide detailed explanations for answers that teach the concept.

`,m+=`FORMATTED QUIZ DETECTION:
`,m+=`- CRITICAL INSTRUCTION: If the content contains a properly formatted multiple-choice quiz (like "Question 1: 1+1=? A. 2 B. 3 C. 4 D. 5"), use that quiz EXACTLY as provided.
`,m+=`- DO NOT create new questions or modify existing ones if a formatted quiz is detected.
`,m+=`- Preserve the exact wording of all questions and options (A, B, C, D).
`,m+=`- Keep question numbering and formatting exactly as in the original (e.g., "Question 1:" or "Câu 1:").
`,m+=`- If correct answers are provided in the original (e.g., with "Answer: A" or similar), use them.
`,m+=`- If correct answers are not provided, research to determine and add the correct answers.
`,m+=`- Generate explanations only if they're not already included in the original quiz.

`,m+=`MARKDOWN FORMAT:
`,m+=`- Use ### for conceptual question titles (map to 'questionText' in JSON).
`,m+=`- Use **bold** for emphasis.
`,m+=`- Use proper lists for options conceptually (map to 'options' array in JSON).
`,m+=`- Format math with $...$ (inline) and $$...$$ (block).
`,m+=`- Use blockquotes > for important notes.

`,typeof i=="string"&&i==="Generate quiz from user prompt."&&t.customUserPrompt&&t.customUserPrompt.trim().length>0&&t.customUserPrompt?(m+=`USER-PROVIDED PROMPT (PRIMARY SOURCE):
${t.customUserPrompt.trim()}

`,m+=`This is a prompt-only request. The user has not provided any source content. Instead, generate a quiz based ENTIRELY on the user's prompt above.
`,m+=`Create appropriate multiple-choice questions that fulfill the requirements in the user's prompt.

`):t.customUserPrompt&&t.customUserPrompt.trim()?m+=`USER-PROVIDED INSTRUCTIONS (OVERRIDE general guidelines if conflicting, otherwise supplement):
${t.customUserPrompt.trim()}

`:m+=`USER-PROVIDED INSTRUCTIONS: No specific user instructions provided. Default quiz generation guidelines apply, strictly adhering to core requirements.

`,m+=`Based on the content below, and all prior instructions, create a quiz. The quiz title suggestion is: "${e||"AI Suggested Title"}".

`,m+=`STRICTLY ADHERE to this JSON Output Schema:
${rp(l)}

`,m+=`CONTENT TO PROCESS:
`,typeof i=="string"&&i==="Generate quiz from user prompt."&&t.customUserPrompt&&t.customUserPrompt.trim().length>0&&t.customUserPrompt?(n=`AI Prompt: ${t.customUserPrompt.substring(0,500)}`+(t.customUserPrompt.length>500?"...":""),o.push({text:m})):typeof i=="string"?(n=i.substring(0,500)+(i.length>500?"...":""),o.push({text:`${m}"""${i}"""`})):(n=`Image content (${i.mimeType})`,o.push({text:m}),o.push({inlineData:{data:i.base64Data,mimeType:i.mimeType}})),{requestContents:{parts:o},sourceContentSnippet:n,systemInstructionString:a}},up=(i,t)=>{const e=cn(t);return i.map((n,o)=>{let a=Array.isArray(n.options)?[...n.options]:[],l=n.correctAnswer;if(a=a.map(u=>typeof u=="string"?u:String(u)),typeof l!="string"&&(l=String(l)),a.length<4){const u=4-a.length;for(let d=0;d<u;d++)a.push(e("reviewNewOptionDefault",{index:a.length+1+o*10}))}else if(a.length>4){const u=l;let d=a.slice(0,4);if(!d.includes(u)){for(d=[...Array.from(new Set(d.slice(0,3)))];d.length<3;)d.push(e("reviewNewOptionDefault",{index:d.length+1+o*10+100}));d.push(u),d.length>4&&(d=d.slice(d.length-4)),l=u}a=d}return!a.includes(l)&&a.length>0?(q.warn(`Correct answer for Q${o+1} ('${l}') was not in the final 4 options. Defaulting to first option.`,"GeminiServiceValidation",{options:a,originalCorrect:n.correctAnswer}),l=a[0]):a.length===0&&(l=e("error"),a=[e("error"),e("error"),e("error"),e("error")]),{...n,options:a,correctAnswer:l}})},ko=async(i,t,e)=>{var d,c;if(q.info("Attempting to generate quiz with Gemini","GeminiService",{model:Jt,lang:t.language}),typeof i=="string"&&i==="Generate quiz from user prompt."&&t.customUserPrompt&&t.customUserPrompt.trim().length>0)q.info("Prompt-only mode detected - using customUserPrompt as primary source","GeminiService",{promptPreview:(d=t.customUserPrompt)==null?void 0:d.substring(0,100),promptOnlyMode:!0});else if(typeof i=="string"&&Ro(i)){const f=i.match(/(?:Question|Câu)\s*\d+|^\s*\d+\s*[.)]/gmi)||[],p=i.match(/[A-D]\s*[.)]\s*\S+/gi)||[];q.info("Formatted quiz detected - will preserve exact format","GeminiService",{contentPreview:i.substring(0,100),formattedQuiz:!0,questionCount:f.length,optionCount:p.length})}const o=await Do(),{requestContents:a,sourceContentSnippet:l,systemInstructionString:u}=lp(i,t,e);try{const p=(await o.models.generateContent({model:Jt,contents:a,config:{responseMimeType:"application/json",systemInstruction:u}})).text||"";q.info("Received response from Gemini","GeminiService",{responsePreview:p.substring(0,200)});const m=sp(p);if(!m||!m.questions||!m.title||!Array.isArray(m.questions)||m.questions.length===0)throw q.error("Failed to parse quiz data or data is incomplete/invalid structure (Gemini).","GeminiService",{parsedDataPreview:(c=JSON.stringify(m))==null?void 0:c.substring(0,200)}),new Error("Gemini AI failed to generate quiz in the expected format or returned an empty/invalid quiz. Please check the console for the raw AI response and parsing attempts.");const h=t.language==="Vietnamese"?"vi":"en",v=up(m.questions,h).map(C=>{let I=C.id;return I||(I=Xo()),{...C,id:I,explanation:C.explanation||cn(h)("resultsNoExplanation")}});return q.info("Successfully generated and validated quiz from Gemini.","GeminiService",{title:m.title,questionCount:v.length}),{...m,questions:v,sourceContentSnippet:l}}catch(f){q.error("Error generating quiz with Gemini","GeminiService",void 0,f);let p="Failed to generate quiz with Gemini. An unexpected error occurred. Please try again later.";if(f instanceof Error){const m=f.message,h=m.toLowerCase();h.includes("api key not valid")||h.includes("api_key_invalid")||h.includes("process.env.api_key not set")||h.includes("api_key is not configured")||h.includes("process.env.gemini_api_key")?p="Invalid or Missing Gemini API Key (process.env.API_KEY). Please ensure the environment variable is correctly configured and accessible.":h.includes("deadline exceeded")?p="The Gemini AI took too long to respond. This might be due to complex content or a temporary issue. Please try again or simplify the content.":h.includes("quota")?p="Gemini API quota exceeded. Please check your Google AI Platform quotas or try again later.":h.includes("500")||h.includes("unknown")||h.includes("rpc failed")||h.includes("xhr error")?p="An unexpected error occurred while communicating with the AI service (Server Error or Network Issue). Please check your internet connection and try again in a few moments. If the problem persists, the AI service might be temporarily unavailable.":(h.includes("ai failed to generate quiz")||h.includes("empty/invalid quiz"))&&(p=m)}throw new Error(p)}},Lo=async i=>{q.info("Attempting to extract text from image with Gemini","GeminiServiceImage",{mimeType:i.mimeType});const t=await Do(),o={parts:[{inlineData:{data:i.base64Data,mimeType:i.mimeType}},{text:"Extract all visible text from this image. Respond with only the extracted text, without any additional commentary, formatting, or markdown. Just return the raw text content found in the image."}]};try{const l=(await t.models.generateContent({model:Jt,contents:o})).text||"";return q.info("Successfully extracted text from image.","GeminiServiceImage",{textLength:l.trim().length}),l.trim()}catch(a){if(q.error("Error extracting text from image with Gemini","GeminiServiceImage",void 0,a),a instanceof Error){const l=a.message.toLowerCase();if(l.includes("api key not valid")||l.includes("api_key_invalid")||l.includes("api_key is not configured")||l.includes("process.env.api_key not set")||l.includes("process.env.gemini_api_key"))throw new Error("Invalid or Missing Gemini API Key (process.env.API_KEY) for text extraction. Please ensure the environment variable is correctly configured and accessible.");if(l.includes("500")||l.includes("unknown")||l.includes("rpc failed")||l.includes("xhr error"))throw new Error("Failed to extract text from image due to a server or network error. Please try again.")}return null}},Bt=Object.freeze(Object.defineProperty({__proto__:null,extractTextFromImageWithGemini:Lo,generateQuizWithGemini:ko,isFormattedQuiz:Ro},Symbol.toStringTag,{value:"Module"})),cp=async(i,t,e)=>{try{if(t.selectedModel===Ve)return await ko(i,t,e);{const n=`Unsupported model: ${t.selectedModel}`;throw q.error(n,"aiQuizService",{config:t}),new Error(n)}}catch(n){throw q.error(`Error in generateQuizWithSelectedModel using ${t.selectedModel||"unknown model"}`,"aiQuizService",{config:t},n),n}};var dp=Wo();const fp=us(dp);typeof window<"u"&&(Zo.workerSrc="https://esm.sh/pdfjs-dist@4.4.168/build/pdf.worker.min.js");const pp=async i=>{const t=await i.arrayBuffer(),e=await Yo({data:t}).promise;let n="";for(let o=1;o<=e.numPages;o++){const l=await(await e.getPage(o)).getTextContent();n+=l.items.map(u=>"str"in u?u.str:"").join(" ")+`
`}return n},mp=async i=>{const t=await i.arrayBuffer();return(await fp.extractRawText({arrayBuffer:t})).value},hp=i=>new Promise((t,e)=>{const n=new FileReader;n.onload=()=>{const a=n.result.split(",");if(a.length!==2){e(new Error("Invalid file data for base64 conversion"));return}const l=a[0].split(":")[1].split(";")[0];t({base64Data:a[1],mimeType:l})},n.onerror=o=>e(o),n.readAsDataURL(i)}),$t=5,zt="quizAICreationTimestamps_unauth",Xe=2,pt=[.25,.1,.25,1],ve=({icon:i,label:t,value:e,iconClassName:n="text-[var(--color-primary-accent)]"})=>g.jsxs("div",{className:"flex items-start py-2.5",children:[g.jsx("span",{className:`mr-3.5 mt-0.5 flex-shrink-0 ${n}`,children:i}),g.jsxs("div",{className:"flex-grow",children:[g.jsx("strong",{className:"text-[var(--color-text-primary)] font-medium block text-sm",children:t}),g.jsx("span",{className:"text-[var(--color-text-secondary)] text-sm leading-relaxed",children:e})]})]});ve.displayName="SummaryItem";const gp=i=>{if(i.length===0)return"";if(i.length===1)return i[0].split(".").slice(0,-1).join(".")||i[0];let t="";const e=i[0].split(".").slice(0,-1).join(".")||i[0];let n=Math.min(...i.map(o=>(o.split(".").slice(0,-1).join(".")||o).length));n=Math.min(n,e.length);for(let o=0;o<n;o++){const a=e[o];if(i.every(l=>(l.split(".").slice(0,-1).join(".")||l)[o]===a))t+=a;else break}return t.replace(/[^a-zA-Z0-9\s_-]+$/,"").trim()},yp=()=>{const{language:i,currentUser:t}=es(),{t:e}=ts(),n=Qo(),[o,a]=G.useState(1),[l,u]=G.useState([]),[d,c]=G.useState([]),[f,p]=G.useState(null),[m,h]=G.useState(!1),[y,v]=G.useState({current:0,total:0}),[C,I]=G.useState(""),[S,M]=G.useState(null),[U,k]=G.useState(null),[z,B]=G.useState(null),[Z,L]=G.useState(""),[$,ee]=G.useState(!1),[de,We]=G.useState(""),[le,Ye]=G.useState(!1),[De,Fo]=G.useState(""),Uo=!0,[re,Vo]=G.useState(Uo),[ke,hn]=G.useState("Medium"),[Le,gn]=G.useState(10),[te,Se]=G.useState({numQuestions:0,difficulty:"AI-Determined",language:i==="vi"?"Vietnamese":"English",selectedModel:Ve}),[Ze,at]=G.useState(!1),[Ae,bo]=G.useState(null),[qo,ge]=G.useState(0),[Dt,Ke]=G.useState(""),[yn,vn]=G.useState(!1),[Go,Tn]=G.useState(!1),ne=P=>{bo(P),P&&q.warn(`Processing Error Set: ${P}`,"QuizCreatePage")};G.useEffect(()=>{Se(P=>({...P,language:i==="vi"?"Vietnamese":"English",difficulty:re?"AI-Determined":ke!=="AI-Determined"?ke:"Medium",numQuestions:re?P.numQuestions:Le>0?Le:10,selectedModel:Ve}))},[i,re,ke,Le]),G.useEffect(()=>{window.scrollTo(0,0)},[o]),G.useEffect(()=>{S&&typeof S=="string"?Vt(()=>Promise.resolve().then(()=>Bt),void 0).then(P=>{const R=P.isFormattedQuiz(S);ee(R),R&&q.info("Formatted quiz detected in content","QuizCreatePage",{contentPreview:S.substring(0,100)})}).catch(P=>{q.error("Error checking for formatted quiz","QuizCreatePage",void 0,P),ee(!1)}):ee(!1)},[S]);const kt=()=>!1,Oo=G.useCallback(async P=>{if(P.length===0){u([]),I(""),k(null),c([]),p(null),M(null),B(null),L("");return}u(P),I(""),k(null),h(!0),ne(null),ge(0),v({current:0,total:P.length}),L(gp(P.map(R=>R.name))||e("step2MultipleFilesQuizTitle"));try{const R=[];let J="";for(let X=0;X<P.length;X++){const N=P[X];v({current:X+1,total:P.length});let V=null,oe=!1;if(N.type==="application/pdf")V=await pp(N);else if(N.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||N.name.endsWith(".docx"))V=await mp(N);else if(N.type.startsWith("image/")){oe=!0;const j=await hp(N);P.length===1&&k(j),kt()||(V=await Lo(j)||e("step1ErrorProcessingFile")+` (${N.name} - AI could not extract text)`),P.length===1&&B(V)}else if(N.type==="text/plain"||N.name.endsWith(".txt"))V=await N.text();else throw new Error(e("step1ErrorUnsupportedFile")+` (${N.name})`);V?(R.push({text:V,fileName:N.name}),J+=`=== [${N.name}] ===

${V}

`):oe&&P.length>1&&(J+=`=== [${N.name}] ===

[Image content - text extraction may have been skipped or failed]

`)}const H=J.trim();c(R),p(H),M(H),Vt(()=>Promise.resolve().then(()=>Bt),void 0).then(X=>{const N=X.isFormattedQuiz(H);ee(N),N&&ne("✅ Quiz format detected! The system will preserve all questions and options exactly as provided.")}).catch(()=>ee(!1)),a(2)}catch(R){q.error("Error processing files:","QuizCreatePageFileProcessing",void 0,R),ne(R instanceof Error?R.message:e("step1ErrorProcessingFile"))}finally{h(!1),v({current:P.length,total:P.length})}},[e,kt]),Bo=G.useCallback(async()=>{if(C.trim()){const P=C.trim();u([]),c([]),p(null),k(null),B(null),M(P),L(e("step2PastedText")+" Quiz"),Vt(()=>Promise.resolve().then(()=>Bt),void 0).then(R=>{const J=R.isFormattedQuiz(P);ee(J),ne(J?"✅ Quiz format detected! The system will preserve your quiz exactly as provided.":null)}).catch(()=>{ee(!1),ne(null)}),a(2)}else ne(e("step1ErrorPasteText"))},[C,e]),Lt=P=>{const{name:R,value:J}=P.target;if(R==="numQuestions"){const H=P.target.value,X=parseInt(H,10),N=isNaN(X)||X<0?0:X;if(re)Se(V=>({...V,numQuestions:N}));else{const V=N<=0?1:N;Se(oe=>({...oe,numQuestions:V})),gn(V)}}else if(R==="difficulty"){const H=J;Se(X=>({...X,difficulty:H,selectedModel:Ve})),!re&&H!=="AI-Determined"&&hn(H)}else Se(H=>({...H,[R]:J,selectedModel:Ve}))},$o=G.useCallback(P=>{Vo(P),P?(te.difficulty!=="AI-Determined"&&hn(te.difficulty),gn(R=>te.numQuestions>0?te.numQuestions:R),Se(R=>({...R,difficulty:"AI-Determined",numQuestions:0}))):Se(R=>({...R,difficulty:ke==="AI-Determined"?"Medium":ke,numQuestions:Le>0?Le:10}))},[te.difficulty,te.numQuestions,ke,Le]),zo=async()=>{if(q.info("Quiz generation initiated.","QuizCreatePageGenerate",{config:te}),!t){const J=Date.now()-24*60*60*1e3;let H=[];try{const N=localStorage.getItem(zt);N&&(H=JSON.parse(N))}catch(N){q.error("Error reading unauth timestamps from localStorage","QuizCreateRateLimit",void 0,N),H=[]}if(H.filter(N=>N>J).length>=$t){ne(e("rateLimitErrorUnauthenticated",{limit:$t})),at(!1),ge(0);return}}let P;if(le&&de&&de.trim())P="Generate quiz from user prompt.";else if(l.length>0)if(f&&f.trim())P=f;else if(U&&l.length===1&&l[0].type.startsWith("image/")){ne(e("step1ErrorProcessingFile"));return}else{ne(e("step1ErrorProcessingFile"));return}else if(C&&C.trim())P=C;else{ne(e("step1ErrorProcessingFile"));return}at(!0),ne(null),ge(0),Ke(e("step3AIIsThinking"));for(let R=0;R<=Xe;R++)try{R>0&&(Ke(e("step3AIIsRetrying",{currentAttempt:R,maxAttempts:Xe})),await new Promise(V=>setTimeout(V,1500*R)));const J={...te,customUserPrompt:de.trim()||void 0,selectedModel:Ve};ge(10+R*5);const H=cp(P,J,Z);let X=setInterval(()=>{ge(V=>V>=85-R*5?(clearInterval(X),V):Math.min(V+5,85-R*5))},400);const N=await H;if(clearInterval(X),ge(95),!t){let V=[];try{const ie=localStorage.getItem(zt);ie&&(V=JSON.parse(ie))}catch(ie){q.error("Error reading unauth timestamps for update","QuizCreateRateLimit",void 0,ie),V=[]}const oe=Date.now(),j=oe-24*60*60*1e3,K=V.filter(ie=>ie>j);K.push(oe);try{localStorage.setItem(zt,JSON.stringify(K))}catch(ie){q.error("Error writing unauth timestamps to localStorage","QuizCreateRateLimit",void 0,ie)}}q.info("Quiz generated successfully, navigating to review.","QuizCreatePageGenerate",{title:N.title}),n("/review",{state:{generatedQuizData:N,quizTitleSuggestion:Z||N.title,finalConfig:J}}),ge(100),at(!1),Ke("");return}catch(J){if(q.error(`Error generating quiz (Attempt ${R+1}/${Xe+1}):`,"QuizCreatePageGenerate",{config:te},J),J.message&&J.message.includes("Gemini AI failed to generate quiz")&&R<Xe)R===Xe-1&&ge(70);else{ne(J instanceof Error?J.message:e("step3ErrorGenerate")),ge(0),at(!1),Ke("");return}}},Jo=()=>{S&&navigator.clipboard.writeText(S).then(()=>{Tn(!0),setTimeout(()=>Tn(!1),2e3)}).catch(P=>{q.error("Failed to copy text to clipboard","QuizCreatePage",void 0,P),alert(e("azotaExportErrorCopy"))})},Cn=G.useCallback(()=>vn(!1),[]),Ft="https://img.icons8.com/?size=256&id=eoxMN35Z6JKg&format=png",Ut=(P,R,J,H,X=!1)=>{const N=P===R,V=P>R,oe="text-[var(--color-text-muted)]";let j;const K="https://img.icons8.com/?size=256&id=VFaz7MkjAiu0&format=png",ie="w-5 h-5 sm:w-6 sm:h-6 transition-transform var(--duration-fast) var(--ease-ios)";if(V)j=g.jsx("img",{src:K,alt:e("stepCompleted"),className:ie});else if(N){let Me="";R===1?Me="https://img.icons8.com/?size=256&id=hwKgsZN5Is2H&format=png":R===2?Me="https://img.icons8.com/?size=256&id=WwHcZxa9PFUq&format=png":R===3&&(Me=Ft),Me?j=g.jsx("img",{src:Me,alt:e(J),className:`${ie} scale-110`}):ut.isValidElement(H)?j=ut.cloneElement(H,{className:`${ie} scale-110`}):j=H}else ut.isValidElement(H)?j=ut.cloneElement(H,{className:ie}):j=H;return g.jsxs("div",{className:`flex flex-col items-center transition-colors var(--duration-fast) var(--ease-ios) ${N?"text-[var(--color-primary-accent)]":V?"text-green-400":oe}`,children:[g.jsxs("div",{className:`flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 mb-2.5 transition-all var(--duration-fast) var(--ease-ios) will-change-transform, border, background-color, box-shadow ${N?"border-[var(--color-primary-accent)] bg-[var(--color-primary-accent)]/20 text-[var(--color-primary-accent)] shadow-xl scale-105":V?"border-green-400 bg-green-400/20 text-green-400 shadow-lg":`border-[var(--color-border-default)] bg-[var(--color-bg-surface-2)]/60 ${oe}`} font-semibold text-base sm:text-lg`,children:[" ",j," "]}),g.jsx("span",{className:`text-xs sm:text-sm font-semibold text-center transition-colors var(--duration-fast) var(--ease-ios) ${N?"text-[var(--color-text-primary)]":V?"text-[var(--color-text-secondary)]":oe}`,children:e(J)})]})},Ho=()=>{switch(o){case 1:return g.jsxs(Fe,{className:"max-w-xl mx-auto shadow-2xl !rounded-2xl",useGlassEffect:!0,children:[" ",g.jsxs("div",{className:"space-y-8",children:[g.jsx(ls,{onFileUpload:Oo,acceptedFileTypes:".pdf,.txt,.docx,.jpg,.png,.jpeg",maxFileSizeMB:10,label:g.jsx("p",{className:"text-base font-semibold text-[var(--color-text-primary)] mb-2",children:e("step1UploadOrDrag")}),icon:g.jsx("img",{src:"https://img.icons8.com/?size=256&id=hwKgsZN5Is2H&format=png",alt:e("upload"),className:"w-12 h-12 sm:w-14 sm:h-14 mb-3.5 text-[var(--color-text-muted)] group-hover:text-[var(--color-primary-accent)] transition-all var(--duration-fast) var(--ease-ios) group-hover:scale-105"}),isLoading:m,currentFiles:l.length>0?l:null,multipleFiles:!0}),m&&g.jsxs("div",{className:"mt-4 animate-fadeIn",children:[g.jsx("div",{className:"flex items-center justify-between mb-1",children:g.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:e("step1ProcessingProgress",{current:y.current,total:y.total})})}),g.jsx(En,{progress:y.current/Math.max(1,y.total)*100,showPercentage:!1})]}),g.jsxs("div",{className:"relative flex py-1 items-center",children:[" ",g.jsx("div",{className:"flex-grow border-t border-[var(--color-border-default)]"})," ",g.jsx("span",{className:"flex-shrink mx-4 text-[var(--color-text-muted)] text-xs font-medium uppercase tracking-wider",children:e("step1Or")})," ",g.jsx("div",{className:"flex-grow border-t border-[var(--color-border-default)]"})," "]}),g.jsx(ct,{label:g.jsx("p",{className:"text-base font-semibold text-[var(--color-text-primary)]",children:e("step1PasteTextLabel")}),value:C,onChange:K=>I(K.target.value),placeholder:e("step1PasteTextPlaceholder"),rows:6,className:"min-h-[150px] text-sm paste-text-area"}),g.jsxs(ye,{onClick:Bo,disabled:!C.trim()||m,fullWidth:!0,size:"lg",variant:"secondary",className:"py-3 shadow-lg",children:[" ",e("step1UsePastedText")," "]}),g.jsxs("div",{className:"relative flex py-1 items-center",children:[" ",g.jsx("div",{className:"flex-grow border-t border-[var(--color-border-default)]"})," ",g.jsx("span",{className:"flex-shrink mx-4 text-[var(--color-text-muted)] text-xs font-medium uppercase tracking-wider",children:e("step1Or")})," ",g.jsx("div",{className:"flex-grow border-t border-[var(--color-border-default)]"})," "]}),g.jsx(ct,{label:g.jsx("p",{className:"text-base font-semibold text-[var(--color-text-primary)]",children:"AI Prompt"}),value:De,onChange:K=>Fo(K.target.value),placeholder:"Tạo 50 câu hỏi ôn tập tiếng Anh chủ đề gia đình",rows:6,className:"min-h-[150px] text-sm paste-text-area"}),g.jsx(ye,{onClick:()=>{De.trim()?(Ye(!0),We(De),I(""),u([]),c([]),p(null),k(null),B(null),M(`AI Prompt: ${De.trim()}`),L("AI Generated Quiz"),a(2)):ne("Please enter an AI prompt")},disabled:!De.trim()||m,fullWidth:!0,size:"lg",variant:"primary",className:"py-3 shadow-lg bg-gradient-to-r from-green-500 via-teal-500 to-sky-500 hover:from-green-600 hover:via-teal-600 hover:to-sky-600 text-white",children:"Generate Quiz from Prompt"}),Ae&&!m&&g.jsx("div",{role:"alert",className:`p-3.5 ${Ae.startsWith("✅")?"bg-green-500/20 border-green-500/50 text-green-300":"bg-red-500/20 border-red-500/50 text-red-300"} border rounded-lg text-sm text-center shadow-md animate-fadeIn`,children:Ae})]})," "]});case 2:const P=g.jsxs("div",{className:"flex items-center text-sm font-semibold text-[var(--color-text-primary)]",children:[" ",g.jsx("img",{src:"https://www.pngall.com/wp-content/uploads/16/Google-Gemini-Logo-Transparent.png",alt:e("step2AIModelLabel"),className:"w-5 h-5 mr-2.5"})," ",e("step2AIModelLabel")," ",kt()," "]}),R=g.jsxs("div",{className:"flex items-center text-sm font-medium text-[var(--color-text-secondary)]",children:[e("step2CustomPromptLabel"),g.jsx(is,{content:g.jsx("div",{className:"max-w-xs text-left text-xs",children:e("step2CustomPromptPlaceholder")}),placement:"top",children:g.jsx(xn,{className:"w-4 h-4 text-[var(--color-text-muted)] ml-2.5 cursor-help"})})]}),J=[{value:"Easy",label:e("step2DifficultyEasy")},{value:"Medium",label:e("step2DifficultyMedium")},{value:"Hard",label:e("step2DifficultyHard")}],H=[...J,{value:"AI-Determined",label:e("step2DifficultyAIDetermined")}],X=e(re?"step2NumQuestionsLabelAIMode":"step2NumQuestionsLabel");let N;return le&&(S!=null&&S.startsWith("AI Prompt:"))?N=g.jsxs("div",{children:[g.jsx("span",{className:"text-blue-400 font-medium",children:"AI Prompt:"})," ",De]}):l.length>0?l.length===1?N=g.jsxs("div",{children:[U?e("step2Image",{fileName:l[0].name}):e("step2File",{fileName:l[0].name}),$&&g.jsx("div",{className:"mt-2 text-xs font-medium text-green-500",children:"✅ Quiz format detected! Questions will be preserved exactly as provided."})]}):N=g.jsxs(g.Fragment,{children:[e("step2MultipleFiles",{count:l.length}),":",g.jsxs("ul",{className:"list-none text-xs opacity-80 max-h-20 overflow-y-auto thin-scrollbar-horizontal",children:[l.slice(0,5).map((K,ie)=>g.jsx("li",{className:"truncate",title:K.name,children:K.name},ie)),l.length>5&&g.jsx("li",{children:e("step2AndMoreFiles",{count:l.length-5})})]}),$&&g.jsx("div",{className:"mt-2 text-xs font-medium text-green-500",children:"✅ Quiz format detected! Questions will be preserved exactly as provided."})]}):C?N=g.jsxs("div",{children:[e("step2PastedText"),$&&g.jsx("div",{className:"mt-2 text-xs font-medium text-green-500",children:"✅ Quiz format detected! Questions will be preserved exactly as provided."})]}):N="N/A",g.jsxs(Fe,{className:"max-w-2xl mx-auto shadow-2xl !rounded-2xl",useGlassEffect:!0,children:[" ",g.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[g.jsxs(Fe,{className:"!bg-[var(--color-bg-surface-2)]/70 !border-[var(--color-border-default)] p-4 sm:p-5 !rounded-xl shadow-lg",useGlassEffect:!1,children:[g.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text-secondary)] mb-2.5",children:e("step2SourceContent")}),g.jsxs("div",{className:"flex items-center text-sm text-[var(--color-text-body)] overflow-x-auto overflow-y-hidden whitespace-nowrap cursor-default thin-scrollbar-horizontal py-0.5",children:[g.jsx(bt,{className:"w-5 h-5 mr-3 text-[var(--color-primary-accent)] flex-shrink-0",strokeWidth:1.5}),g.jsx("span",{className:"pr-1",children:N})]}),S&&g.jsxs(ye,{variant:"secondary",onClick:()=>vn(!0),className:"text-xs !font-semibold mt-3.5 py-2 px-4 rounded-lg shadow-md",leftIcon:g.jsx(bt,{className:"w-4 h-4",strokeWidth:2}),children:[" ",e("step2ViewFullText")," "]})]}),g.jsx(Sn,{label:g.jsx("p",{className:"text-base font-semibold text-[var(--color-text-primary)]",children:e("step2QuizTitleLabel")}),name:"quizTitle",value:Z,onChange:K=>L(K.target.value),placeholder:e("step2QuizTitlePlaceholder"),inputClassName:"text-lg py-3"}),g.jsxs(Fe,{className:"!bg-[var(--color-bg-surface-2)]/70 !border-[var(--color-border-default)] p-4 sm:p-5 !rounded-xl shadow-lg",useGlassEffect:!1,children:[" ",P," ",g.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1.5",children:["Google Gemini ",g.jsx("span",{className:"font-medium",children:g.jsxs("span",{className:"text-green-400",children:["(",e("default"),")"]})})]})," "]}),g.jsxs(Fe,{className:"p-4 sm:p-5 !border-[var(--color-border-default)] !bg-[var(--color-bg-surface-1)]/70 shadow-lg space-y-5 !rounded-xl",useGlassEffect:!1,children:[g.jsx(os,{label:g.jsx("p",{className:"text-base font-semibold text-[var(--color-text-primary)]",children:e("step2AIModeLabel")}),checked:re,onChange:$o}),g.jsx(Sn,{label:X,type:"number",name:"numQuestions",value:te.numQuestions,onChange:Lt,min:re?"0":"1",max:"50",containerClassName:re?"mt-4":"",placeholder:re&&te.numQuestions===0?e("step2NumQuestionsAIPlaceholder"):void 0}),g.jsx(An,{label:e("step2DifficultyLabel"),name:"difficulty",value:te.difficulty,onChange:Lt,options:re?H:J,disabled:re}),g.jsx(An,{label:e("step2LanguageLabel"),name:"language",value:te.language,onChange:Lt,options:[{value:"English",label:e("step2LanguageEnglish")},{value:"Vietnamese",label:e("step2LanguageVietnamese")}]})]}),g.jsx(ct,{label:R,name:"customUserPrompt",value:de,onChange:K=>We(K.target.value),placeholder:e("step2CustomPromptPlaceholder").substring(0,60)+"...",rows:4,className:"min-h-[90px] text-sm"}),Ae&&g.jsx("div",{role:"alert",className:"p-3.5 bg-red-500/20 border border-red-500/50 rounded-lg text-sm text-red-300 text-center shadow-md animate-fadeIn",children:Ae}),g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center pt-5 gap-4",children:[g.jsxs(ye,{variant:"outline",onClick:()=>{a(1),M(null),p(null),c([]),k(null),u([]),I(""),ne(null),B(null)},leftIcon:g.jsx(In,{className:"w-4 h-4"}),size:"lg",className:"w-full sm:w-auto py-3",children:[" ",e("back")," "]}),g.jsxs(ye,{onClick:()=>{a(3),ne(null)},disabled:!1,rightIcon:g.jsx(ss,{className:"w-4 h-4"}),variant:"primary",size:"lg",className:"w-full sm:w-auto py-3",children:[" ",e("step2NextButton")," "]})]})]}),yn&&g.jsx(rs,{isOpen:yn,onClose:Cn,title:e("fullTextModalTitle"),size:"3xl",footerContent:g.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between items-center w-full gap-3 sm:gap-0",children:[" ",g.jsxs(ye,{variant:"outline",onClick:Jo,leftIcon:g.jsx(as,{className:"w-4 h-4"}),size:"md",className:"w-full sm:w-auto",children:[" ",e(Go?"azotaExportCopied":"azotaExportCopy")," "]})," ",g.jsxs(ye,{onClick:Cn,variant:"secondary",size:"md",className:"w-full sm:w-auto",children:[" ",e("close")," "]})," "]}),children:g.jsx(ct,{value:S||"",readOnly:!0,className:"!bg-[var(--color-bg-surface-2)] !border-[var(--color-border-default)] text-[var(--color-text-primary)] whitespace-pre-wrap text-sm min-h-[60vh] max-h-[65vh] shadow-inner focus:!border-[var(--color-primary-accent)]/70 focus:!ring-[var(--color-primary-accent)]/40",rows:20,"aria-label":e("fullTextModalTitle")})})," "]});case 3:const V="w-5 h-5";let oe=e("step3GenerateButton");if(Ze){const K=Dt.match(/Attempt (\d+)\/(\d+)/)||Dt.match(/Lần (\d+)\/(\d+)/);if(K&&K.length===3){const ie=parseInt(K[1],10),Me=parseInt(K[2],10);oe=e("step3GeneratingRetryButton",{currentAttempt:ie,maxAttempts:Me})}else oe=e("step3GeneratingButton")}let j;return le?j="AI Prompt":l.length>0?l.length===1?j=U?e("step2Image",{fileName:l[0].name}):e("step2File",{fileName:l[0].name}):j=e("step2MultipleFiles",{count:l.length}):C?j=e("step2PastedText"):j="N/A",g.jsxs(Fe,{className:"max-w-xl mx-auto shadow-2xl !rounded-2xl",useGlassEffect:!0,children:[g.jsxs("div",{className:"!bg-[var(--color-bg-surface-2)]/70 p-6 sm:p-8 !rounded-xl mb-8 border border-[var(--color-border-default)] shadow-xl",children:[g.jsx("h3",{className:"text-2xl sm:text-3xl font-semibold text-[var(--color-text-primary)] mb-6 text-center",children:e("step3SummaryTitle")}),g.jsxs("div",{className:"space-y-1 divide-y divide-[var(--color-border-default)]/50",children:[g.jsx(ve,{icon:g.jsx("img",{src:"https://www.pngall.com/wp-content/uploads/16/Google-Gemini-Logo-Transparent.png",alt:e("step2AIModelLabel"),className:V}),label:e("step3AIModelSelected",{modelName:""}),value:"Google Gemini"}),g.jsx(ve,{icon:g.jsx(bt,{className:V}),label:e("step3TitleSuggestion",{title:""}),value:g.jsx(_n,{text:Z||e("step3TitleAISuggested")})}),g.jsx(ve,{icon:g.jsx("img",{src:"https://img.icons8.com/?size=256&id=hwKgsZN5Is2H&format=png",alt:e("upload"),className:V}),label:e("step3ContentSource",{source:""}),value:j}),g.jsx(ve,{icon:g.jsx("img",{src:"https://img.icons8.com/?size=256&id=WwHcZxa9PFUq&format=png",alt:e("settings"),className:V}),label:e("step3Mode",{mode:""}),value:re?e("step3ModeAIOptimized"):"Manual"}),g.jsx(ve,{icon:g.jsx("img",{src:"https://img.icons8.com/?size=256&id=PPnPJOpQpJ2J&format=png",alt:e("step3NumQuestions",{count:""}),className:V}),label:e("step3NumQuestions",{count:""}),value:re&&te.numQuestions===0?e("step2NumQuestionsAIPlaceholder"):te.numQuestions}),g.jsx(ve,{icon:g.jsx(ns,{className:V}),label:e("step3Difficulty",{level:""}),value:te.difficulty==="AI-Determined"?e("step2DifficultyAIDetermined"):e(`step2Difficulty${te.difficulty}`)}),g.jsx(ve,{icon:g.jsx("img",{src:"https://img.icons8.com/?size=48&id=fs8AdHsHlO36&format=png",alt:"Language",className:V}),label:e("step3Language",{lang:""}),value:te.language==="English"?e("step2LanguageEnglish"):e("step2LanguageVietnamese")}),g.jsx("div",{className:"pt-2.5",children:g.jsx(ve,{icon:g.jsx(xn,{className:V}),label:de.trim()?e("step3CustomPromptProvidedLabel"):e("step3CustomPromptNone"),value:de.trim()?g.jsx("blockquote",{className:"text-xs text-[var(--color-text-body)]/90 italic whitespace-pre-wrap max-h-24 overflow-y-auto bg-[var(--color-bg-surface-1)]/40 p-2 rounded-md mt-1 border-l-2 border-[var(--color-border-default)]/70",children:g.jsx(_n,{text:de.trim()})}):""})})]})]}),g.jsxs(ye,{onClick:zo,isLoading:Ze,disabled:Ze,fullWidth:!0,size:"lg",variant:"primary",leftIcon:g.jsx("img",{src:Ft,alt:e("step3GenerateButton"),className:"w-5 h-5"}),className:"bg-gradient-to-r from-green-500 via-teal-500 to-sky-500 hover:from-green-600 hover:via-teal-600 hover:to-sky-600 text-white dark:text-white shadow-xl hover:shadow-green-500/40 py-3.5 rounded-xl",children:[" ",oe," "]}),Ze&&g.jsx(En,{progress:qo,label:Dt||e("step3AIIsThinking"),className:"mt-6 animate-fadeIn"}),Ae&&!Ze&&g.jsx("div",{role:"alert",className:"mt-5 p-3.5 bg-red-500/20 border border-red-500/50 rounded-lg text-sm text-red-300 text-center shadow-md animate-fadeIn",children:Ae}),g.jsxs("div",{className:"mt-8 text-center",children:[" ",g.jsxs(ye,{variant:"outline",onClick:()=>{a(2),ne(null),Ke("")},leftIcon:g.jsx(In,{className:"w-4 h-4"}),size:"lg",className:"w-full sm:w-auto py-3",children:[" ",e("step3BackButtonCfg")," "]})," "]})]})}};return g.jsxs("div",{className:"py-6 sm:py-8",children:[" ",g.jsxs(lt.div,{className:"relative mb-10 sm:mb-12",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.35,ease:pt},children:[" ",g.jsxs("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:[" ",g.jsx("div",{className:"w-full border-t-2 border-[var(--color-border-default)]/60 border-dashed"})," "]})," ",g.jsxs("div",{className:"relative flex justify-center",children:[" ",g.jsxs("span",{className:"px-5 sm:px-6 bg-[var(--color-bg-body)] text-2xl sm:text-3xl font-bold text-[var(--color-text-primary)] tracking-tight",children:[" ",e("createQuiz")," "]})," "]})," "]})," ",g.jsxs(lt.div,{className:"mb-8 sm:mb-10 text-center px-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.35,ease:pt,delay:.1},children:[" ",g.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:[" ",e("rateLimitInfoUnauthenticated",{limit:$t})," ",e("rateLimitInfoAuthenticated")," "]})," "]})," ",g.jsxs(lt.div,{className:"max-w-lg mx-auto mb-12 sm:mb-16 flex justify-around items-start p-4 sm:p-5 bg-[var(--color-bg-surface-1)]/70 rounded-2xl shadow-xl border border-[var(--color-border-default)] glass-effect",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:pt,delay:.2},children:[" ",Ut(o,1,"step1Title",g.jsx("img",{src:"https://img.icons8.com/?size=256&id=hwKgsZN5Is2H&format=png",alt:e("step1Title")}))," ",g.jsxs("div",{className:"flex-grow h-1.5 bg-[var(--color-bg-surface-3)] rounded-full mx-3 sm:mx-5 mt-5 sm:mt-[1.375rem]",children:[g.jsx("div",{className:"h-1.5 bg-[var(--color-primary-accent)] rounded-full transition-width var(--duration-normal) var(--ease-ios)",style:{width:o===1?"0%":o===2?"50%":"100%"}})," "]})," ",Ut(o,2,"step2Title",g.jsx("img",{src:"https://img.icons8.com/?size=256&id=WwHcZxa9PFUq&format=png",alt:e("step2Title")}))," ",g.jsxs("div",{className:"flex-grow h-1.5 bg-[var(--color-bg-surface-3)] rounded-full mx-3 sm:mx-5 mt-5 sm:mt-[1.375rem]",children:[g.jsx("div",{className:"h-1.5 bg-[var(--color-primary-accent)] rounded-full transition-width var(--duration-normal) var(--ease-ios)",style:{width:o<=2?"0%":"100%"}})," "]})," ",Ut(o,3,"step3Title",g.jsx("img",{src:Ft,alt:e("step3Title"),className:"w-5 h-5 sm:w-6 sm:h-6"}),!0)," "]})," ",g.jsxs(Ko,{mode:"wait",children:[" ",g.jsxs(lt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.4,ease:pt},children:[" ",Ho()," "]},o)," "]})," "]})};yp.displayName="QuizCreatePage";export{yp as default};
