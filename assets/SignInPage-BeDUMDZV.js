import{j as r}from"./ui-BGuvgkTr.js";import{u as b,b as v,R as j}from"./router-BxjC687J.js";import{u as y,b as I,l as s,C as N,J as P}from"./index-QW2lQ77I.js";import"./vendor-DoC2WAmd.js";import"./utils-rUpm7H1u.js";import"./markdown-Bj7tmv2T.js";const S=()=>{const{login:u,currentUser:g}=y(),{t}=I(),l=b(),c=v();j.useEffect(()=>{var e,n;if(g){const a=((n=(e=c.state)==null?void 0:e.from)==null?void 0:n.pathname)||"/dashboard";s.info("User already signed in, redirecting.","SignInPage",{from:a}),l(a,{replace:!0})}},[g,l,c.state]);const o=e=>{s.error("Google Login Failed.","SignInPage",{errorDetails:e})},x=async e=>{var n,a;if(e.credential)try{const p=e.credential.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),f=decodeURIComponent(atob(p).split("").map(function(d){return"%"+("00"+d.charCodeAt(0).toString(16)).slice(-2)}).join("")),i=JSON.parse(f),h={id:i.sub,name:i.name,email:i.email,imageUrl:i.picture,idToken:e.credential};if(await u(h)){const d=((a=(n=c.state)==null?void 0:n.from)==null?void 0:a.pathname)||"/dashboard";l(d,{replace:!0})}else s.error("Login returned null result","SignInPage"),o(new Error("Login failed - no user returned"))}catch(m){s.error("Error during credential processing or login","SignInPage",void 0,m),o(m)}else s.error("Credential response received but no credential token","SignInPage",{credentialResponse:e}),o(e)};return r.jsx("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-250px)] py-10 sm:py-16",children:r.jsxs(N,{className:"max-w-md w-full text-center shadow-2xl p-8 sm:p-10 md:p-12 !rounded-2xl",useGlassEffect:!0,children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-[var(--color-text-primary)] mb-4 mt-8 sm:mt-10",children:t("signInTitle")}),r.jsx("p",{className:"text-[var(--color-text-secondary)] mb-10 text-sm",children:t("signInSubtitle")}),r.jsx("div",{className:"flex flex-col items-center mb-8",children:r.jsx(P,{onSuccess:x,onError:o,useOneTap:!1,shape:"rectangular",theme:"outline",size:"large",text:"signin_with",width:"300",locale:"en"})}),r.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:[t("signInAgreementPrompt")," "," ",r.jsx("a",{href:"#",className:"text-[var(--color-primary-accent)] hover:underline font-medium",children:t("footerTerms")})," ",t("and")," "," ",r.jsx("a",{href:"#",className:"text-[var(--color-primary-accent)] hover:underline font-medium",children:t("footerPrivacy")}),"."]})]})})};S.displayName="SignInPage";export{S as default};
