import{F as U,m as $,n as T,k as A,r as l,j as e,J as M,C as S,X as R,ad as I,B as u,p as C,K as B,A as G,ae as O,af as V,U as X,l as o,ag as Y,ah as J}from"./index-C8B755Qx.js";const K=()=>{var N,y,Q,w;const{quizId:r}=U(),{t:a}=$(),x=T(),{quizzes:p,setActiveQuiz:k,setQuizResult:q,currentUser:m}=A(),[s,v]=l.useState(null),[P,c]=l.useState(!0),[b,n]=l.useState(null),[f,z]=l.useState(!1),[j,i]=l.useState("");l.useEffect(()=>{(async()=>{if(c(!0),n(null),i(""),!r){o.warn("SharedQuizPage: No quizId in params.","SharedQuizPage"),n(a("sharedQuizNotFound")),i("No quiz ID provided in URL"),c(!1);return}if(!I(r)){o.warn("SharedQuizPage: Invalid quiz ID format.","SharedQuizPage",{quizId:r}),n(a("sharedQuizNotFound")),i(`Invalid quiz ID format: ${r}`),c(!1);return}try{if(m){const h=p.find(g=>g.id===r);if(h){o.info("SharedQuizPage: Displaying quiz owned by current user.","SharedQuizPage",{quizId:r}),v(h),i("Quiz found in user's collection"),c(!1);return}}const t=await Y(r,m);if(t)o.info("SharedQuizPage: Quiz data fetched successfully.","SharedQuizPage",{quizId:r}),v(t),i("Quiz found via sharing mechanism");else{o.warn("SharedQuizPage: Quiz not found via getSharedQuiz.","SharedQuizPage",{quizId:r});const h=J(),g=`Quiz ${r} not found. Available shared quizzes: ${h.join(", ")||"none"}. User logged in: ${m?"Yes":"No"}`;i(g),n(a("sharedQuizNotFound"))}}catch(t){o.error("Error loading shared quiz:","SharedQuizPage",{quizId:r},t),n(a("sharedQuizLoadError")),i(`Error: ${t.message}`)}finally{c(!1)}})()},[r,p,a,m]);const D=async()=>{const d=window.location.href;try{await navigator.clipboard.writeText(d),z(!0),setTimeout(()=>z(!1),2e3)}catch(t){o.error("Failed to copy share link from SharedQuizPage:","SharedQuizPage",void 0,t)}},E=()=>{s&&(k(s),q(null),x(`/quiz/${s.id}`))};if(P)return e.jsx("div",{className:"min-h-[calc(100vh-200px)] flex items-center justify-center",children:e.jsx(M,{text:a("loading")+"...",size:"xl"})});if(b||!s)return e.jsx("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:e.jsxs(S,{className:"max-w-lg mx-auto mt-10 sm:mt-16 p-8 text-center animate-fadeInUp shadow-2xl",useGlassEffect:!0,children:[e.jsx(R,{className:"w-16 h-16 text-[var(--color-danger-accent)] mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold text-[var(--color-text-primary)] mb-3",children:a("sharedQuizError")}),e.jsx("p",{className:"text-[var(--color-text-secondary)] mb-4",children:b||a("sharedQuizNotFound")}),j&&e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)] p-4 rounded-lg mb-6 text-left",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsx("span",{className:"text-sm font-semibold text-[var(--color-text-primary)]",children:"Debug Information"})}),e.jsx("p",{className:"text-xs text-[var(--color-text-muted)] font-mono break-all",children:j}),r&&e.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] font-mono mt-2",children:["Quiz ID: ",r,e.jsx("br",{}),"Valid Format: ",I(r)?"Yes":"No"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx(u,{variant:"primary",onClick:()=>x("/"),size:"lg",className:"py-3 px-8 rounded-xl",children:a("home")}),e.jsx(u,{variant:"outline",onClick:()=>x("/create"),size:"lg",className:"py-3 px-8 rounded-xl",children:a("createQuiz")})]})]})});const L=(N=s.config)!=null&&N.difficulty&&s.config.difficulty!=="AI-Determined"?a(`step2Difficulty${s.config.difficulty}`):((y=s.config)==null?void 0:y.difficulty)==="AI-Determined"?a("dashboardQuizCardDifficulty"):a("notSpecified"),F=(Q=s.config)!=null&&Q.language?s.config.language.toLowerCase()==="english"?a("step2LanguageEnglish"):a("step2LanguageVietnamese"):a("notSpecified");return e.jsx("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:e.jsxs(S,{className:"max-w-3xl mx-auto shadow-2xl !rounded-2xl animate-fadeInUp",useGlassEffect:!0,children:[e.jsxs("div",{className:"border-b border-[var(--color-border-default)] pb-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-[var(--color-text-primary)] leading-tight tracking-tight line-clamp-3",title:s.title,children:e.jsx(C,{text:s.title,markdownFormatting:!0})}),e.jsx(u,{variant:"outline",size:"sm",onClick:D,leftIcon:f?e.jsx(B,{className:"w-4 h-4 text-[var(--color-success-accent)]"}):e.jsx(G,{className:"w-4 h-4"}),className:`!py-2 px-4 rounded-lg shadow-sm flex-shrink-0 ${f?"!border-[var(--color-success-accent)] !text-[var(--color-success-accent)]":"!border-[var(--color-border-interactive)] hover:!border-[var(--color-primary-accent)]"}`,children:a(f?"copied":"copyShareLink")})]}),((w=s.creator)==null?void 0:w.name)&&e.jsxs("div",{className:"flex items-center text-sm text-[var(--color-text-secondary)] mt-3",children:[e.jsx(O,{className:"w-4 h-4 mr-2 text-[var(--color-text-muted)]"}),e.jsxs("span",{children:[a("dashboardQuizCardCreated",{date:""})," ",s.creator.name]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-5",children:e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)]",children:a("quizDetails")})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center sm:text-left",children:[e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:a("numberOfQuestions")}),e.jsx("p",{className:"text-2xl font-bold text-[var(--color-text-primary)]",children:s.questions.length})]}),e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:a("difficulty")}),e.jsx("p",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:L})]}),e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-1",children:a("step2LanguageLabel")}),e.jsx("p",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:F})]})]})]}),s.questions&&s.questions.length>0&&e.jsxs("div",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-text-primary)] mb-5",children:a("previewQuestions")}),e.jsx("div",{className:"space-y-4",children:s.questions.slice(0,3).map((d,t)=>e.jsxs("div",{className:"bg-[var(--color-bg-surface-2)]/60 p-4 sm:p-5 rounded-xl border border-[var(--color-border-default)] shadow-md",children:[e.jsxs("div",{className:"font-medium text-[var(--color-text-primary)] mb-2 text-sm sm:text-base",children:[e.jsxs("span",{className:"text-[var(--color-primary-accent)] mr-2 font-semibold",children:[t+1,"."]}),e.jsx(C,{text:d.questionText,markdownFormatting:!0})]}),t===2&&s.questions.length>3&&e.jsx("p",{className:"text-xs text-[var(--color-text-muted)] italic text-center mt-3",children:a("andMoreQuestions",{count:s.questions.length-3})}),t<2&&s.questions.length>1&&e.jsx("p",{className:"text-xs text-[var(--color-text-muted)] italic mt-2",children:a("moreQuestionsInQuiz")})]},d.id))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 pt-6 border-t border-[var(--color-border-default)]",children:[e.jsx(u,{variant:"primary",size:"lg",onClick:E,leftIcon:e.jsx(V,{className:"w-5 h-5"}),className:"w-full sm:w-auto py-3.5 px-10 rounded-xl bg-gradient-to-r from-[var(--color-primary-accent)] to-indigo-500 hover:from-[var(--color-primary-accent-hover)] hover:to-indigo-600 shadow-xl",children:a("takeQuizNow")}),e.jsx(u,{variant:"outline",size:"lg",onClick:()=>x("/create"),leftIcon:e.jsx(X,{className:"w-5 h-5"}),className:"w-full sm:w-auto py-3.5 px-8 rounded-xl",children:a("createQuiz")})]})]})})};K.displayName="SharedQuizPage";export{K as default};
