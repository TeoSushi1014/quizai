import{r as e,R as t,j as r}from"./core-react-DcE6uGcR.js";import{_ as i,k as n,l as o,u as s,a as l,m as a,B as c,n as d,L as u}from"./app-components-CFPFxe5x.js";import{Q as h,a as f}from"./feature-quiz-components-CChsAlA6.js";import{a as m}from"./router-Dk7yDelZ.js";var p=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function g(e,t){return e===t||!(!p(e)||!p(t))}function x(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!g(e[r],t[r]))return!1;return!0}function v(e,t){var r;void 0===t&&(t=x);var i,n=[],o=!1;return function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return o&&r===this&&t(s,n)||(i=e.apply(this,s),o=!0,r=this,n=s),i}}var y="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function S(e){cancelAnimationFrame(e.id)}var b=-1;function w(e){if(void 0===e&&(e=!1),-1===b||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),b=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return b}var z=null;function I(e){if(void 0===e&&(e=!1),null===z||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var i=document.createElement("div"),n=i.style;return n.width="100px",n.height="100px",t.appendChild(i),document.body.appendChild(t),t.scrollLeft>0?z="positive-descending":(t.scrollLeft=1,z=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),z}return z}var _=function(e,t){return e};function R(t){var r,s=t.getItemOffset,l=t.getEstimatedTotalSize,a=t.getItemSize,c=t.getOffsetForIndexAndAlignment,d=t.getStartIndexForOffset,u=t.getStopIndexForStartIndex,h=t.initInstanceProps,f=t.shouldResetStyleCacheOnItemSizeChange,m=t.validateProps;return(r=function(t){var r,p;function g(e){var r;return(r=t.call(this,e)||this)._instanceProps=h(r.props,o(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:o(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof r.props.initialScrollOffset?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=v(function(e,t,i,n){return r.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:i,visibleStopIndex:n})}),r._callOnScroll=void 0,r._callOnScroll=v(function(e,t,i){return r.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:i})}),r._getItemStyle=void 0,r._getItemStyle=function(e){var t,i=r.props,n=i.direction,o=i.itemSize,l=i.layout,c=r._getItemStyleCache(f&&o,f&&l,f&&n);if(c.hasOwnProperty(e))t=c[e];else{var d=s(r.props,e,r._instanceProps),u=a(r.props,e,r._instanceProps),h="horizontal"===n||"horizontal"===l,m="rtl"===n,p=h?d:0;c[e]=t={position:"absolute",left:m?void 0:p,right:m?p:void 0,top:h?0:d,height:h?"100%":u,width:h?u:"100%"}}return t},r._getItemStyleCache=void 0,r._getItemStyleCache=v(function(e,t,r){return{}}),r._onScrollHorizontal=function(e){var t=e.currentTarget,i=t.clientWidth,n=t.scrollLeft,o=t.scrollWidth;r.setState(function(e){if(e.scrollOffset===n)return null;var t=r.props.direction,s=n;if("rtl"===t)switch(I()){case"negative":s=-n;break;case"positive-descending":s=o-i-n}return s=Math.max(0,Math.min(s,o-i)),{isScrolling:!0,scrollDirection:e.scrollOffset<s?"forward":"backward",scrollOffset:s,scrollUpdateWasRequested:!1}},r._resetIsScrollingDebounced)},r._onScrollVertical=function(e){var t=e.currentTarget,i=t.clientHeight,n=t.scrollHeight,o=t.scrollTop;r.setState(function(e){if(e.scrollOffset===o)return null;var t=Math.max(0,Math.min(o,n-i));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}},r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){var e,t,i;null!==r._resetIsScrollingTimeoutId&&S(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=(e=r._resetIsScrolling,t=y(),i={id:requestAnimationFrame(function r(){y()-t>=150?e.call(null):i.id=requestAnimationFrame(r)})})},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},function(){r._getItemStyleCache(-1,null)})},r}p=t,(r=g).prototype=Object.create(p.prototype),r.prototype.constructor=r,i(r,p),g.getDerivedStateFromProps=function(e,t){return j(e,t),m(e),null};var x=g.prototype;return x.scrollTo=function(e){e=Math.max(0,e),this.setState(function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},x.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props,i=r.itemCount,n=r.layout,o=this.state.scrollOffset;e=Math.max(0,Math.min(e,i-1));var s=0;if(this._outerRef){var l=this._outerRef;s="vertical"===n?l.scrollWidth>l.clientWidth?w():0:l.scrollHeight>l.clientHeight?w():0}this.scrollTo(c(this.props,e,t,o,this._instanceProps,s))},x.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,i=e.layout;if("number"==typeof r&&null!=this._outerRef){var n=this._outerRef;"horizontal"===t||"horizontal"===i?n.scrollLeft=r:n.scrollTop=r}this._callPropsCallbacks()},x.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,i=this.state,n=i.scrollOffset;if(i.scrollUpdateWasRequested&&null!=this._outerRef){var o=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(I()){case"negative":o.scrollLeft=-n;break;case"positive-ascending":o.scrollLeft=n;break;default:var s=o.clientWidth,l=o.scrollWidth;o.scrollLeft=l-s-n}else o.scrollLeft=n;else o.scrollTop=n}this._callPropsCallbacks()},x.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&S(this._resetIsScrollingTimeoutId)},x.render=function(){var t=this.props,r=t.children,i=t.className,o=t.direction,s=t.height,a=t.innerRef,c=t.innerElementType,d=t.innerTagName,u=t.itemCount,h=t.itemData,f=t.itemKey,m=void 0===f?_:f,p=t.layout,g=t.outerElementType,x=t.outerTagName,v=t.style,y=t.useIsScrolling,S=t.width,b=this.state.isScrolling,w="horizontal"===o||"horizontal"===p,z=w?this._onScrollHorizontal:this._onScrollVertical,I=this._getRangeToRender(),R=I[0],j=I[1],O=[];if(u>0)for(var N=R;N<=j;N++)O.push(e.createElement(r,{data:h,key:m(N,h),index:N,isScrolling:y?b:void 0,style:this._getItemStyle(N)}));var T=l(this.props,this._instanceProps);return e.createElement(g||x||"div",{className:i,onScroll:z,ref:this._outerRefSetter,style:n({position:"relative",height:s,width:S,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:o},v)},e.createElement(c||d||"div",{children:O,ref:a,style:{height:w?"100%":T,pointerEvents:b?"none":void 0,width:w?T:"100%"}}))},x._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],i=e[2],n=e[3];this._callOnItemsRendered(t,r,i,n)}if("function"==typeof this.props.onScroll){var o=this.state,s=o.scrollDirection,l=o.scrollOffset,a=o.scrollUpdateWasRequested;this._callOnScroll(s,l,a)}},x._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,i=this.state,n=i.isScrolling,o=i.scrollDirection,s=i.scrollOffset;if(0===t)return[0,0,0,0];var l=d(this.props,s,this._instanceProps),a=u(this.props,l,s,this._instanceProps),c=n&&"backward"!==o?1:Math.max(1,r),h=n&&"forward"!==o?1:Math.max(1,r);return[Math.max(0,l-c),Math.max(0,Math.min(t-1,a+h)),l,a]},g}(e.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},r}var j=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},O=R({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,r,i,n,o){var s=e.direction,l=e.height,a=e.itemCount,c=e.itemSize,d=e.layout,u=e.width,h="horizontal"===s||"horizontal"===d?u:l,f=Math.max(0,a*c-h),m=Math.min(f,t*c),p=Math.max(0,t*c-h+c+o);switch("smart"===r&&(r=i>=p-h&&i<=m+h?"auto":"center"),r){case"start":return m;case"end":return p;case"center":var g=Math.round(p+(m-p)/2);return g<Math.ceil(h/2)?0:g>f+Math.floor(h/2)?f:g;default:return i>=p&&i<=m?i:i<p?p:m}},getStartIndexForOffset:function(e,t){var r=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/i)))},getStopIndexForStartIndex:function(e,t,r){var i=e.direction,n=e.height,o=e.itemCount,s=e.itemSize,l=e.layout,a=e.width,c=t*s,d="horizontal"===i||"horizontal"===l?a:n,u=Math.ceil((d+r-c)/s);return Math.max(0,Math.min(o-1,t+u-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const N=()=>{const{quizzes:i,deleteQuiz:n,currentUser:o,isLoading:p}=s(),{t:g}=l(),x=m(),v=e.useRef(null),y=a(v,{threshold:.5,freezeOnceVisible:!0}),S=e.useRef(null),b=a(S,{threshold:.1,freezeOnceVisible:!0}),w=e.useRef(null),z=a(w,{threshold:.5,freezeOnceVisible:!0}),[I,_]=e.useState(!1),[R,j]=e.useState(300),N=e.useRef(null),T=e=>{x(`/review/${e.id}`,{state:{existingQuiz:e}})},C=t.useMemo(()=>[...i].sort((e,t)=>{const r=new Date(e.lastModified||e.createdAt).getTime();return new Date(t.lastModified||t.createdAt).getTime()-r}),[i]);e.useEffect(()=>{let e=null,t=null,r=!1;const i=()=>{if(N.current){const e=N.current.getBoundingClientRect();if(e.top>0&&e.height>0&&window.innerHeight>e.top){const r=window.innerHeight-e.top-20,i=Math.max(300,r);i!==R&&j(i),t&&clearTimeout(t),t=setTimeout(()=>{_(!0)},50)}else _(!1)}else _(!1)},n=()=>{!p&&C.length>0?(e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>{i()})):_(!1)};return e&&cancelAnimationFrame(e),t&&clearTimeout(t),!p&&C.length>0?(e=requestAnimationFrame(()=>{i()}),window.addEventListener("resize",n),r=!0):_(!1),()=>{e&&cancelAnimationFrame(e),t&&clearTimeout(t),r&&window.removeEventListener("resize",n)}},[p,C.length,R]);const M=({index:e,style:t})=>{const i=C[e];if(!i)return null;const o={...t,top:`${parseFloat(t.top)+8}px`,height:parseFloat(t.height)-16+"px",paddingLeft:"4px",paddingRight:"4px",width:"calc(100% - 8px)",boxSizing:"border-box"};return r.jsx("div",{style:o,children:r.jsx(f,{quiz:i,onDelete:n,onEdit:T,animationDelay:0})})};return M.displayName="QuizListRow",r.jsxs("div",{className:"space-y-10 md:space-y-12",children:[r.jsxs("div",{ref:v,className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-5 border-b border-[var(--color-border-default)] pb-8 sm:pb-10 "+(y?"animate-page-slide-fade-in":"opacity-0"),children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-[var(--color-text-primary)] tracking-tight",children:g("myQuizzesTitle")}),r.jsx("p",{className:"mt-1.5 text-sm text-[var(--color-text-secondary)] max-w-xl",children:g("manageBrowseQuizzes")})]}),r.jsx("div",{className:"flex flex-wrap gap-3 sm:gap-4 mt-4 sm:mt-0",children:r.jsx(c,{variant:"primary",size:"md",leftIcon:r.jsx(d,{className:"w-5 h-5",strokeWidth:2.5}),onClick:()=>x("/create"),className:"shadow-xl hover:shadow-[var(--color-primary-accent)]/50 py-3 px-6 rounded-xl",children:g("dashboardCreateNew")})})]}),!p&&C.length>0&&r.jsx("h2",{ref:w,className:"text-2xl sm:text-3xl font-semibold text-[var(--color-text-primary)] "+(z?"animate-fadeInUp":"opacity-0"),children:g("recentQuizzesSectionTitle")}),p&&C.length>0&&!I&&r.jsx("div",{className:"flex justify-center items-center",style:{height:R>0?`${R}px`:"300px"},children:r.jsx(u,{text:g("loading"),size:"lg"})}),p&&0===C.length?r.jsx("div",{className:"space-y-4",children:[...Array(3)].map((e,t)=>r.jsxs("div",{className:"h-[344px] px-1",children:[" ",r.jsx(h,{})]},t))}):p||0!==C.length?r.jsxs("div",{ref:N,className:"quiz-list-container",style:{height:R>0?`${R}px`:"auto",minHeight:"300px"},children:[I&&R>0&&C.length>0?r.jsx(O,{height:R,itemCount:C.length,itemSize:360,width:"100%",className:"thin-scrollbar-horizontal",itemKey:e=>C[e].id,children:M}):C.length>0&&!I&&!p&&r.jsx("div",{className:"space-y-4",children:[...Array(Math.min(3,C.length))].map((e,t)=>r.jsx("div",{className:"h-[344px] px-1",children:r.jsx(h,{})},t))}),p&&C.length>0&&!I&&r.jsx("div",{className:"space-y-4",children:[...Array(Math.min(3,C.length))].map((e,t)=>r.jsx("div",{className:"h-[344px] px-1",children:r.jsx(h,{})},`loading-${t}`))})]}):r.jsxs("div",{ref:S,className:"text-center py-24 sm:py-28 bg-[var(--color-bg-surface-1)] rounded-3xl shadow-2xl border border-[var(--color-border-default)] glass-effect "+(b?"animate-page-slide-fade-in":"opacity-0"),children:[r.jsx("h3",{className:"mt-2 text-2xl sm:text-3xl font-semibold text-[var(--color-text-primary)] mb-4 pt-10",children:g("dashboardNoQuizzes")}),r.jsx("p",{className:"mt-1 text-base text-[var(--color-text-secondary)] max-w-lg mx-auto mb-12",children:g("dashboardNoQuizzesDesc")}),r.jsx(c,{variant:"secondary",size:"lg",leftIcon:r.jsx(d,{className:"w-5 h-5",strokeWidth:2}),onClick:()=>x("/create"),className:"shadow-lg py-3.5 px-8 text-base rounded-xl",children:g("createQuiz")})]})]})};N.displayName="DashboardPage";export{N as D};
